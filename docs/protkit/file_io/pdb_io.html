<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>protkit.file_io.pdb_io API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../file_io.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;protkit.file_io</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#PDBIO">PDBIO</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PDBIO.parse_pdb_model_line">parse_pdb_model_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.create_pdb_model_line">create_pdb_model_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.parse_pdb_end_model_line">parse_pdb_end_model_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.create_pdb_end_model_line">create_pdb_end_model_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.create_pdb_master_line">create_pdb_master_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.parse_pdb_seqres_line">parse_pdb_seqres_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.create_seqres_line">create_seqres_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.parse_pdb_ter_line">parse_pdb_ter_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.create_pdb_ter_line">create_pdb_ter_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.parse_pdb_atom_line">parse_pdb_atom_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.create_pdb_atom_line">create_pdb_atom_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.create_pqr_atom_line">create_pqr_atom_line</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.parse_pdb_entries_from_string">parse_pdb_entries_from_string</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.parse_pdb_entries">parse_pdb_entries</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.load_from_string">load_from_string</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.save_to_string">save_to_string</a>
                        </li>
                        <li>
                                <a class="function" href="#PDBIO.save">save</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../protkit.html">protkit</a><wbr>.<a href="./../file_io.html">file_io</a><wbr>.pdb_io    </h1>

                        <div class="docstring"><p>Implements class <code><a href="#PDBIO">PDBIO</a></code> to read and write data
from and to PDB files.  PDB files contain protein structural
information.</p>

<p>The PDB File Format Specification is available at:
<a href="https://www.wwpdb.org/documentation/file-format-content/format33/v3.3.html">https://www.wwpdb.org/documentation/file-format-content/format33/v3.3.html</a></p>

<p>Currently, PDB records related to structural and sequence data is parsed
and saved.  Other fields are ignored. The following fields are processed:</p>

<ul>
<li>MODEL (model start)</li>
<li>ENDMDL (model end)</li>
<li>ATOM (structural data)</li>
<li>HETATOM (structural data)</li>
<li>SEQRES (sequence data)</li>
<li>TER (chain termination)</li>
<li>MASTER (record keeping)</li>
</ul>

<p>Methods are static and can be called without instantiating the class.
The main functions exposed by the class are:</p>

<ul>
<li><code>load()</code> to load a protein from a PDB file.</li>
<li><code>save()</code> to save a protein to a PDB file.</li>
</ul>

<p><font color="red">Saving a file in PQR format is not supported yet.</font></p>
</div>

                        <input id="mod-pdb_io-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-pdb_io-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="c1"># -*- coding:utf-8 -*-</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="c1"># Authors:  Fred Senekal (FS)</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="c1"># Contact:  fred@silicogenesis.com</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="c1"># License:  GPLv3</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="sd">Implements class `PDBIO` to read and write data</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">from and to PDB files.  PDB files contain protein structural</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="sd">information.</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="sd">The PDB File Format Specification is available at:</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="sd">https://www.wwpdb.org/documentation/file-format-content/format33/v3.3.html</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="sd">Currently, PDB records related to structural and sequence data is parsed</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="sd">and saved.  Other fields are ignored. The following fields are processed:</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="sd">- MODEL (model start)</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="sd">- ENDMDL (model end)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="sd">- ATOM (structural data)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">- HETATOM (structural data)</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="sd">- SEQRES (sequence data)</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="sd">- TER (chain termination)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="sd">- MASTER (record keeping)</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">Methods are static and can be called without instantiating the class.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">The main functions exposed by the class are:</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">- `load()` to load a protein from a PDB file.</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">- `save()` to save a protein to a PDB file.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">&lt;font color=&quot;red&quot;&gt;Saving a file in PQR format is not supported yet.&lt;/font&gt;</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="kn">from</span> <span class="nn">protkit.structure.protein</span> <span class="kn">import</span> <span class="n">Protein</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="kn">from</span> <span class="nn">protkit.structure.chain</span> <span class="kn">import</span> <span class="n">Chain</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="kn">from</span> <span class="nn">protkit.structure.residue</span> <span class="kn">import</span> <span class="n">Residue</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="kn">from</span> <span class="nn">protkit.structure.atom</span> <span class="kn">import</span> <span class="n">Atom</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="k">class</span> <span class="nc">PDBIO</span><span class="p">():</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>    <span class="c1"># MODEL</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">        Parse a MODEL (start model) line from a PDB file.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD          DEFINITION</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">        ---------------------------------------------------------------------------------------</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">         1 -  6        Record name   &quot;MODEL &quot;</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">        11 - 14        Integer       serial         Model serial number.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>        <span class="n">pdb_model_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>            <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>        <span class="p">}</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>        <span class="k">return</span> <span class="n">pdb_model_dict</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>    <span class="k">def</span> <span class="nf">create_pdb_model_line</span><span class="p">(</span><span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">        Creates a MODEL (start model) line for a PDB file.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>        <span class="k">return</span> <span class="s2">&quot;MODEL&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>    <span class="c1"># ENDMDL</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_end_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">        Parse a ENDMDL (end model) line from a PDB file.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">        COLUMNS       DATA  TYPE     FIELD        DEFINITION</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">        ------------------------------------------------------------------</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">        1 - 6         Record name   &quot;ENDMDL&quot;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>        <span class="n">pdb_end_model_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ENDMDL&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>        <span class="p">}</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>        <span class="k">return</span> <span class="n">pdb_end_model_dict</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>    <span class="k">def</span> <span class="nf">create_pdb_end_model_line</span><span class="p">():</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">        Creates a ENDMDL (end model) line for a PDB file.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>        <span class="k">return</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>    <span class="c1"># MASTER</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>    <span class="k">def</span> <span class="nf">create_pdb_master_line</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_hetatoms</span><span class="p">,</span> <span class="n">num_ter</span><span class="p">,</span> <span class="n">num_remark</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_het</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_helix</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_sheet</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>                               <span class="n">num_site</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_trans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_conect</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_seqres</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">        Creates a MASTER (recordkeeping) line for a PDB file.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">        COLUMNS         DATA TYPE     FIELD          DEFINITION</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">        ----------------------------------------------------------------------------------</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">         1 -  6         Record name   &quot;MASTER&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">        11 - 15         Integer       numRemark      Number of REMARK records</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">        16 - 20         Integer       &quot;0&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="sd">        21 - 25         Integer       numHet         Number of HET records</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">        26 - 30         Integer       numHelix       Number of HELIX records</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">        31 - 35         Integer       numSheet       Number of SHEET records</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">        36 - 40         Integer       numTurn        deprecated</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">        41 - 45         Integer       numSite        Number of SITE records</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">        46 - 50         Integer       numXform       Number of coordinate transformation</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">                                                     records  (ORIGX+SCALE+MTRIX)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        51 - 55         Integer       numCoord       Number of atomic coordinate records</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">                                                     records (ATOM+HETATM)</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">        56 - 60         Integer       numTer         Number of TER records</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">        61 - 65         Integer       numConect      Number of CONECT records</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">        66 - 70         Integer       numSeq         Number of SEQRES records</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>            <span class="s2">&quot;MASTER&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_remark</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>            <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_het</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_helix</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_sheet</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>            <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_site</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_trans</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_atoms</span> <span class="o">+</span> <span class="n">num_hetatoms</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_ter</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_conect</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_seqres</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="p">]</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>    <span class="c1"># SEQRES</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_seqres_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        Parse a SEQRES (sequence) line from a PDB file.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>        <span class="n">pdb_seqres_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">,</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>            <span class="s2">&quot;residues&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="p">}</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="k">return</span> <span class="n">pdb_seqres_dict</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>    <span class="k">def</span> <span class="nf">create_seqres_line</span><span class="p">(</span><span class="n">line_no</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">num_residues</span><span class="p">,</span> <span class="n">residues</span><span class="p">):</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">        Creates a SEQRES (sequence) line for a PDB file.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="sd">         1 -  6        Record name    &quot;SEQRES&quot;</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">         8 - 10        Integer        serNum       Serial number of the SEQRES record for  the</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">                                                   current  chain. Starts at 1 and increments</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="sd">                                                   by one  each line. Reset to 1 for each chain.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">        12             Character      chainID      Chain identifier. This may be any single</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">                                                   legal  character, including a blank which</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="sd">                                                   is used if there is only one chain.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">        14 - 17        Integer        numRes       Number of residues in the chain.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">                                                   This  value is repeated on every record.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">        20 - 22        Residue name   resName      Residue name.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">        24 - 26        Residue name   resName      Residue name.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">        28 - 30        Residue name   resName      Residue name.</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">        32 - 34        Residue name   resName      Residue name.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">        36 - 38        Residue name   resName      Residue name.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">        40 - 42        Residue name   resName      Residue name.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">        44 - 46        Residue name   resName      Residue name.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">        48 - 50        Residue name   resName      Residue name.</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">        52 - 54        Residue name   resName      Residue name.</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">        56 - 58        Residue name   resName      Residue name.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a><span class="sd">        60 - 62        Residue name   resName      Residue name.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="sd">        64 - 66        Residue name   resName      Residue name.</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        68 - 70        Residue name   resName      Residue name.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>            <span class="s2">&quot;SEQRES &quot;</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">line_no</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>            <span class="n">chain_id</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_residues</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="p">]</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>            <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residue</span><span class="p">[</span><span class="s2">&quot;residue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>    <span class="c1"># TER</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_ter_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        Parse a TER (chain termination) line from a PDB file.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD           DEFINITION</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        -------------------------------------------------------------------------</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">         1 -  6        Record name   &quot;TER   &quot;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">         7 - 11        Integer       serial          Serial number.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">        18 - 20        Residue name  resName         Residue name.</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        22             Character     chainID         Chain identifier.</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">        23 - 26        Integer       resSeq          Residue sequence number.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">        27             AChar         iCode           Insertion code.</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>            <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TER&quot;</span><span class="p">,</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>            <span class="p">}</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>            <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TER&quot;</span><span class="p">,</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">21</span><span class="p">],</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">],</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>            <span class="p">}</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>        <span class="k">return</span> <span class="n">pdb_ter_dict</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>    <span class="k">def</span> <span class="nf">create_pdb_ter_line</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span> <span class="n">res_name</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">res_seq</span><span class="p">,</span> <span class="n">icode</span><span class="p">):</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        Creates a TER (chain termination) line for a PDB file.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;TER&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;      &quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">res_name</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">chain_id</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">res_seq</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">icode</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>    <span class="c1"># ATOM | HETATM</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        Parse a ATOM (individual atom) or HETATM (hetero atom) line from a PDB file.</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD        DEFINITION</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="sd">        -------------------------------------------------------------------------------------</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">         1 -  6        Record name   &quot;ATOM  &quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">         7 - 11        Integer       serial       Atom  serial number.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a><span class="sd">        13 - 16        Atom          name         Atom name.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">        17             Character     altLoc       Alternate location indicator.</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">        18 - 20        Residue name  resName      Residue name.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">        22             Character     chainID      Chain identifier.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">        23 - 26        Integer       resSeq       Residue sequence number.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">        27             AChar         iCode        Code for insertion of residues.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">        31 - 38        Real(8.3)     x            Orthogonal coordinates for X in Angstroms.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        39 - 46        Real(8.3)     y            Orthogonal coordinates for Y in Angstroms.</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        47 - 54        Real(8.3)     z            Orthogonal coordinates for Z in Angstroms.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">        55 - 60        Real(6.2)     occupancy    Occupancy.</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">        61 - 66        Real(6.2)     tempFactor   Temperature  factor.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">        77 - 78        LString(2)    element      Element symbol, right-justified.</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">        79 - 80        LString(2)    charge       Charge  on the atom.`</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>                <span class="c1"># Open space</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>                <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>                <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>                <span class="c1"># Open space</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>                <span class="c1"># 3x Open space</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]),</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]),</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]),</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>                <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">60</span><span class="p">]),</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>                <span class="c1"># &quot;temp_factor&quot;: None,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>                <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">66</span><span class="p">]),</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>                <span class="c1"># 66 - 75?</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>                <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>                <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">78</span><span class="p">:</span><span class="mi">80</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>                <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>                <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>            <span class="p">}</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>            <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>                <span class="c1"># Open space</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>                <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>                <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>                <span class="c1"># Open space</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>                <span class="c1"># 3x Open space</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]),</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]),</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]),</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>                <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>                <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>                <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>                <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>                <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">62</span><span class="p">]),</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>                <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">62</span><span class="p">:</span><span class="mi">70</span><span class="p">])</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>            <span class="p">}</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="k">return</span> <span class="n">pdb_atom_dict</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>    <span class="k">def</span> <span class="nf">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;ATOM&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">        Creates a ATOM or HETATM line for a PDB file.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">        Args:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">            atom (Dict): The atom information.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">            serial (int): The serial number of the atom.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">            record_name (str): The record name, should be ATOM or HETATM.</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        Returns:</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">            str: The ATOM or HETATM line.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>        <span class="c1"># The PDB spec says that if the element has two characters, e.g. Fe (iron)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>        <span class="c1"># it should start at the position 13, otherwise it should start at position 14.</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>        <span class="c1"># This seems a little problematic, as some atoms could use 4 characters</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>        <span class="c1"># for example, HG11. The implementation here is consistent with observed PDBs</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>        <span class="c1"># from the RCSB.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">1.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>        <span class="k">return</span> <span class="n">text</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>    <span class="k">def</span> <span class="nf">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;ATOM&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">        Creates a ATOM or HETATM line for a PQR file.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">        The PQR line is similar to the PDB ATOM line, but with additional fields</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">        for atomic charge and radius. The occupancy, temperature factor,</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">        charge and element fields from the PDB file are not used in the PQR file.</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        See: https://pdb2pqr.readthedocs.io/en/latest/formats/pqr.html</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">        The order of fields in a PQR file is as follows:</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">        Field_name Atom_number Atom_name Residue_name Chain_ID Residue_number</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">        X Y Z Charge Radius</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">        Args:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">            atom (Dict): The atom information.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">            serial (int): The serial number of the atom.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">            record_name (str): The record name, should be ATOM or HETATM.</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a><span class="sd">        Returns:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">            str: The PQR ATOM or HETATM line.</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="c1"># The PDB spec says that if the element has two characters, e.g. Fe (iron)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>        <span class="c1"># it should start at the position 13, otherwise it should start at position 14.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="c1"># This seems a little problematic, as some atoms could use 4 characters</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="c1"># for example, HG11. The implementation here is consistent with observed PDBs</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="c1"># from the RCSB.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">7.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="c1"># text += f&#39;{1.0 if atom[&quot;occupancy&quot;] is None else atom[&quot;occupancy&quot;]:6.2f}&#39;</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>        <span class="c1"># text += f&#39;{0.0 if atom[&quot;temp_factor&quot;] is None else atom[&quot;temp_factor&quot;]:6.2f}&#39;</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="c1"># text += &quot;&quot;.ljust(10)</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>        <span class="c1"># text += atom[&quot;element&quot;].rjust(2)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>        <span class="c1"># text += (&quot;&quot; if atom[&quot;charge&quot;] is None else atom[&quot;charge&quot;]).rjust(2)</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>        <span class="k">return</span> <span class="n">text</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>    <span class="c1"># Main parsing and saving functions</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">        Parse a PDB file in string format into a list of entries.</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">        Args:</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">            pdb_string (str): The PDB file as a string.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">            is_pqr_format (bool): If the file is in PQR format.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="sd">        Returns:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="sd">            List[Dict]: A list of parsed entries.</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="c1"># Split the string into lines</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">pdb_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="c1"># Parse every line into dictionary information</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="n">record_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>            <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span><span class="p">:</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>                <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_atom_dict</span><span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>                <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_atom_dict</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>                <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_ter_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_ter_dict</span><span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>                <span class="n">pdb_model_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_model_dict</span><span class="p">)</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>                <span class="n">pdb_end_model_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_end_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_end_model_dict</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>                <span class="n">pdb_seqres_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_seqres_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_seqres_dict</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="k">return</span> <span class="n">entries</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_entries</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="sd">        Parse PDB file according to the spec provided at:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">        https://www.wwpdb.org/documentation/file-format-content/format33/sect9.html#ATOM</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>        <span class="c1"># Open the file and extract the individual lines.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>            <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>        <span class="k">return</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>    <span class="k">def</span> <span class="nf">load_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>                         <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                         <span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>        <span class="n">protein</span> <span class="o">=</span> <span class="n">Protein</span><span class="p">(</span><span class="n">pdb_id</span><span class="o">=</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>        <span class="n">seqres</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>        <span class="n">current_model</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>        <span class="n">current_chain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chain</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>        <span class="n">current_chain_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>        <span class="n">current_residue</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="n">current_residue_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>            <span class="n">record_name</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;record_name&quot;</span><span class="p">]</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>            <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>                <span class="n">chain_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>                <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>                    <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>                <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;residues&quot;</span><span class="p">])</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">:</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>                <span class="c1"># Usually, the MODEL field will only be found in structures based on NMR.</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>                <span class="c1"># We only use the first model in a file if provided.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>                <span class="c1"># There is nothing to do, so we</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>                <span class="k">pass</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="p">:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>                <span class="c1"># Usually, the ENDMDL field will only be found in structures based on NMR.</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>                <span class="c1"># it closes a corresponding MODEL field.</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>                <span class="c1"># Since the end of the model is reached, no more entries should be parsed.</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>                <span class="k">break</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>                <span class="c1"># The TER field terminates the current chain.</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>                <span class="n">current_chain</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>                <span class="n">current_chain_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span> <span class="ow">or</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>                <span class="c1"># If we switched chains, set the chain.</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>                <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">current_chain_id</span><span class="p">:</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>                    <span class="n">current_chain_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>                    <span class="k">if</span> <span class="n">protein</span><span class="o">.</span><span class="n">has_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">):</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>                        <span class="n">current_chain</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>                        <span class="n">current_chain</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">create_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">)</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>                <span class="c1"># Check if the residue exists</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>                <span class="n">residue_id</span> <span class="o">=</span> <span class="n">current_chain_id</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>                <span class="k">if</span> <span class="n">residue_id</span> <span class="o">!=</span> <span class="n">current_residue_id</span><span class="p">:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>                    <span class="n">current_residue_id</span> <span class="o">=</span> <span class="n">residue_id</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>                    <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span><span class="p">:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>                        <span class="c1"># if entry[&quot;res_name&quot;] in ResidueTemplate.VALID_DNA_RESIDUES:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>                        <span class="c1">#     current_residue = current_chain.add_dna_residue(</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>                        <span class="c1">#         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>                        <span class="c1">#         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>                        <span class="c1">#         insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>                        <span class="c1">#     )</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>                        <span class="c1"># else:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>                        <span class="n">current_residue</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">(</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                            <span class="n">residue_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>                            <span class="n">sequence_no</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]),</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>                            <span class="n">insertion_code</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">],</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>                            <span class="n">chain</span><span class="o">=</span><span class="n">current_chain</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>                        <span class="n">current_chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">current_residue</span><span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>                    <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>                        <span class="n">current_residue</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">(</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                            <span class="n">residue_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>                            <span class="n">sequence_no</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]),</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>                            <span class="n">insertion_code</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">],</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>                            <span class="n">chain</span><span class="o">=</span><span class="n">current_chain</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>                        <span class="n">current_chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">current_residue</span><span class="p">)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>                        <span class="c1"># current_residue = current_chain.add_het_residue(</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>                        <span class="c1">#     residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>                        <span class="c1">#     sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>                        <span class="c1">#     insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>                        <span class="c1"># )</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>                <span class="c1"># Temporary fix need to see if anything breaks (For Evo eg. 2HH1 -&gt; HH12)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>                <span class="c1"># Fix atom naming</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>                <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>                    <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>                    <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>                    <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>                        <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>                <span class="c1"># Add the atom to the residue</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>                <span class="c1"># if entry[&quot;alt_loc&quot;] == &quot;&quot;:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>                <span class="c1">#     atom_id = entry[&quot;atom_name&quot;]</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>                <span class="c1"># else:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>                <span class="c1">#     atom_id = entry[&quot;atom_name&quot;] + &quot;_&quot; + entry[&quot;alt_loc&quot;]</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>                <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>                    <span class="n">element</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">],</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>                    <span class="n">atom_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">],</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>                    <span class="n">x</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>                    <span class="n">y</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>                    <span class="n">z</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>                    <span class="c1"># Serial is dependent on the atom ordering,</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>                    <span class="c1"># so it is not used in the Atom class</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>                    <span class="c1"># pdb_serial=entry[&quot;serial&quot;],</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>                    <span class="n">alt_loc</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">],</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>                    <span class="n">occupancy</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">],</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>                    <span class="n">temp_factor</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">],</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>                    <span class="n">assigned_charge</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">],</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>                    <span class="n">calculated_charge</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">],</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>                    <span class="n">radius</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">],</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>                    <span class="n">is_hetero</span><span class="o">=</span><span class="p">(</span><span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">),</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>                    <span class="n">residue</span><span class="o">=</span><span class="n">current_residue</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>                <span class="p">)</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>                <span class="c1"># current_residue.add_atom(atom_id, atom)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>                <span class="n">current_residue</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span> <span class="n">atom</span><span class="p">)</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="k">if</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>            <span class="k">for</span> <span class="n">chain_id</span> <span class="ow">in</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>                <span class="k">if</span> <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]:</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>                    <span class="n">protein</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">chain_id</span><span class="p">)</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;seqres&quot;</span><span class="p">,</span> <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">])</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>        <span class="c1"># Housekeeping</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="c1"># protein.set_residue_indexing()</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">protein</span><span class="p">]</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>             <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>             <span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">        Load a protein from a PDB file.</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        Args:</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">            file_path (str): The path to the PDB file.</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">            is_pqr_format (bool): If the file is in PQR format.</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">            pdb_id (str): The PDB ID of the protein.</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">        Returns:</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">            List[Protein]: A list of proteins.</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="c1"># Open the file and extract the individual lines.</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>            <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>        <span class="k">return</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">load_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">,</span> <span class="n">pdb_id</span><span class="o">=</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>    <span class="k">def</span> <span class="nf">save_to_string</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>                       <span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="n">text_entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="n">num_seqres</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>        <span class="n">num_atoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>        <span class="n">num_hetatoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="n">num_ter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>        <span class="n">serial</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>        <span class="n">atom_entry</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">chains</span><span class="p">:</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>            <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">atom</span><span class="o">.</span><span class="n">is_hetero</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>                        <span class="n">atom_entry</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>                            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>                            <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>                            <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;pdb_alt_loc&quot;</span><span class="p">),</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>                            <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_type</span><span class="p">,</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>                            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">chain</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>                            <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">sequence_no</span><span class="p">),</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>                            <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">insertion_code</span><span class="p">,</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>                            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>                            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>                            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>                            <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;occupancy&quot;</span><span class="p">),</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>                            <span class="c1"># &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>                            <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">),</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>                            <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>                            <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">),</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>                            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;radius&quot;</span><span class="p">)</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>                        <span class="p">}</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">))</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">))</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>                        <span class="n">serial</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>                        <span class="n">num_atoms</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>            <span class="c1"># TER entry</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="k">if</span> <span class="n">atom_entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>                <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_ter_line</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">],</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">],</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]))</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>                <span class="n">serial</span> <span class="o">=</span> <span class="n">serial</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>                <span class="n">num_ter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">chains</span><span class="p">:</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>            <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>                <span class="c1"># HETATM entries</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>                    <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">is_hetero</span><span class="p">:</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>                        <span class="n">atom_entry</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>                            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>                            <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>                            <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;pdb_alt_loc&quot;</span><span class="p">),</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>                            <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_type</span><span class="p">,</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>                            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">chain</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>                            <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">sequence_no</span><span class="p">),</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>                            <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">insertion_code</span><span class="p">,</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>                            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>                            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>                            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>                            <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;occupancy&quot;</span><span class="p">),</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>                            <span class="c1"># &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>                            <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">),</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>                            <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>                            <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>                            <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">),</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>                            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;radius&quot;</span><span class="p">)</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>                        <span class="p">}</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;HETATM&quot;</span><span class="p">))</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;HETATM&quot;</span><span class="p">))</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>                        <span class="n">serial</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>                        <span class="n">num_hetatoms</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>            <span class="c1"># Hetero residues have no TER records, so no need to write a termination code.</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>        <span class="c1"># Bookkeeping records</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_master_line</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_hetatoms</span><span class="p">,</span> <span class="n">num_ter</span><span class="p">,</span> <span class="n">num_seqres</span><span class="o">=</span><span class="n">num_seqres</span><span class="p">))</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>        <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;END&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_entries</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>             <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>             <span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>        <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">save_to_string</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">)</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>    <span class="c1"># TODO: from_pdb_text and to_pdb_text was added by Claudio</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>    <span class="c1"># The intent is that one should parse proteins from text</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>    <span class="c1"># without working with files. However, a lot of code copying</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>    <span class="c1"># was made and it need to be reworked significantly.</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>    <span class="c1"># def from_pdb_text(lines) -&gt; List[Protein]:</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>    <span class="c1">#     lines = lines.split(&quot;\n&quot;)</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>    <span class="c1">#</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>    <span class="c1">#     entries = []</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>    <span class="c1">#     for line in lines:</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>    <span class="c1">#         record_name = line[0:6].strip().upper()</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>    <span class="c1">#         if record_name == &quot;ATOM&quot;:</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>    <span class="c1">#             pdb_atom_dict = PDBIO.parse_pdb_atom_line(line)</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>    <span class="c1">#             entries.append(pdb_atom_dict)</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>    <span class="c1">#         elif record_name == &quot;HETATM&quot;:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>    <span class="c1">#             pdb_atom_dict = PDBIO.parse_pdb_atom_line(line)</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>    <span class="c1">#             entries.append(pdb_atom_dict)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>    <span class="c1">#         elif record_name == &quot;TER&quot;:</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>    <span class="c1">#             pdb_ter_dict = PDBIO.parse_pdb_ter_line(line)</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>    <span class="c1">#             entries.append(pdb_ter_dict)</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>    <span class="c1">#         elif record_name == &quot;MODEL&quot;:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>    <span class="c1">#             pdb_model_dict = PDBIO.parse_pdb_model_line(line)</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>    <span class="c1">#             entries.append(pdb_model_dict)</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>    <span class="c1">#         elif record_name == &quot;ENDMDL&quot;:</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>    <span class="c1">#             pdb_end_model_dict = PDBIO.parse_pdb_end_model_line(line)</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>    <span class="c1">#             entries.append(pdb_end_model_dict)</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>    <span class="c1">#         elif record_name == &quot;SEQRES&quot;:</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>    <span class="c1">#             pdb_seqres_dict = PDBIO.parse_pdb_seqres_line(line)</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>    <span class="c1">#             entries.append(pdb_seqres_dict)</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>    <span class="c1">#</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>    <span class="c1">#     protein = Protein()</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>    <span class="c1">#     models = []</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>    <span class="c1">#     seqres = {}</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>    <span class="c1">#     current_model = None</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>    <span class="c1">#     current_chain: Optional[Chain] = None</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>    <span class="c1">#     current_chain_id = None</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>    <span class="c1">#     current_residue: Optional[Residue] = None</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>    <span class="c1">#     current_residue_id = None</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>    <span class="c1">#</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>    <span class="c1">#     for entry in entries:</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>    <span class="c1">#         record_name = entry[&quot;record_name&quot;]</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>    <span class="c1">#         if record_name == &quot;SEQRES&quot;:</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>    <span class="c1">#             chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>    <span class="c1">#             if chain_id not in seqres:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>    <span class="c1">#                 seqres[chain_id] = []</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>    <span class="c1">#             seqres[chain_id].extend(entry[&quot;residues&quot;])</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>    <span class="c1">#         elif record_name == &quot;MODEL&quot;:</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>    <span class="c1">#             # Usually, the MODEL field will only be found in structures based on NMR.</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>    <span class="c1">#             # We only use the first model in a file if provided.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>    <span class="c1">#             # There is nothing to do, so we</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>    <span class="c1">#             pass</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>    <span class="c1">#         elif record_name == &quot;ENDMDL&quot;:</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>    <span class="c1">#             # Usually, the ENDMDL field will only be found in structures based on NMR.</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>    <span class="c1">#             # it closes a corresponding MODEL field.</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>    <span class="c1">#             # Since the end of the model is reached, no more entries should be parsed.</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>    <span class="c1">#             break</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>    <span class="c1">#         elif record_name == &quot;TER&quot;:</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>    <span class="c1">#             # The TER field terminates the current chain.</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>    <span class="c1">#             current_chain = None</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>    <span class="c1">#             current_chain_id = None</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>    <span class="c1">#         elif record_name == &quot;ATOM&quot; or record_name == &quot;HETATM&quot;:</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>    <span class="c1">#             # If we switched chains, set the chain.</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>    <span class="c1">#             if entry[&quot;chain_id&quot;] != current_chain_id:</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>    <span class="c1">#                 current_chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>    <span class="c1">#                 if protein.has_chain(current_chain_id):</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>    <span class="c1">#                     current_chain = protein.get_chain(current_chain_id)</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>    <span class="c1">#                 else:</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>    <span class="c1">#                     current_chain = protein.create_chain(current_chain_id)</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>    <span class="c1">#</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>    <span class="c1">#             # Check if the residue exists</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>    <span class="c1">#             residue_id = current_chain_id + entry[&quot;res_seq&quot;] + entry[&quot;icode&quot;]</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>    <span class="c1">#             if residue_id != current_residue_id:</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>    <span class="c1">#                 current_residue_id = residue_id</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>    <span class="c1">#                 if record_name == &quot;ATOM&quot;:</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>    <span class="c1">#                     # if entry[&quot;res_name&quot;] in ResidueTemplate.VALID_DNA_RESIDUES:</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>    <span class="c1">#                     #     current_residue = current_chain.add_dna_residue(</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>    <span class="c1">#                     #         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>    <span class="c1">#                     #         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>    <span class="c1">#                     #         insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>    <span class="c1">#                     #     )</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>    <span class="c1">#                     # else:</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>    <span class="c1">#                         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>    <span class="c1">#                         insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>    <span class="c1">#                 elif record_name == &quot;HETATM&quot;:</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>    <span class="c1">#                         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>    <span class="c1">#                         insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>    <span class="c1">#</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>    <span class="c1">#                     # current_residue = current_chain.add_het_residue(</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>    <span class="c1">#                     #     residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>    <span class="c1">#                     #     sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>    <span class="c1">#                     #     insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>    <span class="c1">#                     # )</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>    <span class="c1">#</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>    <span class="c1">#             # Temporary fix need to see if anything breaks (For Evo eg. 2HH1 -&gt; HH12)</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>    <span class="c1">#             # Fix atom naming</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>    <span class="c1">#             if entry[&quot;atom_name&quot;][0].isnumeric():</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>    <span class="c1">#                 entry[&quot;atom_name&quot;] = entry[&quot;atom_name&quot;][1:] + entry[&quot;atom_name&quot;][0]</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>    <span class="c1">#                 if entry[&quot;element&quot;] != &quot;H&quot;:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>    <span class="c1">#                     print(0)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>    <span class="c1">#                 if entry[&quot;atom_name&quot;][0] == &quot;H&quot;:</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>    <span class="c1">#                     entry[&quot;element&quot;] = &quot;H&quot;</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>    <span class="c1">#</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>    <span class="c1">#             # Add the atom to the residue</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>    <span class="c1">#             if entry[&quot;alt_loc&quot;] == &quot;&quot;:</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;]</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>    <span class="c1">#             else:</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;] + &quot;_&quot; + entry[&quot;alt_loc&quot;]</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>    <span class="c1">#             atom = Atom(</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>    <span class="c1">#                 element=entry[&quot;element&quot;],</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>    <span class="c1">#                 atom_type=entry[&quot;atom_name&quot;],</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>    <span class="c1">#                 x=entry[&quot;x&quot;],</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>    <span class="c1">#                 y=entry[&quot;y&quot;],</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>    <span class="c1">#                 z=entry[&quot;z&quot;],</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>    <span class="c1">#</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>    <span class="c1">#                 # pdb_serial=entry[&quot;serial&quot;],</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>    <span class="c1">#                 # pdb_alt_loc=entry[&quot;alt_loc&quot;],</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>    <span class="c1">#                 # pdb_occupancy=entry[&quot;occupancy&quot;],</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>    <span class="c1">#                 # pdb_temp_factor=entry[&quot;temp_factor&quot;],</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>    <span class="c1">#                 # pdb_assigned_charge=entry[&quot;assigned_charge&quot;],</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>    <span class="c1">#                 # pqr_calculated_charge=entry[&quot;calculated_charge&quot;],</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>    <span class="c1">#                 # pqr_radius=entry[&quot;radius&quot;],</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>    <span class="c1">#                 #</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>    <span class="c1">#                 is_hetero=(record_name == &quot;HETATM&quot;),</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>    <span class="c1">#</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>    <span class="c1">#                 residue=current_residue</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>    <span class="c1">#             )</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>    <span class="c1">#             current_residue.add_atom(atom_id, atom)</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>    <span class="c1">#</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>    <span class="c1">#     # if seqres:</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>    <span class="c1">#     #     for chain_id in seqres:</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>    <span class="c1">#     #         if seqres[chain_id]:</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>    <span class="c1">#     #             protein.chains[chain_id].sequence = seqres[chain_id]</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>    <span class="c1">#</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>    <span class="c1">#     # Housekeeping</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>    <span class="c1">#     # protein.set_residue_indexing()</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>    <span class="c1">#</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>    <span class="c1">#     return [protein]</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>    <span class="c1"># def to_pdb_text(protein: Protein):</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>    <span class="c1">#     text_entries = &quot;&quot;</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>    <span class="c1">#     num_seqres = 0</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>    <span class="c1">#     num_atoms = 0</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>    <span class="c1">#     num_hetatoms = 0</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>    <span class="c1">#     num_ter = 0</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>    <span class="c1">#     serial = 1</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>    <span class="c1">#</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>    <span class="c1">#     for chain in protein.chains:</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>    <span class="c1">#         for residue in chain.residues:</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>    <span class="c1">#             for atom in residue.atoms:</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>    <span class="c1">#                 if not atom.is_hetero:</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>    <span class="c1">#                     atom_entry = {</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>    <span class="c1">#                         &quot;element&quot;: atom.element,</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>    <span class="c1">#                         &quot;atom_name&quot;: atom.atom_type,</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>    <span class="c1">#                         &quot;alt_loc&quot;: atom.get_attribute(&quot;pdb_alt_loc&quot;),</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>    <span class="c1">#                         &quot;res_name&quot;: residue.residue_type,</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>    <span class="c1">#                         &quot;chain_id&quot;: chain.chain_id,</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    <span class="c1">#                         &quot;res_seq&quot;: str(residue.sequence_no),</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>    <span class="c1">#                         &quot;icode&quot;: residue.insertion_code,</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>    <span class="c1">#                         &quot;x&quot;: atom.x,</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>    <span class="c1">#                         &quot;y&quot;: atom.y,</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>    <span class="c1">#                         &quot;z&quot;: atom.z,</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>    <span class="c1">#                         &quot;occupancy&quot;: atom.get_attribute(&quot;occupancy&quot;),</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>    <span class="c1">#                         # &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>    <span class="c1">#                         &quot;temp_factor&quot;: atom.get_attribute(&quot;temp_factor&quot;),</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>    <span class="c1">#                         &quot;charge&quot;: atom.get_attribute(&quot;assigned_charge&quot;)</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>    <span class="c1">#                     }</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>    <span class="c1">#                     text_entries += PDBIO.create_pdb_atom_line(atom_entry, serial)</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>    <span class="c1">#                     text_entries += &quot;\n&quot;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>    <span class="c1">#                     serial += 1</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>    <span class="c1">#                     num_atoms += 1</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>    <span class="c1">#</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>    <span class="c1">#     # Bookkeeping records</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>    <span class="c1">#     text_entries += PDBIO.create_pdb_master_line(num_atoms, num_hetatoms, num_ter, num_seqres=num_seqres)</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>    <span class="c1">#     text_entries += &quot;END&quot;.ljust(80)</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>    <span class="c1">#     text_entries += &quot;\n&quot;</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>    <span class="c1">#</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>    <span class="c1">#     return text_entries</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>    <span class="c1"># def save_to_pdb(file_path: str, protein):</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>    <span class="c1">#     entries = []</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>    <span class="c1">#</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>    <span class="c1">#     num_seqres = 0</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>    <span class="c1">#     num_atoms = 0</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>    <span class="c1">#     num_hetatoms = 0</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>    <span class="c1">#     num_ter = 0</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>    <span class="c1">#     serial = 1</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>    <span class="c1">#</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>    <span class="c1">#     for chain in protein.chains:</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>    <span class="c1">#         for residue in chain.residues:</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>    <span class="c1">#             # ATOM entries</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>    <span class="c1">#             for atom in residue.atoms:</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>    <span class="c1">#                 if not atom.is_hetero:</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>    <span class="c1">#                     atom_entry = {</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>    <span class="c1">#                         &quot;element&quot;: atom.element,</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>    <span class="c1">#                         &quot;atom_name&quot;: atom.atom_type,</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>    <span class="c1">#                         &quot;alt_loc&quot;: atom._pdb_alt_loc,</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>    <span class="c1">#                         &quot;res_name&quot;: residue.residue_type,</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>    <span class="c1">#                         &quot;chain_id&quot;: chain.chain_id,</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>    <span class="c1">#                         &quot;res_seq&quot;: str(residue._pdb_sequence_no),</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>    <span class="c1">#                         &quot;icode&quot;: residue._pdb_insertion_code,</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>    <span class="c1">#                         &quot;x&quot;: atom.x,</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>    <span class="c1">#                         &quot;y&quot;: atom.y,</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>    <span class="c1">#                         &quot;z&quot;: atom.z,</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>    <span class="c1">#                         &quot;occupancy&quot;: atom._pdb_occupancy,</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>    <span class="c1">#                         &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>    <span class="c1">#                         &quot;charge&quot;: atom._pdb_assigned_charge</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>    <span class="c1">#                     }</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>    <span class="c1">#                     entries.append(PDBParser.create_pdb_atom_line(atom_entry, serial))</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>    <span class="c1">#                     serial += 1</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>    <span class="c1">#                     num_atoms += 1</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>    <span class="c1">#</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>    <span class="c1">#         # TER entry</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>    <span class="c1">#         if chain.num_residues - chain.num_hetero_residues &gt; 0:</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>    <span class="c1">#             entries.append(</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>    <span class="c1">#                 PDBParser.create_pdb_ter_line(serial, atom_entry[&quot;res_name&quot;], chain.chain_id, atom_entry[&quot;res_seq&quot;],</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>    <span class="c1">#                                               atom_entry[&quot;icode&quot;]))</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>    <span class="c1">#             serial = serial + 1</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>    <span class="c1">#             num_ter += 1</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>    <span class="c1">#</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>    <span class="c1">#     for chain in protein.chains:</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>    <span class="c1">#         for residue in chain.residues:</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>    <span class="c1">#             # HETATM entries</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>    <span class="c1">#             for atom in residue.atoms:</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>    <span class="c1">#                 if atom.is_hetero:</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>    <span class="c1">#                     atom_entry = {</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>    <span class="c1">#                         &quot;element&quot;: atom.element,</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>    <span class="c1">#                         &quot;atom_name&quot;: atom.atom_type,</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>    <span class="c1">#                         &quot;alt_loc&quot;: atom._pdb_alt_loc,</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>    <span class="c1">#                         &quot;res_name&quot;: residue.residue_type,</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>    <span class="c1">#                         &quot;chain_id&quot;: chain.chain_id,</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>    <span class="c1">#                         &quot;res_seq&quot;: str(residue._pdb_sequence_no),</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>    <span class="c1">#                         &quot;icode&quot;: residue._pdb_insertion_code,</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>    <span class="c1">#                         &quot;x&quot;: atom.x,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>    <span class="c1">#                         &quot;y&quot;: atom.y,</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>    <span class="c1">#                         &quot;z&quot;: atom.z,</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>    <span class="c1">#                         &quot;occupancy&quot;: atom._pdb_occupancy,</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>    <span class="c1">#                         &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>    <span class="c1">#                         &quot;charge&quot;: atom._pdb_assigned_charge</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>    <span class="c1">#                     }</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>    <span class="c1">#                     entries.append(PDBParser.create_pdb_atom_line(atom_entry, serial, &quot;HETATM&quot;))</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>    <span class="c1">#                     serial += 1</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>    <span class="c1">#                     num_hetatoms += 1</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>    <span class="c1">#</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>    <span class="c1">#         # Hetero residues have no TER records, so no need to write a termination code.</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>    <span class="c1">#</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>    <span class="c1">#     # Bookkeeping records</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>    <span class="c1">#     entries.append(PDBParser.create_pdb_master_line(num_atoms, num_hetatoms, num_ter, num_seqres=num_seqres))</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>    <span class="c1">#     entries.append(&quot;END&quot;.ljust(80))</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>    <span class="c1">#</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>    <span class="c1">#     # Write file</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>    <span class="c1">#     with open(file_path, &quot;w&quot;) as file:</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>    <span class="c1">#         file.write(&quot;\n&quot;.join(entries))</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>    <span class="c1"># def load_from_pdb(file_path: str):</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>    <span class="c1">#     entries = PDBParser.parse_pdb_entries(file_path)</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>    <span class="c1">#</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>    <span class="c1">#     protein = Protein()</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>    <span class="c1">#     models = []</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>    <span class="c1">#     seqres = {}</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>    <span class="c1">#     current_model = None</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>    <span class="c1">#     current_chain: Chain = None</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>    <span class="c1">#     current_chain_id = None</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>    <span class="c1">#     current_residue: Residue = None</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>    <span class="c1">#     current_residue_id = None</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>    <span class="c1">#</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>    <span class="c1">#     for entry in entries:</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>    <span class="c1">#         record_name = entry[&quot;record_name&quot;]</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>    <span class="c1">#         if record_name == &quot;SEQRES&quot;:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>    <span class="c1">#             chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>    <span class="c1">#             if chain_id not in seqres:</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>    <span class="c1">#                 seqres[chain_id] = []</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>    <span class="c1">#             seqres[chain_id].extend(entry[&quot;residues&quot;])</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>    <span class="c1">#         elif record_name == &quot;MODEL&quot;:</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>    <span class="c1">#             # Usually, the MODEL field will only be found in structures based on NMR.</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>    <span class="c1">#             # We only use the first model in a file if provided.</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>    <span class="c1">#             # There is nothing to do, so we</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>    <span class="c1">#             pass</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>    <span class="c1">#         elif record_name == &quot;ENDMDL&quot;:</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>    <span class="c1">#             # Usually, the ENDMDL field will only be found in structures based on NMR.</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>    <span class="c1">#             # it closes a corresponding MODEL field.</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>    <span class="c1">#             # Since the end of the model is reached, no more entries should be parsed.</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>    <span class="c1">#             break</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>    <span class="c1">#         elif record_name == &quot;TER&quot;:</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>    <span class="c1">#             # The TER field terminates the current chain.</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>    <span class="c1">#             current_chain = None</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>    <span class="c1">#             current_chain_id = None</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>    <span class="c1">#         elif record_name == &quot;ATOM&quot; or record_name == &quot;HETATM&quot;:</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>    <span class="c1">#             # If we switched chains, set the chain.</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>    <span class="c1">#             if entry[&quot;chain_id&quot;] != current_chain_id:</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>    <span class="c1">#                 current_chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>    <span class="c1">#                 if current_chain_id in protein._chains:</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>    <span class="c1">#                     current_chain = protein._chains[current_chain_id]</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>    <span class="c1">#                 else:</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>    <span class="c1">#                     current_chain = protein.create_chain(current_chain_id)</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>    <span class="c1">#</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>    <span class="c1">#             # Check if the residue exists</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>    <span class="c1">#             residue_id = current_chain_id + entry[&quot;res_seq&quot;] + entry[&quot;icode&quot;]</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>    <span class="c1">#             if residue_id != current_residue_id:</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>    <span class="c1">#                 current_residue_id = residue_id</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>    <span class="c1">#                 if record_name == &quot;ATOM&quot;:</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>    <span class="c1">#                     # if entry[&quot;res_name&quot;] in ResidueTemplate.VALID_DNA_RESIDUES:</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>    <span class="c1">#                     #     current_residue = current_chain.add_dna_residue(</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>    <span class="c1">#                     #         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>    <span class="c1">#                     #         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>    <span class="c1">#                     #         insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>    <span class="c1">#                     #     )</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>    <span class="c1">#                     # else:</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>    <span class="c1">#                         pdb_sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>    <span class="c1">#                         pdb_insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>    <span class="c1">#                 elif record_name == &quot;HETATM&quot;:</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>    <span class="c1">#                         pdb_sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>    <span class="c1">#                         pdb_insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>    <span class="c1">#</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>    <span class="c1">#                     # current_residue = current_chain.add_het_residue(</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>    <span class="c1">#                     #     residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>    <span class="c1">#                     #     sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>    <span class="c1">#                     #     insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>    <span class="c1">#                     # )</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>    <span class="c1">#</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>    <span class="c1">#             # Temporary fix need to see if anything breaks (For Evo eg. 2HH1 -&gt; HH12)</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>    <span class="c1">#             # Fix atom naming</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>    <span class="c1">#             if entry[&quot;atom_name&quot;][0].isnumeric():</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>    <span class="c1">#                 entry[&quot;atom_name&quot;] = entry[&quot;atom_name&quot;][1:] + entry[&quot;atom_name&quot;][0]</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>    <span class="c1">#                 if entry[&quot;element&quot;] != &quot;H&quot;:</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>    <span class="c1">#                     print(0)</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>    <span class="c1">#                 if entry[&quot;atom_name&quot;][0] == &quot;H&quot;:</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>    <span class="c1">#                     entry[&quot;element&quot;] = &quot;H&quot;</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>    <span class="c1">#</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>    <span class="c1">#             # Add the atom to the residue</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>    <span class="c1">#             if entry[&quot;alt_loc&quot;] == &quot;&quot;:</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;]</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>    <span class="c1">#             else:</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;] + &quot;_&quot; + entry[&quot;alt_loc&quot;]</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>    <span class="c1">#             atom = Atom(</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>    <span class="c1">#                 element=entry[&quot;element&quot;],</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>    <span class="c1">#                 atom_type=entry[&quot;atom_name&quot;],</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>    <span class="c1">#                 x=entry[&quot;x&quot;],</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>    <span class="c1">#                 y=entry[&quot;y&quot;],</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>    <span class="c1">#                 z=entry[&quot;z&quot;],</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>    <span class="c1">#</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>    <span class="c1">#                 pdb_serial=entry[&quot;serial&quot;],</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>    <span class="c1">#                 pdb_alt_loc=entry[&quot;alt_loc&quot;],</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>    <span class="c1">#                 pdb_occupancy=entry[&quot;occupancy&quot;],</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>    <span class="c1">#                 pdb_temp_factor=entry[&quot;temp_factor&quot;],</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>    <span class="c1">#                 pdb_assigned_charge=entry[&quot;assigned_charge&quot;],</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>    <span class="c1">#                 pqr_calculated_charge=entry[&quot;calculated_charge&quot;],</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>    <span class="c1">#                 pqr_radius=entry[&quot;radius&quot;],</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>    <span class="c1">#</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>    <span class="c1">#                 is_hetero=(record_name == &quot;HETATM&quot;),</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>    <span class="c1">#</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>    <span class="c1">#                 residue=current_residue</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>    <span class="c1">#             )</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>    <span class="c1">#             current_residue.add_atom(atom_id, atom)</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>    <span class="c1">#</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>    <span class="c1">#     # if seqres:</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>    <span class="c1">#     #     for chain_id in seqres:</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>    <span class="c1">#     #         if seqres[chain_id]:</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>    <span class="c1">#     #             protein.chains[chain_id].sequence = seqres[chain_id]</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>    <span class="c1">#</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>    <span class="c1">#     # Housekeeping</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>    <span class="c1">#     protein.set_residue_indexing()</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>    <span class="c1">#</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>    <span class="c1">#     return protein</span>
</span></pre></div>


            </section>
                <section id="PDBIO">
                            <input id="PDBIO-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PDBIO</span>:

                <label class="view-source-button" for="PDBIO-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO-44"><a href="#PDBIO-44"><span class="linenos">  44</span></a><span class="k">class</span> <span class="nc">PDBIO</span><span class="p">():</span>
</span><span id="PDBIO-45"><a href="#PDBIO-45"><span class="linenos">  45</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-46"><a href="#PDBIO-46"><span class="linenos">  46</span></a>    <span class="c1"># MODEL</span>
</span><span id="PDBIO-47"><a href="#PDBIO-47"><span class="linenos">  47</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-48"><a href="#PDBIO-48"><span class="linenos">  48</span></a>
</span><span id="PDBIO-49"><a href="#PDBIO-49"><span class="linenos">  49</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-50"><a href="#PDBIO-50"><span class="linenos">  50</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO-51"><a href="#PDBIO-51"><span class="linenos">  51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-52"><a href="#PDBIO-52"><span class="linenos">  52</span></a><span class="sd">        Parse a MODEL (start model) line from a PDB file.</span>
</span><span id="PDBIO-53"><a href="#PDBIO-53"><span class="linenos">  53</span></a>
</span><span id="PDBIO-54"><a href="#PDBIO-54"><span class="linenos">  54</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD          DEFINITION</span>
</span><span id="PDBIO-55"><a href="#PDBIO-55"><span class="linenos">  55</span></a><span class="sd">        ---------------------------------------------------------------------------------------</span>
</span><span id="PDBIO-56"><a href="#PDBIO-56"><span class="linenos">  56</span></a><span class="sd">         1 -  6        Record name   &quot;MODEL &quot;</span>
</span><span id="PDBIO-57"><a href="#PDBIO-57"><span class="linenos">  57</span></a><span class="sd">        11 - 14        Integer       serial         Model serial number.</span>
</span><span id="PDBIO-58"><a href="#PDBIO-58"><span class="linenos">  58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-59"><a href="#PDBIO-59"><span class="linenos">  59</span></a>        <span class="n">pdb_model_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-60"><a href="#PDBIO-60"><span class="linenos">  60</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">,</span>
</span><span id="PDBIO-61"><a href="#PDBIO-61"><span class="linenos">  61</span></a>            <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span>
</span><span id="PDBIO-62"><a href="#PDBIO-62"><span class="linenos">  62</span></a>        <span class="p">}</span>
</span><span id="PDBIO-63"><a href="#PDBIO-63"><span class="linenos">  63</span></a>
</span><span id="PDBIO-64"><a href="#PDBIO-64"><span class="linenos">  64</span></a>        <span class="k">return</span> <span class="n">pdb_model_dict</span>
</span><span id="PDBIO-65"><a href="#PDBIO-65"><span class="linenos">  65</span></a>
</span><span id="PDBIO-66"><a href="#PDBIO-66"><span class="linenos">  66</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-67"><a href="#PDBIO-67"><span class="linenos">  67</span></a>    <span class="k">def</span> <span class="nf">create_pdb_model_line</span><span class="p">(</span><span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PDBIO-68"><a href="#PDBIO-68"><span class="linenos">  68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-69"><a href="#PDBIO-69"><span class="linenos">  69</span></a><span class="sd">        Creates a MODEL (start model) line for a PDB file.</span>
</span><span id="PDBIO-70"><a href="#PDBIO-70"><span class="linenos">  70</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-71"><a href="#PDBIO-71"><span class="linenos">  71</span></a>        <span class="k">return</span> <span class="s2">&quot;MODEL&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>
</span><span id="PDBIO-72"><a href="#PDBIO-72"><span class="linenos">  72</span></a>
</span><span id="PDBIO-73"><a href="#PDBIO-73"><span class="linenos">  73</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-74"><a href="#PDBIO-74"><span class="linenos">  74</span></a>    <span class="c1"># ENDMDL</span>
</span><span id="PDBIO-75"><a href="#PDBIO-75"><span class="linenos">  75</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-76"><a href="#PDBIO-76"><span class="linenos">  76</span></a>
</span><span id="PDBIO-77"><a href="#PDBIO-77"><span class="linenos">  77</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-78"><a href="#PDBIO-78"><span class="linenos">  78</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_end_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO-79"><a href="#PDBIO-79"><span class="linenos">  79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-80"><a href="#PDBIO-80"><span class="linenos">  80</span></a><span class="sd">        Parse a ENDMDL (end model) line from a PDB file.</span>
</span><span id="PDBIO-81"><a href="#PDBIO-81"><span class="linenos">  81</span></a>
</span><span id="PDBIO-82"><a href="#PDBIO-82"><span class="linenos">  82</span></a><span class="sd">        COLUMNS       DATA  TYPE     FIELD        DEFINITION</span>
</span><span id="PDBIO-83"><a href="#PDBIO-83"><span class="linenos">  83</span></a><span class="sd">        ------------------------------------------------------------------</span>
</span><span id="PDBIO-84"><a href="#PDBIO-84"><span class="linenos">  84</span></a><span class="sd">        1 - 6         Record name   &quot;ENDMDL&quot;</span>
</span><span id="PDBIO-85"><a href="#PDBIO-85"><span class="linenos">  85</span></a>
</span><span id="PDBIO-86"><a href="#PDBIO-86"><span class="linenos">  86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-87"><a href="#PDBIO-87"><span class="linenos">  87</span></a>        <span class="n">pdb_end_model_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-88"><a href="#PDBIO-88"><span class="linenos">  88</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ENDMDL&quot;</span>
</span><span id="PDBIO-89"><a href="#PDBIO-89"><span class="linenos">  89</span></a>        <span class="p">}</span>
</span><span id="PDBIO-90"><a href="#PDBIO-90"><span class="linenos">  90</span></a>
</span><span id="PDBIO-91"><a href="#PDBIO-91"><span class="linenos">  91</span></a>        <span class="k">return</span> <span class="n">pdb_end_model_dict</span>
</span><span id="PDBIO-92"><a href="#PDBIO-92"><span class="linenos">  92</span></a>
</span><span id="PDBIO-93"><a href="#PDBIO-93"><span class="linenos">  93</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-94"><a href="#PDBIO-94"><span class="linenos">  94</span></a>    <span class="k">def</span> <span class="nf">create_pdb_end_model_line</span><span class="p">():</span>
</span><span id="PDBIO-95"><a href="#PDBIO-95"><span class="linenos">  95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-96"><a href="#PDBIO-96"><span class="linenos">  96</span></a><span class="sd">        Creates a ENDMDL (end model) line for a PDB file.</span>
</span><span id="PDBIO-97"><a href="#PDBIO-97"><span class="linenos">  97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-98"><a href="#PDBIO-98"><span class="linenos">  98</span></a>        <span class="k">return</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="PDBIO-99"><a href="#PDBIO-99"><span class="linenos">  99</span></a>
</span><span id="PDBIO-100"><a href="#PDBIO-100"><span class="linenos"> 100</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-101"><a href="#PDBIO-101"><span class="linenos"> 101</span></a>    <span class="c1"># MASTER</span>
</span><span id="PDBIO-102"><a href="#PDBIO-102"><span class="linenos"> 102</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-103"><a href="#PDBIO-103"><span class="linenos"> 103</span></a>
</span><span id="PDBIO-104"><a href="#PDBIO-104"><span class="linenos"> 104</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-105"><a href="#PDBIO-105"><span class="linenos"> 105</span></a>    <span class="k">def</span> <span class="nf">create_pdb_master_line</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_hetatoms</span><span class="p">,</span> <span class="n">num_ter</span><span class="p">,</span> <span class="n">num_remark</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_het</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_helix</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_sheet</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="PDBIO-106"><a href="#PDBIO-106"><span class="linenos"> 106</span></a>                               <span class="n">num_site</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_trans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_conect</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_seqres</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="PDBIO-107"><a href="#PDBIO-107"><span class="linenos"> 107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-108"><a href="#PDBIO-108"><span class="linenos"> 108</span></a><span class="sd">        Creates a MASTER (recordkeeping) line for a PDB file.</span>
</span><span id="PDBIO-109"><a href="#PDBIO-109"><span class="linenos"> 109</span></a>
</span><span id="PDBIO-110"><a href="#PDBIO-110"><span class="linenos"> 110</span></a><span class="sd">        COLUMNS         DATA TYPE     FIELD          DEFINITION</span>
</span><span id="PDBIO-111"><a href="#PDBIO-111"><span class="linenos"> 111</span></a><span class="sd">        ----------------------------------------------------------------------------------</span>
</span><span id="PDBIO-112"><a href="#PDBIO-112"><span class="linenos"> 112</span></a><span class="sd">         1 -  6         Record name   &quot;MASTER&quot;</span>
</span><span id="PDBIO-113"><a href="#PDBIO-113"><span class="linenos"> 113</span></a><span class="sd">        11 - 15         Integer       numRemark      Number of REMARK records</span>
</span><span id="PDBIO-114"><a href="#PDBIO-114"><span class="linenos"> 114</span></a><span class="sd">        16 - 20         Integer       &quot;0&quot;</span>
</span><span id="PDBIO-115"><a href="#PDBIO-115"><span class="linenos"> 115</span></a><span class="sd">        21 - 25         Integer       numHet         Number of HET records</span>
</span><span id="PDBIO-116"><a href="#PDBIO-116"><span class="linenos"> 116</span></a><span class="sd">        26 - 30         Integer       numHelix       Number of HELIX records</span>
</span><span id="PDBIO-117"><a href="#PDBIO-117"><span class="linenos"> 117</span></a><span class="sd">        31 - 35         Integer       numSheet       Number of SHEET records</span>
</span><span id="PDBIO-118"><a href="#PDBIO-118"><span class="linenos"> 118</span></a><span class="sd">        36 - 40         Integer       numTurn        deprecated</span>
</span><span id="PDBIO-119"><a href="#PDBIO-119"><span class="linenos"> 119</span></a><span class="sd">        41 - 45         Integer       numSite        Number of SITE records</span>
</span><span id="PDBIO-120"><a href="#PDBIO-120"><span class="linenos"> 120</span></a><span class="sd">        46 - 50         Integer       numXform       Number of coordinate transformation</span>
</span><span id="PDBIO-121"><a href="#PDBIO-121"><span class="linenos"> 121</span></a><span class="sd">                                                     records  (ORIGX+SCALE+MTRIX)</span>
</span><span id="PDBIO-122"><a href="#PDBIO-122"><span class="linenos"> 122</span></a><span class="sd">        51 - 55         Integer       numCoord       Number of atomic coordinate records</span>
</span><span id="PDBIO-123"><a href="#PDBIO-123"><span class="linenos"> 123</span></a><span class="sd">                                                     records (ATOM+HETATM)</span>
</span><span id="PDBIO-124"><a href="#PDBIO-124"><span class="linenos"> 124</span></a><span class="sd">        56 - 60         Integer       numTer         Number of TER records</span>
</span><span id="PDBIO-125"><a href="#PDBIO-125"><span class="linenos"> 125</span></a><span class="sd">        61 - 65         Integer       numConect      Number of CONECT records</span>
</span><span id="PDBIO-126"><a href="#PDBIO-126"><span class="linenos"> 126</span></a><span class="sd">        66 - 70         Integer       numSeq         Number of SEQRES records</span>
</span><span id="PDBIO-127"><a href="#PDBIO-127"><span class="linenos"> 127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-128"><a href="#PDBIO-128"><span class="linenos"> 128</span></a>
</span><span id="PDBIO-129"><a href="#PDBIO-129"><span class="linenos"> 129</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PDBIO-130"><a href="#PDBIO-130"><span class="linenos"> 130</span></a>            <span class="s2">&quot;MASTER&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
</span><span id="PDBIO-131"><a href="#PDBIO-131"><span class="linenos"> 131</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_remark</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-132"><a href="#PDBIO-132"><span class="linenos"> 132</span></a>            <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-133"><a href="#PDBIO-133"><span class="linenos"> 133</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_het</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-134"><a href="#PDBIO-134"><span class="linenos"> 134</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_helix</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-135"><a href="#PDBIO-135"><span class="linenos"> 135</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_sheet</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-136"><a href="#PDBIO-136"><span class="linenos"> 136</span></a>            <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-137"><a href="#PDBIO-137"><span class="linenos"> 137</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_site</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-138"><a href="#PDBIO-138"><span class="linenos"> 138</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_trans</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-139"><a href="#PDBIO-139"><span class="linenos"> 139</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_atoms</span> <span class="o">+</span> <span class="n">num_hetatoms</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-140"><a href="#PDBIO-140"><span class="linenos"> 140</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_ter</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-141"><a href="#PDBIO-141"><span class="linenos"> 141</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_conect</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-142"><a href="#PDBIO-142"><span class="linenos"> 142</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_seqres</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO-143"><a href="#PDBIO-143"><span class="linenos"> 143</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="PDBIO-144"><a href="#PDBIO-144"><span class="linenos"> 144</span></a>        <span class="p">]</span>
</span><span id="PDBIO-145"><a href="#PDBIO-145"><span class="linenos"> 145</span></a>
</span><span id="PDBIO-146"><a href="#PDBIO-146"><span class="linenos"> 146</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</span><span id="PDBIO-147"><a href="#PDBIO-147"><span class="linenos"> 147</span></a>
</span><span id="PDBIO-148"><a href="#PDBIO-148"><span class="linenos"> 148</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-149"><a href="#PDBIO-149"><span class="linenos"> 149</span></a>    <span class="c1"># SEQRES</span>
</span><span id="PDBIO-150"><a href="#PDBIO-150"><span class="linenos"> 150</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-151"><a href="#PDBIO-151"><span class="linenos"> 151</span></a>
</span><span id="PDBIO-152"><a href="#PDBIO-152"><span class="linenos"> 152</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-153"><a href="#PDBIO-153"><span class="linenos"> 153</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_seqres_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO-154"><a href="#PDBIO-154"><span class="linenos"> 154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-155"><a href="#PDBIO-155"><span class="linenos"> 155</span></a><span class="sd">        Parse a SEQRES (sequence) line from a PDB file.</span>
</span><span id="PDBIO-156"><a href="#PDBIO-156"><span class="linenos"> 156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-157"><a href="#PDBIO-157"><span class="linenos"> 157</span></a>        <span class="n">pdb_seqres_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-158"><a href="#PDBIO-158"><span class="linenos"> 158</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">,</span>
</span><span id="PDBIO-159"><a href="#PDBIO-159"><span class="linenos"> 159</span></a>            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
</span><span id="PDBIO-160"><a href="#PDBIO-160"><span class="linenos"> 160</span></a>            <span class="s2">&quot;residues&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="PDBIO-161"><a href="#PDBIO-161"><span class="linenos"> 161</span></a>        <span class="p">}</span>
</span><span id="PDBIO-162"><a href="#PDBIO-162"><span class="linenos"> 162</span></a>
</span><span id="PDBIO-163"><a href="#PDBIO-163"><span class="linenos"> 163</span></a>        <span class="k">return</span> <span class="n">pdb_seqres_dict</span>
</span><span id="PDBIO-164"><a href="#PDBIO-164"><span class="linenos"> 164</span></a>
</span><span id="PDBIO-165"><a href="#PDBIO-165"><span class="linenos"> 165</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-166"><a href="#PDBIO-166"><span class="linenos"> 166</span></a>    <span class="k">def</span> <span class="nf">create_seqres_line</span><span class="p">(</span><span class="n">line_no</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">num_residues</span><span class="p">,</span> <span class="n">residues</span><span class="p">):</span>
</span><span id="PDBIO-167"><a href="#PDBIO-167"><span class="linenos"> 167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-168"><a href="#PDBIO-168"><span class="linenos"> 168</span></a><span class="sd">        Creates a SEQRES (sequence) line for a PDB file.</span>
</span><span id="PDBIO-169"><a href="#PDBIO-169"><span class="linenos"> 169</span></a>
</span><span id="PDBIO-170"><a href="#PDBIO-170"><span class="linenos"> 170</span></a><span class="sd">         1 -  6        Record name    &quot;SEQRES&quot;</span>
</span><span id="PDBIO-171"><a href="#PDBIO-171"><span class="linenos"> 171</span></a><span class="sd">         8 - 10        Integer        serNum       Serial number of the SEQRES record for  the</span>
</span><span id="PDBIO-172"><a href="#PDBIO-172"><span class="linenos"> 172</span></a><span class="sd">                                                   current  chain. Starts at 1 and increments</span>
</span><span id="PDBIO-173"><a href="#PDBIO-173"><span class="linenos"> 173</span></a><span class="sd">                                                   by one  each line. Reset to 1 for each chain.</span>
</span><span id="PDBIO-174"><a href="#PDBIO-174"><span class="linenos"> 174</span></a><span class="sd">        12             Character      chainID      Chain identifier. This may be any single</span>
</span><span id="PDBIO-175"><a href="#PDBIO-175"><span class="linenos"> 175</span></a><span class="sd">                                                   legal  character, including a blank which</span>
</span><span id="PDBIO-176"><a href="#PDBIO-176"><span class="linenos"> 176</span></a><span class="sd">                                                   is used if there is only one chain.</span>
</span><span id="PDBIO-177"><a href="#PDBIO-177"><span class="linenos"> 177</span></a><span class="sd">        14 - 17        Integer        numRes       Number of residues in the chain.</span>
</span><span id="PDBIO-178"><a href="#PDBIO-178"><span class="linenos"> 178</span></a><span class="sd">                                                   This  value is repeated on every record.</span>
</span><span id="PDBIO-179"><a href="#PDBIO-179"><span class="linenos"> 179</span></a><span class="sd">        20 - 22        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-180"><a href="#PDBIO-180"><span class="linenos"> 180</span></a><span class="sd">        24 - 26        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-181"><a href="#PDBIO-181"><span class="linenos"> 181</span></a><span class="sd">        28 - 30        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-182"><a href="#PDBIO-182"><span class="linenos"> 182</span></a><span class="sd">        32 - 34        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-183"><a href="#PDBIO-183"><span class="linenos"> 183</span></a><span class="sd">        36 - 38        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-184"><a href="#PDBIO-184"><span class="linenos"> 184</span></a><span class="sd">        40 - 42        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-185"><a href="#PDBIO-185"><span class="linenos"> 185</span></a><span class="sd">        44 - 46        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-186"><a href="#PDBIO-186"><span class="linenos"> 186</span></a><span class="sd">        48 - 50        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-187"><a href="#PDBIO-187"><span class="linenos"> 187</span></a><span class="sd">        52 - 54        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-188"><a href="#PDBIO-188"><span class="linenos"> 188</span></a><span class="sd">        56 - 58        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-189"><a href="#PDBIO-189"><span class="linenos"> 189</span></a><span class="sd">        60 - 62        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-190"><a href="#PDBIO-190"><span class="linenos"> 190</span></a><span class="sd">        64 - 66        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-191"><a href="#PDBIO-191"><span class="linenos"> 191</span></a><span class="sd">        68 - 70        Residue name   resName      Residue name.</span>
</span><span id="PDBIO-192"><a href="#PDBIO-192"><span class="linenos"> 192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-193"><a href="#PDBIO-193"><span class="linenos"> 193</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PDBIO-194"><a href="#PDBIO-194"><span class="linenos"> 194</span></a>            <span class="s2">&quot;SEQRES &quot;</span><span class="p">,</span>
</span><span id="PDBIO-195"><a href="#PDBIO-195"><span class="linenos"> 195</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">line_no</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
</span><span id="PDBIO-196"><a href="#PDBIO-196"><span class="linenos"> 196</span></a>            <span class="n">chain_id</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
</span><span id="PDBIO-197"><a href="#PDBIO-197"><span class="linenos"> 197</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_residues</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span>
</span><span id="PDBIO-198"><a href="#PDBIO-198"><span class="linenos"> 198</span></a>        <span class="p">]</span>
</span><span id="PDBIO-199"><a href="#PDBIO-199"><span class="linenos"> 199</span></a>        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
</span><span id="PDBIO-200"><a href="#PDBIO-200"><span class="linenos"> 200</span></a>            <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residue</span><span class="p">[</span><span class="s2">&quot;residue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="PDBIO-201"><a href="#PDBIO-201"><span class="linenos"> 201</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="PDBIO-202"><a href="#PDBIO-202"><span class="linenos"> 202</span></a>
</span><span id="PDBIO-203"><a href="#PDBIO-203"><span class="linenos"> 203</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-204"><a href="#PDBIO-204"><span class="linenos"> 204</span></a>    <span class="c1"># TER</span>
</span><span id="PDBIO-205"><a href="#PDBIO-205"><span class="linenos"> 205</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-206"><a href="#PDBIO-206"><span class="linenos"> 206</span></a>
</span><span id="PDBIO-207"><a href="#PDBIO-207"><span class="linenos"> 207</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-208"><a href="#PDBIO-208"><span class="linenos"> 208</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_ter_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO-209"><a href="#PDBIO-209"><span class="linenos"> 209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-210"><a href="#PDBIO-210"><span class="linenos"> 210</span></a><span class="sd">        Parse a TER (chain termination) line from a PDB file.</span>
</span><span id="PDBIO-211"><a href="#PDBIO-211"><span class="linenos"> 211</span></a>
</span><span id="PDBIO-212"><a href="#PDBIO-212"><span class="linenos"> 212</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD           DEFINITION</span>
</span><span id="PDBIO-213"><a href="#PDBIO-213"><span class="linenos"> 213</span></a><span class="sd">        -------------------------------------------------------------------------</span>
</span><span id="PDBIO-214"><a href="#PDBIO-214"><span class="linenos"> 214</span></a><span class="sd">         1 -  6        Record name   &quot;TER   &quot;</span>
</span><span id="PDBIO-215"><a href="#PDBIO-215"><span class="linenos"> 215</span></a><span class="sd">         7 - 11        Integer       serial          Serial number.</span>
</span><span id="PDBIO-216"><a href="#PDBIO-216"><span class="linenos"> 216</span></a><span class="sd">        18 - 20        Residue name  resName         Residue name.</span>
</span><span id="PDBIO-217"><a href="#PDBIO-217"><span class="linenos"> 217</span></a><span class="sd">        22             Character     chainID         Chain identifier.</span>
</span><span id="PDBIO-218"><a href="#PDBIO-218"><span class="linenos"> 218</span></a><span class="sd">        23 - 26        Integer       resSeq          Residue sequence number.</span>
</span><span id="PDBIO-219"><a href="#PDBIO-219"><span class="linenos"> 219</span></a><span class="sd">        27             AChar         iCode           Insertion code.</span>
</span><span id="PDBIO-220"><a href="#PDBIO-220"><span class="linenos"> 220</span></a>
</span><span id="PDBIO-221"><a href="#PDBIO-221"><span class="linenos"> 221</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-222"><a href="#PDBIO-222"><span class="linenos"> 222</span></a>        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="PDBIO-223"><a href="#PDBIO-223"><span class="linenos"> 223</span></a>            <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-224"><a href="#PDBIO-224"><span class="linenos"> 224</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TER&quot;</span><span class="p">,</span>
</span><span id="PDBIO-225"><a href="#PDBIO-225"><span class="linenos"> 225</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO-226"><a href="#PDBIO-226"><span class="linenos"> 226</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO-227"><a href="#PDBIO-227"><span class="linenos"> 227</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO-228"><a href="#PDBIO-228"><span class="linenos"> 228</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO-229"><a href="#PDBIO-229"><span class="linenos"> 229</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
</span><span id="PDBIO-230"><a href="#PDBIO-230"><span class="linenos"> 230</span></a>            <span class="p">}</span>
</span><span id="PDBIO-231"><a href="#PDBIO-231"><span class="linenos"> 231</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO-232"><a href="#PDBIO-232"><span class="linenos"> 232</span></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="PDBIO-233"><a href="#PDBIO-233"><span class="linenos"> 233</span></a>            <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-234"><a href="#PDBIO-234"><span class="linenos"> 234</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TER&quot;</span><span class="p">,</span>
</span><span id="PDBIO-235"><a href="#PDBIO-235"><span class="linenos"> 235</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span>
</span><span id="PDBIO-236"><a href="#PDBIO-236"><span class="linenos"> 236</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">21</span><span class="p">],</span>
</span><span id="PDBIO-237"><a href="#PDBIO-237"><span class="linenos"> 237</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span>
</span><span id="PDBIO-238"><a href="#PDBIO-238"><span class="linenos"> 238</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">],</span>
</span><span id="PDBIO-239"><a href="#PDBIO-239"><span class="linenos"> 239</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
</span><span id="PDBIO-240"><a href="#PDBIO-240"><span class="linenos"> 240</span></a>            <span class="p">}</span>
</span><span id="PDBIO-241"><a href="#PDBIO-241"><span class="linenos"> 241</span></a>        <span class="k">return</span> <span class="n">pdb_ter_dict</span>
</span><span id="PDBIO-242"><a href="#PDBIO-242"><span class="linenos"> 242</span></a>
</span><span id="PDBIO-243"><a href="#PDBIO-243"><span class="linenos"> 243</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-244"><a href="#PDBIO-244"><span class="linenos"> 244</span></a>    <span class="k">def</span> <span class="nf">create_pdb_ter_line</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span> <span class="n">res_name</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">res_seq</span><span class="p">,</span> <span class="n">icode</span><span class="p">):</span>
</span><span id="PDBIO-245"><a href="#PDBIO-245"><span class="linenos"> 245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-246"><a href="#PDBIO-246"><span class="linenos"> 246</span></a><span class="sd">        Creates a TER (chain termination) line for a PDB file.</span>
</span><span id="PDBIO-247"><a href="#PDBIO-247"><span class="linenos"> 247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-248"><a href="#PDBIO-248"><span class="linenos"> 248</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;TER&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="PDBIO-249"><a href="#PDBIO-249"><span class="linenos"> 249</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;      &quot;</span>
</span><span id="PDBIO-250"><a href="#PDBIO-250"><span class="linenos"> 250</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">res_name</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO-251"><a href="#PDBIO-251"><span class="linenos"> 251</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">chain_id</span>
</span><span id="PDBIO-252"><a href="#PDBIO-252"><span class="linenos"> 252</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">res_seq</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO-253"><a href="#PDBIO-253"><span class="linenos"> 253</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">icode</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PDBIO-254"><a href="#PDBIO-254"><span class="linenos"> 254</span></a>
</span><span id="PDBIO-255"><a href="#PDBIO-255"><span class="linenos"> 255</span></a>        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="PDBIO-256"><a href="#PDBIO-256"><span class="linenos"> 256</span></a>
</span><span id="PDBIO-257"><a href="#PDBIO-257"><span class="linenos"> 257</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-258"><a href="#PDBIO-258"><span class="linenos"> 258</span></a>    <span class="c1"># ATOM | HETATM</span>
</span><span id="PDBIO-259"><a href="#PDBIO-259"><span class="linenos"> 259</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-260"><a href="#PDBIO-260"><span class="linenos"> 260</span></a>
</span><span id="PDBIO-261"><a href="#PDBIO-261"><span class="linenos"> 261</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-262"><a href="#PDBIO-262"><span class="linenos"> 262</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="PDBIO-263"><a href="#PDBIO-263"><span class="linenos"> 263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-264"><a href="#PDBIO-264"><span class="linenos"> 264</span></a><span class="sd">        Parse a ATOM (individual atom) or HETATM (hetero atom) line from a PDB file.</span>
</span><span id="PDBIO-265"><a href="#PDBIO-265"><span class="linenos"> 265</span></a>
</span><span id="PDBIO-266"><a href="#PDBIO-266"><span class="linenos"> 266</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD        DEFINITION</span>
</span><span id="PDBIO-267"><a href="#PDBIO-267"><span class="linenos"> 267</span></a><span class="sd">        -------------------------------------------------------------------------------------</span>
</span><span id="PDBIO-268"><a href="#PDBIO-268"><span class="linenos"> 268</span></a><span class="sd">         1 -  6        Record name   &quot;ATOM  &quot;</span>
</span><span id="PDBIO-269"><a href="#PDBIO-269"><span class="linenos"> 269</span></a><span class="sd">         7 - 11        Integer       serial       Atom  serial number.</span>
</span><span id="PDBIO-270"><a href="#PDBIO-270"><span class="linenos"> 270</span></a><span class="sd">        13 - 16        Atom          name         Atom name.</span>
</span><span id="PDBIO-271"><a href="#PDBIO-271"><span class="linenos"> 271</span></a><span class="sd">        17             Character     altLoc       Alternate location indicator.</span>
</span><span id="PDBIO-272"><a href="#PDBIO-272"><span class="linenos"> 272</span></a><span class="sd">        18 - 20        Residue name  resName      Residue name.</span>
</span><span id="PDBIO-273"><a href="#PDBIO-273"><span class="linenos"> 273</span></a><span class="sd">        22             Character     chainID      Chain identifier.</span>
</span><span id="PDBIO-274"><a href="#PDBIO-274"><span class="linenos"> 274</span></a><span class="sd">        23 - 26        Integer       resSeq       Residue sequence number.</span>
</span><span id="PDBIO-275"><a href="#PDBIO-275"><span class="linenos"> 275</span></a><span class="sd">        27             AChar         iCode        Code for insertion of residues.</span>
</span><span id="PDBIO-276"><a href="#PDBIO-276"><span class="linenos"> 276</span></a><span class="sd">        31 - 38        Real(8.3)     x            Orthogonal coordinates for X in Angstroms.</span>
</span><span id="PDBIO-277"><a href="#PDBIO-277"><span class="linenos"> 277</span></a><span class="sd">        39 - 46        Real(8.3)     y            Orthogonal coordinates for Y in Angstroms.</span>
</span><span id="PDBIO-278"><a href="#PDBIO-278"><span class="linenos"> 278</span></a><span class="sd">        47 - 54        Real(8.3)     z            Orthogonal coordinates for Z in Angstroms.</span>
</span><span id="PDBIO-279"><a href="#PDBIO-279"><span class="linenos"> 279</span></a><span class="sd">        55 - 60        Real(6.2)     occupancy    Occupancy.</span>
</span><span id="PDBIO-280"><a href="#PDBIO-280"><span class="linenos"> 280</span></a><span class="sd">        61 - 66        Real(6.2)     tempFactor   Temperature  factor.</span>
</span><span id="PDBIO-281"><a href="#PDBIO-281"><span class="linenos"> 281</span></a><span class="sd">        77 - 78        LString(2)    element      Element symbol, right-justified.</span>
</span><span id="PDBIO-282"><a href="#PDBIO-282"><span class="linenos"> 282</span></a><span class="sd">        79 - 80        LString(2)    charge       Charge  on the atom.`</span>
</span><span id="PDBIO-283"><a href="#PDBIO-283"><span class="linenos"> 283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-284"><a href="#PDBIO-284"><span class="linenos"> 284</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="PDBIO-285"><a href="#PDBIO-285"><span class="linenos"> 285</span></a>            <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-286"><a href="#PDBIO-286"><span class="linenos"> 286</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
</span><span id="PDBIO-287"><a href="#PDBIO-287"><span class="linenos"> 287</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-288"><a href="#PDBIO-288"><span class="linenos"> 288</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO-289"><a href="#PDBIO-289"><span class="linenos"> 289</span></a>                <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-290"><a href="#PDBIO-290"><span class="linenos"> 290</span></a>                <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-291"><a href="#PDBIO-291"><span class="linenos"> 291</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-292"><a href="#PDBIO-292"><span class="linenos"> 292</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO-293"><a href="#PDBIO-293"><span class="linenos"> 293</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-294"><a href="#PDBIO-294"><span class="linenos"> 294</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-295"><a href="#PDBIO-295"><span class="linenos"> 295</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-296"><a href="#PDBIO-296"><span class="linenos"> 296</span></a>                <span class="c1"># 3x Open space</span>
</span><span id="PDBIO-297"><a href="#PDBIO-297"><span class="linenos"> 297</span></a>                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]),</span>
</span><span id="PDBIO-298"><a href="#PDBIO-298"><span class="linenos"> 298</span></a>                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]),</span>
</span><span id="PDBIO-299"><a href="#PDBIO-299"><span class="linenos"> 299</span></a>                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]),</span>
</span><span id="PDBIO-300"><a href="#PDBIO-300"><span class="linenos"> 300</span></a>                <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">60</span><span class="p">]),</span>
</span><span id="PDBIO-301"><a href="#PDBIO-301"><span class="linenos"> 301</span></a>                <span class="c1"># &quot;temp_factor&quot;: None,</span>
</span><span id="PDBIO-302"><a href="#PDBIO-302"><span class="linenos"> 302</span></a>                <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">66</span><span class="p">]),</span>
</span><span id="PDBIO-303"><a href="#PDBIO-303"><span class="linenos"> 303</span></a>                <span class="c1"># 66 - 75?</span>
</span><span id="PDBIO-304"><a href="#PDBIO-304"><span class="linenos"> 304</span></a>                <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-305"><a href="#PDBIO-305"><span class="linenos"> 305</span></a>                <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">78</span><span class="p">:</span><span class="mi">80</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-306"><a href="#PDBIO-306"><span class="linenos"> 306</span></a>                <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PDBIO-307"><a href="#PDBIO-307"><span class="linenos"> 307</span></a>                <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="PDBIO-308"><a href="#PDBIO-308"><span class="linenos"> 308</span></a>            <span class="p">}</span>
</span><span id="PDBIO-309"><a href="#PDBIO-309"><span class="linenos"> 309</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO-310"><a href="#PDBIO-310"><span class="linenos"> 310</span></a>            <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-311"><a href="#PDBIO-311"><span class="linenos"> 311</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
</span><span id="PDBIO-312"><a href="#PDBIO-312"><span class="linenos"> 312</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-313"><a href="#PDBIO-313"><span class="linenos"> 313</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO-314"><a href="#PDBIO-314"><span class="linenos"> 314</span></a>                <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-315"><a href="#PDBIO-315"><span class="linenos"> 315</span></a>                <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-316"><a href="#PDBIO-316"><span class="linenos"> 316</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-317"><a href="#PDBIO-317"><span class="linenos"> 317</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO-318"><a href="#PDBIO-318"><span class="linenos"> 318</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-319"><a href="#PDBIO-319"><span class="linenos"> 319</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-320"><a href="#PDBIO-320"><span class="linenos"> 320</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-321"><a href="#PDBIO-321"><span class="linenos"> 321</span></a>                <span class="c1"># 3x Open space</span>
</span><span id="PDBIO-322"><a href="#PDBIO-322"><span class="linenos"> 322</span></a>                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]),</span>
</span><span id="PDBIO-323"><a href="#PDBIO-323"><span class="linenos"> 323</span></a>                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]),</span>
</span><span id="PDBIO-324"><a href="#PDBIO-324"><span class="linenos"> 324</span></a>                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]),</span>
</span><span id="PDBIO-325"><a href="#PDBIO-325"><span class="linenos"> 325</span></a>
</span><span id="PDBIO-326"><a href="#PDBIO-326"><span class="linenos"> 326</span></a>                <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="PDBIO-327"><a href="#PDBIO-327"><span class="linenos"> 327</span></a>                <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PDBIO-328"><a href="#PDBIO-328"><span class="linenos"> 328</span></a>
</span><span id="PDBIO-329"><a href="#PDBIO-329"><span class="linenos"> 329</span></a>                <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO-330"><a href="#PDBIO-330"><span class="linenos"> 330</span></a>                <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PDBIO-331"><a href="#PDBIO-331"><span class="linenos"> 331</span></a>                <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">62</span><span class="p">]),</span>
</span><span id="PDBIO-332"><a href="#PDBIO-332"><span class="linenos"> 332</span></a>                <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">62</span><span class="p">:</span><span class="mi">70</span><span class="p">])</span>
</span><span id="PDBIO-333"><a href="#PDBIO-333"><span class="linenos"> 333</span></a>            <span class="p">}</span>
</span><span id="PDBIO-334"><a href="#PDBIO-334"><span class="linenos"> 334</span></a>        <span class="k">return</span> <span class="n">pdb_atom_dict</span>
</span><span id="PDBIO-335"><a href="#PDBIO-335"><span class="linenos"> 335</span></a>
</span><span id="PDBIO-336"><a href="#PDBIO-336"><span class="linenos"> 336</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-337"><a href="#PDBIO-337"><span class="linenos"> 337</span></a>    <span class="k">def</span> <span class="nf">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;ATOM&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PDBIO-338"><a href="#PDBIO-338"><span class="linenos"> 338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-339"><a href="#PDBIO-339"><span class="linenos"> 339</span></a><span class="sd">        Creates a ATOM or HETATM line for a PDB file.</span>
</span><span id="PDBIO-340"><a href="#PDBIO-340"><span class="linenos"> 340</span></a>
</span><span id="PDBIO-341"><a href="#PDBIO-341"><span class="linenos"> 341</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO-342"><a href="#PDBIO-342"><span class="linenos"> 342</span></a><span class="sd">            atom (Dict): The atom information.</span>
</span><span id="PDBIO-343"><a href="#PDBIO-343"><span class="linenos"> 343</span></a><span class="sd">            serial (int): The serial number of the atom.</span>
</span><span id="PDBIO-344"><a href="#PDBIO-344"><span class="linenos"> 344</span></a><span class="sd">            record_name (str): The record name, should be ATOM or HETATM.</span>
</span><span id="PDBIO-345"><a href="#PDBIO-345"><span class="linenos"> 345</span></a>
</span><span id="PDBIO-346"><a href="#PDBIO-346"><span class="linenos"> 346</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO-347"><a href="#PDBIO-347"><span class="linenos"> 347</span></a><span class="sd">            str: The ATOM or HETATM line.</span>
</span><span id="PDBIO-348"><a href="#PDBIO-348"><span class="linenos"> 348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-349"><a href="#PDBIO-349"><span class="linenos"> 349</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="PDBIO-350"><a href="#PDBIO-350"><span class="linenos"> 350</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO-351"><a href="#PDBIO-351"><span class="linenos"> 351</span></a>
</span><span id="PDBIO-352"><a href="#PDBIO-352"><span class="linenos"> 352</span></a>        <span class="c1"># The PDB spec says that if the element has two characters, e.g. Fe (iron)</span>
</span><span id="PDBIO-353"><a href="#PDBIO-353"><span class="linenos"> 353</span></a>        <span class="c1"># it should start at the position 13, otherwise it should start at position 14.</span>
</span><span id="PDBIO-354"><a href="#PDBIO-354"><span class="linenos"> 354</span></a>        <span class="c1"># This seems a little problematic, as some atoms could use 4 characters</span>
</span><span id="PDBIO-355"><a href="#PDBIO-355"><span class="linenos"> 355</span></a>        <span class="c1"># for example, HG11. The implementation here is consistent with observed PDBs</span>
</span><span id="PDBIO-356"><a href="#PDBIO-356"><span class="linenos"> 356</span></a>        <span class="c1"># from the RCSB.</span>
</span><span id="PDBIO-357"><a href="#PDBIO-357"><span class="linenos"> 357</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="PDBIO-358"><a href="#PDBIO-358"><span class="linenos"> 358</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO-359"><a href="#PDBIO-359"><span class="linenos"> 359</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO-360"><a href="#PDBIO-360"><span class="linenos"> 360</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="PDBIO-361"><a href="#PDBIO-361"><span class="linenos"> 361</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PDBIO-362"><a href="#PDBIO-362"><span class="linenos"> 362</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO-363"><a href="#PDBIO-363"><span class="linenos"> 363</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO-364"><a href="#PDBIO-364"><span class="linenos"> 364</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO-365"><a href="#PDBIO-365"><span class="linenos"> 365</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
</span><span id="PDBIO-366"><a href="#PDBIO-366"><span class="linenos"> 366</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-367"><a href="#PDBIO-367"><span class="linenos"> 367</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-368"><a href="#PDBIO-368"><span class="linenos"> 368</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-369"><a href="#PDBIO-369"><span class="linenos"> 369</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">1.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-370"><a href="#PDBIO-370"><span class="linenos"> 370</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-371"><a href="#PDBIO-371"><span class="linenos"> 371</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="PDBIO-372"><a href="#PDBIO-372"><span class="linenos"> 372</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PDBIO-373"><a href="#PDBIO-373"><span class="linenos"> 373</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PDBIO-374"><a href="#PDBIO-374"><span class="linenos"> 374</span></a>        <span class="k">return</span> <span class="n">text</span>
</span><span id="PDBIO-375"><a href="#PDBIO-375"><span class="linenos"> 375</span></a>
</span><span id="PDBIO-376"><a href="#PDBIO-376"><span class="linenos"> 376</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-377"><a href="#PDBIO-377"><span class="linenos"> 377</span></a>    <span class="k">def</span> <span class="nf">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;ATOM&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PDBIO-378"><a href="#PDBIO-378"><span class="linenos"> 378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-379"><a href="#PDBIO-379"><span class="linenos"> 379</span></a><span class="sd">        Creates a ATOM or HETATM line for a PQR file.</span>
</span><span id="PDBIO-380"><a href="#PDBIO-380"><span class="linenos"> 380</span></a>
</span><span id="PDBIO-381"><a href="#PDBIO-381"><span class="linenos"> 381</span></a><span class="sd">        The PQR line is similar to the PDB ATOM line, but with additional fields</span>
</span><span id="PDBIO-382"><a href="#PDBIO-382"><span class="linenos"> 382</span></a><span class="sd">        for atomic charge and radius. The occupancy, temperature factor,</span>
</span><span id="PDBIO-383"><a href="#PDBIO-383"><span class="linenos"> 383</span></a><span class="sd">        charge and element fields from the PDB file are not used in the PQR file.</span>
</span><span id="PDBIO-384"><a href="#PDBIO-384"><span class="linenos"> 384</span></a>
</span><span id="PDBIO-385"><a href="#PDBIO-385"><span class="linenos"> 385</span></a><span class="sd">        See: https://pdb2pqr.readthedocs.io/en/latest/formats/pqr.html</span>
</span><span id="PDBIO-386"><a href="#PDBIO-386"><span class="linenos"> 386</span></a><span class="sd">        The order of fields in a PQR file is as follows:</span>
</span><span id="PDBIO-387"><a href="#PDBIO-387"><span class="linenos"> 387</span></a><span class="sd">        Field_name Atom_number Atom_name Residue_name Chain_ID Residue_number</span>
</span><span id="PDBIO-388"><a href="#PDBIO-388"><span class="linenos"> 388</span></a><span class="sd">        X Y Z Charge Radius</span>
</span><span id="PDBIO-389"><a href="#PDBIO-389"><span class="linenos"> 389</span></a>
</span><span id="PDBIO-390"><a href="#PDBIO-390"><span class="linenos"> 390</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO-391"><a href="#PDBIO-391"><span class="linenos"> 391</span></a><span class="sd">            atom (Dict): The atom information.</span>
</span><span id="PDBIO-392"><a href="#PDBIO-392"><span class="linenos"> 392</span></a><span class="sd">            serial (int): The serial number of the atom.</span>
</span><span id="PDBIO-393"><a href="#PDBIO-393"><span class="linenos"> 393</span></a><span class="sd">            record_name (str): The record name, should be ATOM or HETATM.</span>
</span><span id="PDBIO-394"><a href="#PDBIO-394"><span class="linenos"> 394</span></a>
</span><span id="PDBIO-395"><a href="#PDBIO-395"><span class="linenos"> 395</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO-396"><a href="#PDBIO-396"><span class="linenos"> 396</span></a><span class="sd">            str: The PQR ATOM or HETATM line.</span>
</span><span id="PDBIO-397"><a href="#PDBIO-397"><span class="linenos"> 397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-398"><a href="#PDBIO-398"><span class="linenos"> 398</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="PDBIO-399"><a href="#PDBIO-399"><span class="linenos"> 399</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO-400"><a href="#PDBIO-400"><span class="linenos"> 400</span></a>
</span><span id="PDBIO-401"><a href="#PDBIO-401"><span class="linenos"> 401</span></a>        <span class="c1"># The PDB spec says that if the element has two characters, e.g. Fe (iron)</span>
</span><span id="PDBIO-402"><a href="#PDBIO-402"><span class="linenos"> 402</span></a>        <span class="c1"># it should start at the position 13, otherwise it should start at position 14.</span>
</span><span id="PDBIO-403"><a href="#PDBIO-403"><span class="linenos"> 403</span></a>        <span class="c1"># This seems a little problematic, as some atoms could use 4 characters</span>
</span><span id="PDBIO-404"><a href="#PDBIO-404"><span class="linenos"> 404</span></a>        <span class="c1"># for example, HG11. The implementation here is consistent with observed PDBs</span>
</span><span id="PDBIO-405"><a href="#PDBIO-405"><span class="linenos"> 405</span></a>        <span class="c1"># from the RCSB.</span>
</span><span id="PDBIO-406"><a href="#PDBIO-406"><span class="linenos"> 406</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="PDBIO-407"><a href="#PDBIO-407"><span class="linenos"> 407</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO-408"><a href="#PDBIO-408"><span class="linenos"> 408</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO-409"><a href="#PDBIO-409"><span class="linenos"> 409</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="PDBIO-410"><a href="#PDBIO-410"><span class="linenos"> 410</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PDBIO-411"><a href="#PDBIO-411"><span class="linenos"> 411</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO-412"><a href="#PDBIO-412"><span class="linenos"> 412</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO-413"><a href="#PDBIO-413"><span class="linenos"> 413</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO-414"><a href="#PDBIO-414"><span class="linenos"> 414</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
</span><span id="PDBIO-415"><a href="#PDBIO-415"><span class="linenos"> 415</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-416"><a href="#PDBIO-416"><span class="linenos"> 416</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-417"><a href="#PDBIO-417"><span class="linenos"> 417</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-418"><a href="#PDBIO-418"><span class="linenos"> 418</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-419"><a href="#PDBIO-419"><span class="linenos"> 419</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">7.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO-420"><a href="#PDBIO-420"><span class="linenos"> 420</span></a>        <span class="c1"># text += f&#39;{1.0 if atom[&quot;occupancy&quot;] is None else atom[&quot;occupancy&quot;]:6.2f}&#39;</span>
</span><span id="PDBIO-421"><a href="#PDBIO-421"><span class="linenos"> 421</span></a>        <span class="c1"># text += f&#39;{0.0 if atom[&quot;temp_factor&quot;] is None else atom[&quot;temp_factor&quot;]:6.2f}&#39;</span>
</span><span id="PDBIO-422"><a href="#PDBIO-422"><span class="linenos"> 422</span></a>        <span class="c1"># text += &quot;&quot;.ljust(10)</span>
</span><span id="PDBIO-423"><a href="#PDBIO-423"><span class="linenos"> 423</span></a>        <span class="c1"># text += atom[&quot;element&quot;].rjust(2)</span>
</span><span id="PDBIO-424"><a href="#PDBIO-424"><span class="linenos"> 424</span></a>        <span class="c1"># text += (&quot;&quot; if atom[&quot;charge&quot;] is None else atom[&quot;charge&quot;]).rjust(2)</span>
</span><span id="PDBIO-425"><a href="#PDBIO-425"><span class="linenos"> 425</span></a>
</span><span id="PDBIO-426"><a href="#PDBIO-426"><span class="linenos"> 426</span></a>        <span class="k">return</span> <span class="n">text</span>
</span><span id="PDBIO-427"><a href="#PDBIO-427"><span class="linenos"> 427</span></a>
</span><span id="PDBIO-428"><a href="#PDBIO-428"><span class="linenos"> 428</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-429"><a href="#PDBIO-429"><span class="linenos"> 429</span></a>    <span class="c1"># Main parsing and saving functions</span>
</span><span id="PDBIO-430"><a href="#PDBIO-430"><span class="linenos"> 430</span></a>    <span class="c1"># --------------------------------------------------------------------------------</span>
</span><span id="PDBIO-431"><a href="#PDBIO-431"><span class="linenos"> 431</span></a>
</span><span id="PDBIO-432"><a href="#PDBIO-432"><span class="linenos"> 432</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-433"><a href="#PDBIO-433"><span class="linenos"> 433</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="PDBIO-434"><a href="#PDBIO-434"><span class="linenos"> 434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-435"><a href="#PDBIO-435"><span class="linenos"> 435</span></a><span class="sd">        Parse a PDB file in string format into a list of entries.</span>
</span><span id="PDBIO-436"><a href="#PDBIO-436"><span class="linenos"> 436</span></a>
</span><span id="PDBIO-437"><a href="#PDBIO-437"><span class="linenos"> 437</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO-438"><a href="#PDBIO-438"><span class="linenos"> 438</span></a><span class="sd">            pdb_string (str): The PDB file as a string.</span>
</span><span id="PDBIO-439"><a href="#PDBIO-439"><span class="linenos"> 439</span></a><span class="sd">            is_pqr_format (bool): If the file is in PQR format.</span>
</span><span id="PDBIO-440"><a href="#PDBIO-440"><span class="linenos"> 440</span></a>
</span><span id="PDBIO-441"><a href="#PDBIO-441"><span class="linenos"> 441</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO-442"><a href="#PDBIO-442"><span class="linenos"> 442</span></a><span class="sd">            List[Dict]: A list of parsed entries.</span>
</span><span id="PDBIO-443"><a href="#PDBIO-443"><span class="linenos"> 443</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-444"><a href="#PDBIO-444"><span class="linenos"> 444</span></a>
</span><span id="PDBIO-445"><a href="#PDBIO-445"><span class="linenos"> 445</span></a>        <span class="c1"># Split the string into lines</span>
</span><span id="PDBIO-446"><a href="#PDBIO-446"><span class="linenos"> 446</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">pdb_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PDBIO-447"><a href="#PDBIO-447"><span class="linenos"> 447</span></a>
</span><span id="PDBIO-448"><a href="#PDBIO-448"><span class="linenos"> 448</span></a>        <span class="c1"># Parse every line into dictionary information</span>
</span><span id="PDBIO-449"><a href="#PDBIO-449"><span class="linenos"> 449</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO-450"><a href="#PDBIO-450"><span class="linenos"> 450</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PDBIO-451"><a href="#PDBIO-451"><span class="linenos"> 451</span></a>            <span class="n">record_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="PDBIO-452"><a href="#PDBIO-452"><span class="linenos"> 452</span></a>            <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span><span class="p">:</span>
</span><span id="PDBIO-453"><a href="#PDBIO-453"><span class="linenos"> 453</span></a>                <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO-454"><a href="#PDBIO-454"><span class="linenos"> 454</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_atom_dict</span><span class="p">)</span>
</span><span id="PDBIO-455"><a href="#PDBIO-455"><span class="linenos"> 455</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="PDBIO-456"><a href="#PDBIO-456"><span class="linenos"> 456</span></a>                <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO-457"><a href="#PDBIO-457"><span class="linenos"> 457</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_atom_dict</span><span class="p">)</span>
</span><span id="PDBIO-458"><a href="#PDBIO-458"><span class="linenos"> 458</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="PDBIO-459"><a href="#PDBIO-459"><span class="linenos"> 459</span></a>                <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_ter_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO-460"><a href="#PDBIO-460"><span class="linenos"> 460</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_ter_dict</span><span class="p">)</span>
</span><span id="PDBIO-461"><a href="#PDBIO-461"><span class="linenos"> 461</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">:</span>
</span><span id="PDBIO-462"><a href="#PDBIO-462"><span class="linenos"> 462</span></a>                <span class="n">pdb_model_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO-463"><a href="#PDBIO-463"><span class="linenos"> 463</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_model_dict</span><span class="p">)</span>
</span><span id="PDBIO-464"><a href="#PDBIO-464"><span class="linenos"> 464</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="p">:</span>
</span><span id="PDBIO-465"><a href="#PDBIO-465"><span class="linenos"> 465</span></a>                <span class="n">pdb_end_model_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_end_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO-466"><a href="#PDBIO-466"><span class="linenos"> 466</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_end_model_dict</span><span class="p">)</span>
</span><span id="PDBIO-467"><a href="#PDBIO-467"><span class="linenos"> 467</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">:</span>
</span><span id="PDBIO-468"><a href="#PDBIO-468"><span class="linenos"> 468</span></a>                <span class="n">pdb_seqres_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_seqres_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO-469"><a href="#PDBIO-469"><span class="linenos"> 469</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_seqres_dict</span><span class="p">)</span>
</span><span id="PDBIO-470"><a href="#PDBIO-470"><span class="linenos"> 470</span></a>        <span class="k">return</span> <span class="n">entries</span>
</span><span id="PDBIO-471"><a href="#PDBIO-471"><span class="linenos"> 471</span></a>
</span><span id="PDBIO-472"><a href="#PDBIO-472"><span class="linenos"> 472</span></a>
</span><span id="PDBIO-473"><a href="#PDBIO-473"><span class="linenos"> 473</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-474"><a href="#PDBIO-474"><span class="linenos"> 474</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_entries</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="PDBIO-475"><a href="#PDBIO-475"><span class="linenos"> 475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-476"><a href="#PDBIO-476"><span class="linenos"> 476</span></a><span class="sd">        Parse PDB file according to the spec provided at:</span>
</span><span id="PDBIO-477"><a href="#PDBIO-477"><span class="linenos"> 477</span></a><span class="sd">        https://www.wwpdb.org/documentation/file-format-content/format33/sect9.html#ATOM</span>
</span><span id="PDBIO-478"><a href="#PDBIO-478"><span class="linenos"> 478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-479"><a href="#PDBIO-479"><span class="linenos"> 479</span></a>        <span class="c1"># Open the file and extract the individual lines.</span>
</span><span id="PDBIO-480"><a href="#PDBIO-480"><span class="linenos"> 480</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="PDBIO-481"><a href="#PDBIO-481"><span class="linenos"> 481</span></a>            <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="PDBIO-482"><a href="#PDBIO-482"><span class="linenos"> 482</span></a>
</span><span id="PDBIO-483"><a href="#PDBIO-483"><span class="linenos"> 483</span></a>        <span class="k">return</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO-484"><a href="#PDBIO-484"><span class="linenos"> 484</span></a>
</span><span id="PDBIO-485"><a href="#PDBIO-485"><span class="linenos"> 485</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-486"><a href="#PDBIO-486"><span class="linenos"> 486</span></a>    <span class="k">def</span> <span class="nf">load_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PDBIO-487"><a href="#PDBIO-487"><span class="linenos"> 487</span></a>                         <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PDBIO-488"><a href="#PDBIO-488"><span class="linenos"> 488</span></a>                         <span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
</span><span id="PDBIO-489"><a href="#PDBIO-489"><span class="linenos"> 489</span></a>        <span class="n">protein</span> <span class="o">=</span> <span class="n">Protein</span><span class="p">(</span><span class="n">pdb_id</span><span class="o">=</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="PDBIO-490"><a href="#PDBIO-490"><span class="linenos"> 490</span></a>        <span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO-491"><a href="#PDBIO-491"><span class="linenos"> 491</span></a>        <span class="n">seqres</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PDBIO-492"><a href="#PDBIO-492"><span class="linenos"> 492</span></a>        <span class="n">current_model</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-493"><a href="#PDBIO-493"><span class="linenos"> 493</span></a>        <span class="n">current_chain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chain</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-494"><a href="#PDBIO-494"><span class="linenos"> 494</span></a>        <span class="n">current_chain_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-495"><a href="#PDBIO-495"><span class="linenos"> 495</span></a>        <span class="n">current_residue</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-496"><a href="#PDBIO-496"><span class="linenos"> 496</span></a>        <span class="n">current_residue_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-497"><a href="#PDBIO-497"><span class="linenos"> 497</span></a>
</span><span id="PDBIO-498"><a href="#PDBIO-498"><span class="linenos"> 498</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO-499"><a href="#PDBIO-499"><span class="linenos"> 499</span></a>
</span><span id="PDBIO-500"><a href="#PDBIO-500"><span class="linenos"> 500</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
</span><span id="PDBIO-501"><a href="#PDBIO-501"><span class="linenos"> 501</span></a>            <span class="n">record_name</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;record_name&quot;</span><span class="p">]</span>
</span><span id="PDBIO-502"><a href="#PDBIO-502"><span class="linenos"> 502</span></a>            <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">:</span>
</span><span id="PDBIO-503"><a href="#PDBIO-503"><span class="linenos"> 503</span></a>                <span class="n">chain_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO-504"><a href="#PDBIO-504"><span class="linenos"> 504</span></a>                <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="PDBIO-505"><a href="#PDBIO-505"><span class="linenos"> 505</span></a>                    <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO-506"><a href="#PDBIO-506"><span class="linenos"> 506</span></a>                <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;residues&quot;</span><span class="p">])</span>
</span><span id="PDBIO-507"><a href="#PDBIO-507"><span class="linenos"> 507</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">:</span>
</span><span id="PDBIO-508"><a href="#PDBIO-508"><span class="linenos"> 508</span></a>                <span class="c1"># Usually, the MODEL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO-509"><a href="#PDBIO-509"><span class="linenos"> 509</span></a>                <span class="c1"># We only use the first model in a file if provided.</span>
</span><span id="PDBIO-510"><a href="#PDBIO-510"><span class="linenos"> 510</span></a>                <span class="c1"># There is nothing to do, so we</span>
</span><span id="PDBIO-511"><a href="#PDBIO-511"><span class="linenos"> 511</span></a>                <span class="k">pass</span>
</span><span id="PDBIO-512"><a href="#PDBIO-512"><span class="linenos"> 512</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="p">:</span>
</span><span id="PDBIO-513"><a href="#PDBIO-513"><span class="linenos"> 513</span></a>                <span class="c1"># Usually, the ENDMDL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO-514"><a href="#PDBIO-514"><span class="linenos"> 514</span></a>                <span class="c1"># it closes a corresponding MODEL field.</span>
</span><span id="PDBIO-515"><a href="#PDBIO-515"><span class="linenos"> 515</span></a>                <span class="c1"># Since the end of the model is reached, no more entries should be parsed.</span>
</span><span id="PDBIO-516"><a href="#PDBIO-516"><span class="linenos"> 516</span></a>                <span class="k">break</span>
</span><span id="PDBIO-517"><a href="#PDBIO-517"><span class="linenos"> 517</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="PDBIO-518"><a href="#PDBIO-518"><span class="linenos"> 518</span></a>                <span class="c1"># The TER field terminates the current chain.</span>
</span><span id="PDBIO-519"><a href="#PDBIO-519"><span class="linenos"> 519</span></a>                <span class="n">current_chain</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-520"><a href="#PDBIO-520"><span class="linenos"> 520</span></a>                <span class="n">current_chain_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-521"><a href="#PDBIO-521"><span class="linenos"> 521</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span> <span class="ow">or</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="PDBIO-522"><a href="#PDBIO-522"><span class="linenos"> 522</span></a>                <span class="c1"># If we switched chains, set the chain.</span>
</span><span id="PDBIO-523"><a href="#PDBIO-523"><span class="linenos"> 523</span></a>                <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">current_chain_id</span><span class="p">:</span>
</span><span id="PDBIO-524"><a href="#PDBIO-524"><span class="linenos"> 524</span></a>                    <span class="n">current_chain_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO-525"><a href="#PDBIO-525"><span class="linenos"> 525</span></a>                    <span class="k">if</span> <span class="n">protein</span><span class="o">.</span><span class="n">has_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">):</span>
</span><span id="PDBIO-526"><a href="#PDBIO-526"><span class="linenos"> 526</span></a>                        <span class="n">current_chain</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">)</span>
</span><span id="PDBIO-527"><a href="#PDBIO-527"><span class="linenos"> 527</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO-528"><a href="#PDBIO-528"><span class="linenos"> 528</span></a>                        <span class="n">current_chain</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">create_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">)</span>
</span><span id="PDBIO-529"><a href="#PDBIO-529"><span class="linenos"> 529</span></a>
</span><span id="PDBIO-530"><a href="#PDBIO-530"><span class="linenos"> 530</span></a>                <span class="c1"># Check if the residue exists</span>
</span><span id="PDBIO-531"><a href="#PDBIO-531"><span class="linenos"> 531</span></a>                <span class="n">residue_id</span> <span class="o">=</span> <span class="n">current_chain_id</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span>
</span><span id="PDBIO-532"><a href="#PDBIO-532"><span class="linenos"> 532</span></a>                <span class="k">if</span> <span class="n">residue_id</span> <span class="o">!=</span> <span class="n">current_residue_id</span><span class="p">:</span>
</span><span id="PDBIO-533"><a href="#PDBIO-533"><span class="linenos"> 533</span></a>                    <span class="n">current_residue_id</span> <span class="o">=</span> <span class="n">residue_id</span>
</span><span id="PDBIO-534"><a href="#PDBIO-534"><span class="linenos"> 534</span></a>                    <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span><span class="p">:</span>
</span><span id="PDBIO-535"><a href="#PDBIO-535"><span class="linenos"> 535</span></a>                        <span class="c1"># if entry[&quot;res_name&quot;] in ResidueTemplate.VALID_DNA_RESIDUES:</span>
</span><span id="PDBIO-536"><a href="#PDBIO-536"><span class="linenos"> 536</span></a>                        <span class="c1">#     current_residue = current_chain.add_dna_residue(</span>
</span><span id="PDBIO-537"><a href="#PDBIO-537"><span class="linenos"> 537</span></a>                        <span class="c1">#         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-538"><a href="#PDBIO-538"><span class="linenos"> 538</span></a>                        <span class="c1">#         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-539"><a href="#PDBIO-539"><span class="linenos"> 539</span></a>                        <span class="c1">#         insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-540"><a href="#PDBIO-540"><span class="linenos"> 540</span></a>                        <span class="c1">#     )</span>
</span><span id="PDBIO-541"><a href="#PDBIO-541"><span class="linenos"> 541</span></a>                        <span class="c1"># else:</span>
</span><span id="PDBIO-542"><a href="#PDBIO-542"><span class="linenos"> 542</span></a>                        <span class="n">current_residue</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">(</span>
</span><span id="PDBIO-543"><a href="#PDBIO-543"><span class="linenos"> 543</span></a>                            <span class="n">residue_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO-544"><a href="#PDBIO-544"><span class="linenos"> 544</span></a>                            <span class="n">sequence_no</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]),</span>
</span><span id="PDBIO-545"><a href="#PDBIO-545"><span class="linenos"> 545</span></a>                            <span class="n">insertion_code</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">],</span>
</span><span id="PDBIO-546"><a href="#PDBIO-546"><span class="linenos"> 546</span></a>                            <span class="n">chain</span><span class="o">=</span><span class="n">current_chain</span><span class="p">)</span>
</span><span id="PDBIO-547"><a href="#PDBIO-547"><span class="linenos"> 547</span></a>                        <span class="n">current_chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">current_residue</span><span class="p">)</span>
</span><span id="PDBIO-548"><a href="#PDBIO-548"><span class="linenos"> 548</span></a>                    <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="PDBIO-549"><a href="#PDBIO-549"><span class="linenos"> 549</span></a>                        <span class="n">current_residue</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">(</span>
</span><span id="PDBIO-550"><a href="#PDBIO-550"><span class="linenos"> 550</span></a>                            <span class="n">residue_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO-551"><a href="#PDBIO-551"><span class="linenos"> 551</span></a>                            <span class="n">sequence_no</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]),</span>
</span><span id="PDBIO-552"><a href="#PDBIO-552"><span class="linenos"> 552</span></a>                            <span class="n">insertion_code</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">],</span>
</span><span id="PDBIO-553"><a href="#PDBIO-553"><span class="linenos"> 553</span></a>                            <span class="n">chain</span><span class="o">=</span><span class="n">current_chain</span><span class="p">)</span>
</span><span id="PDBIO-554"><a href="#PDBIO-554"><span class="linenos"> 554</span></a>                        <span class="n">current_chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">current_residue</span><span class="p">)</span>
</span><span id="PDBIO-555"><a href="#PDBIO-555"><span class="linenos"> 555</span></a>
</span><span id="PDBIO-556"><a href="#PDBIO-556"><span class="linenos"> 556</span></a>                        <span class="c1"># current_residue = current_chain.add_het_residue(</span>
</span><span id="PDBIO-557"><a href="#PDBIO-557"><span class="linenos"> 557</span></a>                        <span class="c1">#     residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-558"><a href="#PDBIO-558"><span class="linenos"> 558</span></a>                        <span class="c1">#     sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-559"><a href="#PDBIO-559"><span class="linenos"> 559</span></a>                        <span class="c1">#     insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-560"><a href="#PDBIO-560"><span class="linenos"> 560</span></a>                        <span class="c1"># )</span>
</span><span id="PDBIO-561"><a href="#PDBIO-561"><span class="linenos"> 561</span></a>
</span><span id="PDBIO-562"><a href="#PDBIO-562"><span class="linenos"> 562</span></a>                <span class="c1"># Temporary fix need to see if anything breaks (For Evo eg. 2HH1 -&gt; HH12)</span>
</span><span id="PDBIO-563"><a href="#PDBIO-563"><span class="linenos"> 563</span></a>                <span class="c1"># Fix atom naming</span>
</span><span id="PDBIO-564"><a href="#PDBIO-564"><span class="linenos"> 564</span></a>                <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
</span><span id="PDBIO-565"><a href="#PDBIO-565"><span class="linenos"> 565</span></a>                    <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PDBIO-566"><a href="#PDBIO-566"><span class="linenos"> 566</span></a>                    <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
</span><span id="PDBIO-567"><a href="#PDBIO-567"><span class="linenos"> 567</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PDBIO-568"><a href="#PDBIO-568"><span class="linenos"> 568</span></a>                    <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
</span><span id="PDBIO-569"><a href="#PDBIO-569"><span class="linenos"> 569</span></a>                        <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>
</span><span id="PDBIO-570"><a href="#PDBIO-570"><span class="linenos"> 570</span></a>
</span><span id="PDBIO-571"><a href="#PDBIO-571"><span class="linenos"> 571</span></a>                <span class="c1"># Add the atom to the residue</span>
</span><span id="PDBIO-572"><a href="#PDBIO-572"><span class="linenos"> 572</span></a>                <span class="c1"># if entry[&quot;alt_loc&quot;] == &quot;&quot;:</span>
</span><span id="PDBIO-573"><a href="#PDBIO-573"><span class="linenos"> 573</span></a>                <span class="c1">#     atom_id = entry[&quot;atom_name&quot;]</span>
</span><span id="PDBIO-574"><a href="#PDBIO-574"><span class="linenos"> 574</span></a>                <span class="c1"># else:</span>
</span><span id="PDBIO-575"><a href="#PDBIO-575"><span class="linenos"> 575</span></a>                <span class="c1">#     atom_id = entry[&quot;atom_name&quot;] + &quot;_&quot; + entry[&quot;alt_loc&quot;]</span>
</span><span id="PDBIO-576"><a href="#PDBIO-576"><span class="linenos"> 576</span></a>                <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span>
</span><span id="PDBIO-577"><a href="#PDBIO-577"><span class="linenos"> 577</span></a>                    <span class="n">element</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">],</span>
</span><span id="PDBIO-578"><a href="#PDBIO-578"><span class="linenos"> 578</span></a>                    <span class="n">atom_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO-579"><a href="#PDBIO-579"><span class="linenos"> 579</span></a>                    <span class="n">x</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
</span><span id="PDBIO-580"><a href="#PDBIO-580"><span class="linenos"> 580</span></a>                    <span class="n">y</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
</span><span id="PDBIO-581"><a href="#PDBIO-581"><span class="linenos"> 581</span></a>                    <span class="n">z</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span>
</span><span id="PDBIO-582"><a href="#PDBIO-582"><span class="linenos"> 582</span></a>
</span><span id="PDBIO-583"><a href="#PDBIO-583"><span class="linenos"> 583</span></a>                    <span class="c1"># Serial is dependent on the atom ordering,</span>
</span><span id="PDBIO-584"><a href="#PDBIO-584"><span class="linenos"> 584</span></a>                    <span class="c1"># so it is not used in the Atom class</span>
</span><span id="PDBIO-585"><a href="#PDBIO-585"><span class="linenos"> 585</span></a>                    <span class="c1"># pdb_serial=entry[&quot;serial&quot;],</span>
</span><span id="PDBIO-586"><a href="#PDBIO-586"><span class="linenos"> 586</span></a>                    <span class="n">alt_loc</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">],</span>
</span><span id="PDBIO-587"><a href="#PDBIO-587"><span class="linenos"> 587</span></a>                    <span class="n">occupancy</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">],</span>
</span><span id="PDBIO-588"><a href="#PDBIO-588"><span class="linenos"> 588</span></a>                    <span class="n">temp_factor</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">],</span>
</span><span id="PDBIO-589"><a href="#PDBIO-589"><span class="linenos"> 589</span></a>                    <span class="n">assigned_charge</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">],</span>
</span><span id="PDBIO-590"><a href="#PDBIO-590"><span class="linenos"> 590</span></a>                    <span class="n">calculated_charge</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">],</span>
</span><span id="PDBIO-591"><a href="#PDBIO-591"><span class="linenos"> 591</span></a>                    <span class="n">radius</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">],</span>
</span><span id="PDBIO-592"><a href="#PDBIO-592"><span class="linenos"> 592</span></a>                    <span class="n">is_hetero</span><span class="o">=</span><span class="p">(</span><span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">),</span>
</span><span id="PDBIO-593"><a href="#PDBIO-593"><span class="linenos"> 593</span></a>
</span><span id="PDBIO-594"><a href="#PDBIO-594"><span class="linenos"> 594</span></a>                    <span class="n">residue</span><span class="o">=</span><span class="n">current_residue</span>
</span><span id="PDBIO-595"><a href="#PDBIO-595"><span class="linenos"> 595</span></a>                <span class="p">)</span>
</span><span id="PDBIO-596"><a href="#PDBIO-596"><span class="linenos"> 596</span></a>
</span><span id="PDBIO-597"><a href="#PDBIO-597"><span class="linenos"> 597</span></a>                <span class="c1"># current_residue.add_atom(atom_id, atom)</span>
</span><span id="PDBIO-598"><a href="#PDBIO-598"><span class="linenos"> 598</span></a>                <span class="n">current_residue</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span> <span class="n">atom</span><span class="p">)</span>
</span><span id="PDBIO-599"><a href="#PDBIO-599"><span class="linenos"> 599</span></a>
</span><span id="PDBIO-600"><a href="#PDBIO-600"><span class="linenos"> 600</span></a>        <span class="k">if</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="PDBIO-601"><a href="#PDBIO-601"><span class="linenos"> 601</span></a>            <span class="k">for</span> <span class="n">chain_id</span> <span class="ow">in</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="PDBIO-602"><a href="#PDBIO-602"><span class="linenos"> 602</span></a>                <span class="k">if</span> <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]:</span>
</span><span id="PDBIO-603"><a href="#PDBIO-603"><span class="linenos"> 603</span></a>                    <span class="n">protein</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">chain_id</span><span class="p">)</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;seqres&quot;</span><span class="p">,</span> <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">])</span>
</span><span id="PDBIO-604"><a href="#PDBIO-604"><span class="linenos"> 604</span></a>
</span><span id="PDBIO-605"><a href="#PDBIO-605"><span class="linenos"> 605</span></a>        <span class="c1"># Housekeeping</span>
</span><span id="PDBIO-606"><a href="#PDBIO-606"><span class="linenos"> 606</span></a>        <span class="c1"># protein.set_residue_indexing()</span>
</span><span id="PDBIO-607"><a href="#PDBIO-607"><span class="linenos"> 607</span></a>
</span><span id="PDBIO-608"><a href="#PDBIO-608"><span class="linenos"> 608</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">protein</span><span class="p">]</span>
</span><span id="PDBIO-609"><a href="#PDBIO-609"><span class="linenos"> 609</span></a>
</span><span id="PDBIO-610"><a href="#PDBIO-610"><span class="linenos"> 610</span></a>
</span><span id="PDBIO-611"><a href="#PDBIO-611"><span class="linenos"> 611</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-612"><a href="#PDBIO-612"><span class="linenos"> 612</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PDBIO-613"><a href="#PDBIO-613"><span class="linenos"> 613</span></a>             <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PDBIO-614"><a href="#PDBIO-614"><span class="linenos"> 614</span></a>             <span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
</span><span id="PDBIO-615"><a href="#PDBIO-615"><span class="linenos"> 615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO-616"><a href="#PDBIO-616"><span class="linenos"> 616</span></a><span class="sd">        Load a protein from a PDB file.</span>
</span><span id="PDBIO-617"><a href="#PDBIO-617"><span class="linenos"> 617</span></a>
</span><span id="PDBIO-618"><a href="#PDBIO-618"><span class="linenos"> 618</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO-619"><a href="#PDBIO-619"><span class="linenos"> 619</span></a><span class="sd">            file_path (str): The path to the PDB file.</span>
</span><span id="PDBIO-620"><a href="#PDBIO-620"><span class="linenos"> 620</span></a><span class="sd">            is_pqr_format (bool): If the file is in PQR format.</span>
</span><span id="PDBIO-621"><a href="#PDBIO-621"><span class="linenos"> 621</span></a><span class="sd">            pdb_id (str): The PDB ID of the protein.</span>
</span><span id="PDBIO-622"><a href="#PDBIO-622"><span class="linenos"> 622</span></a>
</span><span id="PDBIO-623"><a href="#PDBIO-623"><span class="linenos"> 623</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO-624"><a href="#PDBIO-624"><span class="linenos"> 624</span></a><span class="sd">            List[Protein]: A list of proteins.</span>
</span><span id="PDBIO-625"><a href="#PDBIO-625"><span class="linenos"> 625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO-626"><a href="#PDBIO-626"><span class="linenos"> 626</span></a>
</span><span id="PDBIO-627"><a href="#PDBIO-627"><span class="linenos"> 627</span></a>        <span class="c1"># Open the file and extract the individual lines.</span>
</span><span id="PDBIO-628"><a href="#PDBIO-628"><span class="linenos"> 628</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="PDBIO-629"><a href="#PDBIO-629"><span class="linenos"> 629</span></a>            <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="PDBIO-630"><a href="#PDBIO-630"><span class="linenos"> 630</span></a>
</span><span id="PDBIO-631"><a href="#PDBIO-631"><span class="linenos"> 631</span></a>        <span class="k">return</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">load_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">,</span> <span class="n">pdb_id</span><span class="o">=</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="PDBIO-632"><a href="#PDBIO-632"><span class="linenos"> 632</span></a>
</span><span id="PDBIO-633"><a href="#PDBIO-633"><span class="linenos"> 633</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-634"><a href="#PDBIO-634"><span class="linenos"> 634</span></a>    <span class="k">def</span> <span class="nf">save_to_string</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span>
</span><span id="PDBIO-635"><a href="#PDBIO-635"><span class="linenos"> 635</span></a>                       <span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PDBIO-636"><a href="#PDBIO-636"><span class="linenos"> 636</span></a>        <span class="n">text_entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO-637"><a href="#PDBIO-637"><span class="linenos"> 637</span></a>        <span class="n">num_seqres</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO-638"><a href="#PDBIO-638"><span class="linenos"> 638</span></a>        <span class="n">num_atoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO-639"><a href="#PDBIO-639"><span class="linenos"> 639</span></a>        <span class="n">num_hetatoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO-640"><a href="#PDBIO-640"><span class="linenos"> 640</span></a>        <span class="n">num_ter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO-641"><a href="#PDBIO-641"><span class="linenos"> 641</span></a>        <span class="n">serial</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="PDBIO-642"><a href="#PDBIO-642"><span class="linenos"> 642</span></a>        <span class="n">atom_entry</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO-643"><a href="#PDBIO-643"><span class="linenos"> 643</span></a>
</span><span id="PDBIO-644"><a href="#PDBIO-644"><span class="linenos"> 644</span></a>        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">chains</span><span class="p">:</span>
</span><span id="PDBIO-645"><a href="#PDBIO-645"><span class="linenos"> 645</span></a>            <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
</span><span id="PDBIO-646"><a href="#PDBIO-646"><span class="linenos"> 646</span></a>                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="PDBIO-647"><a href="#PDBIO-647"><span class="linenos"> 647</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">atom</span><span class="o">.</span><span class="n">is_hetero</span><span class="p">:</span>
</span><span id="PDBIO-648"><a href="#PDBIO-648"><span class="linenos"> 648</span></a>                        <span class="n">atom_entry</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-649"><a href="#PDBIO-649"><span class="linenos"> 649</span></a>                            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
</span><span id="PDBIO-650"><a href="#PDBIO-650"><span class="linenos"> 650</span></a>                            <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span>
</span><span id="PDBIO-651"><a href="#PDBIO-651"><span class="linenos"> 651</span></a>                            <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;pdb_alt_loc&quot;</span><span class="p">),</span>
</span><span id="PDBIO-652"><a href="#PDBIO-652"><span class="linenos"> 652</span></a>                            <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_type</span><span class="p">,</span>
</span><span id="PDBIO-653"><a href="#PDBIO-653"><span class="linenos"> 653</span></a>                            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">chain</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span>
</span><span id="PDBIO-654"><a href="#PDBIO-654"><span class="linenos"> 654</span></a>                            <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">sequence_no</span><span class="p">),</span>
</span><span id="PDBIO-655"><a href="#PDBIO-655"><span class="linenos"> 655</span></a>                            <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">insertion_code</span><span class="p">,</span>
</span><span id="PDBIO-656"><a href="#PDBIO-656"><span class="linenos"> 656</span></a>                            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="PDBIO-657"><a href="#PDBIO-657"><span class="linenos"> 657</span></a>                            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="PDBIO-658"><a href="#PDBIO-658"><span class="linenos"> 658</span></a>                            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
</span><span id="PDBIO-659"><a href="#PDBIO-659"><span class="linenos"> 659</span></a>                            <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;occupancy&quot;</span><span class="p">),</span>
</span><span id="PDBIO-660"><a href="#PDBIO-660"><span class="linenos"> 660</span></a>                            <span class="c1"># &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="PDBIO-661"><a href="#PDBIO-661"><span class="linenos"> 661</span></a>                            <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">),</span>
</span><span id="PDBIO-662"><a href="#PDBIO-662"><span class="linenos"> 662</span></a>                            <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO-663"><a href="#PDBIO-663"><span class="linenos"> 663</span></a>                            <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO-664"><a href="#PDBIO-664"><span class="linenos"> 664</span></a>                            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;radius&quot;</span><span class="p">)</span>
</span><span id="PDBIO-665"><a href="#PDBIO-665"><span class="linenos"> 665</span></a>                        <span class="p">}</span>
</span><span id="PDBIO-666"><a href="#PDBIO-666"><span class="linenos"> 666</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="PDBIO-667"><a href="#PDBIO-667"><span class="linenos"> 667</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">))</span>
</span><span id="PDBIO-668"><a href="#PDBIO-668"><span class="linenos"> 668</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO-669"><a href="#PDBIO-669"><span class="linenos"> 669</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">))</span>
</span><span id="PDBIO-670"><a href="#PDBIO-670"><span class="linenos"> 670</span></a>
</span><span id="PDBIO-671"><a href="#PDBIO-671"><span class="linenos"> 671</span></a>                        <span class="n">serial</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO-672"><a href="#PDBIO-672"><span class="linenos"> 672</span></a>                        <span class="n">num_atoms</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO-673"><a href="#PDBIO-673"><span class="linenos"> 673</span></a>
</span><span id="PDBIO-674"><a href="#PDBIO-674"><span class="linenos"> 674</span></a>            <span class="c1"># TER entry</span>
</span><span id="PDBIO-675"><a href="#PDBIO-675"><span class="linenos"> 675</span></a>            <span class="k">if</span> <span class="n">atom_entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PDBIO-676"><a href="#PDBIO-676"><span class="linenos"> 676</span></a>                <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_ter_line</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span>
</span><span id="PDBIO-677"><a href="#PDBIO-677"><span class="linenos"> 677</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO-678"><a href="#PDBIO-678"><span class="linenos"> 678</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">],</span>
</span><span id="PDBIO-679"><a href="#PDBIO-679"><span class="linenos"> 679</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">],</span>
</span><span id="PDBIO-680"><a href="#PDBIO-680"><span class="linenos"> 680</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]))</span>
</span><span id="PDBIO-681"><a href="#PDBIO-681"><span class="linenos"> 681</span></a>                <span class="n">serial</span> <span class="o">=</span> <span class="n">serial</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PDBIO-682"><a href="#PDBIO-682"><span class="linenos"> 682</span></a>                <span class="n">num_ter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO-683"><a href="#PDBIO-683"><span class="linenos"> 683</span></a>
</span><span id="PDBIO-684"><a href="#PDBIO-684"><span class="linenos"> 684</span></a>        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">chains</span><span class="p">:</span>
</span><span id="PDBIO-685"><a href="#PDBIO-685"><span class="linenos"> 685</span></a>            <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
</span><span id="PDBIO-686"><a href="#PDBIO-686"><span class="linenos"> 686</span></a>                <span class="c1"># HETATM entries</span>
</span><span id="PDBIO-687"><a href="#PDBIO-687"><span class="linenos"> 687</span></a>                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="PDBIO-688"><a href="#PDBIO-688"><span class="linenos"> 688</span></a>                    <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">is_hetero</span><span class="p">:</span>
</span><span id="PDBIO-689"><a href="#PDBIO-689"><span class="linenos"> 689</span></a>                        <span class="n">atom_entry</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO-690"><a href="#PDBIO-690"><span class="linenos"> 690</span></a>                            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
</span><span id="PDBIO-691"><a href="#PDBIO-691"><span class="linenos"> 691</span></a>                            <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span>
</span><span id="PDBIO-692"><a href="#PDBIO-692"><span class="linenos"> 692</span></a>                            <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;pdb_alt_loc&quot;</span><span class="p">),</span>
</span><span id="PDBIO-693"><a href="#PDBIO-693"><span class="linenos"> 693</span></a>                            <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_type</span><span class="p">,</span>
</span><span id="PDBIO-694"><a href="#PDBIO-694"><span class="linenos"> 694</span></a>                            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">chain</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span>
</span><span id="PDBIO-695"><a href="#PDBIO-695"><span class="linenos"> 695</span></a>                            <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">sequence_no</span><span class="p">),</span>
</span><span id="PDBIO-696"><a href="#PDBIO-696"><span class="linenos"> 696</span></a>                            <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">insertion_code</span><span class="p">,</span>
</span><span id="PDBIO-697"><a href="#PDBIO-697"><span class="linenos"> 697</span></a>                            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="PDBIO-698"><a href="#PDBIO-698"><span class="linenos"> 698</span></a>                            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="PDBIO-699"><a href="#PDBIO-699"><span class="linenos"> 699</span></a>                            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
</span><span id="PDBIO-700"><a href="#PDBIO-700"><span class="linenos"> 700</span></a>                            <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;occupancy&quot;</span><span class="p">),</span>
</span><span id="PDBIO-701"><a href="#PDBIO-701"><span class="linenos"> 701</span></a>                            <span class="c1"># &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="PDBIO-702"><a href="#PDBIO-702"><span class="linenos"> 702</span></a>                            <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">),</span>
</span><span id="PDBIO-703"><a href="#PDBIO-703"><span class="linenos"> 703</span></a>                            <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO-704"><a href="#PDBIO-704"><span class="linenos"> 704</span></a>                            <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO-705"><a href="#PDBIO-705"><span class="linenos"> 705</span></a>                            <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO-706"><a href="#PDBIO-706"><span class="linenos"> 706</span></a>                            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;radius&quot;</span><span class="p">)</span>
</span><span id="PDBIO-707"><a href="#PDBIO-707"><span class="linenos"> 707</span></a>                        <span class="p">}</span>
</span><span id="PDBIO-708"><a href="#PDBIO-708"><span class="linenos"> 708</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="PDBIO-709"><a href="#PDBIO-709"><span class="linenos"> 709</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;HETATM&quot;</span><span class="p">))</span>
</span><span id="PDBIO-710"><a href="#PDBIO-710"><span class="linenos"> 710</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO-711"><a href="#PDBIO-711"><span class="linenos"> 711</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;HETATM&quot;</span><span class="p">))</span>
</span><span id="PDBIO-712"><a href="#PDBIO-712"><span class="linenos"> 712</span></a>
</span><span id="PDBIO-713"><a href="#PDBIO-713"><span class="linenos"> 713</span></a>                        <span class="n">serial</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO-714"><a href="#PDBIO-714"><span class="linenos"> 714</span></a>                        <span class="n">num_hetatoms</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO-715"><a href="#PDBIO-715"><span class="linenos"> 715</span></a>            <span class="c1"># Hetero residues have no TER records, so no need to write a termination code.</span>
</span><span id="PDBIO-716"><a href="#PDBIO-716"><span class="linenos"> 716</span></a>
</span><span id="PDBIO-717"><a href="#PDBIO-717"><span class="linenos"> 717</span></a>        <span class="c1"># Bookkeeping records</span>
</span><span id="PDBIO-718"><a href="#PDBIO-718"><span class="linenos"> 718</span></a>        <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_master_line</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_hetatoms</span><span class="p">,</span> <span class="n">num_ter</span><span class="p">,</span> <span class="n">num_seqres</span><span class="o">=</span><span class="n">num_seqres</span><span class="p">))</span>
</span><span id="PDBIO-719"><a href="#PDBIO-719"><span class="linenos"> 719</span></a>        <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;END&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span>
</span><span id="PDBIO-720"><a href="#PDBIO-720"><span class="linenos"> 720</span></a>
</span><span id="PDBIO-721"><a href="#PDBIO-721"><span class="linenos"> 721</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_entries</span><span class="p">)</span>
</span><span id="PDBIO-722"><a href="#PDBIO-722"><span class="linenos"> 722</span></a>
</span><span id="PDBIO-723"><a href="#PDBIO-723"><span class="linenos"> 723</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO-724"><a href="#PDBIO-724"><span class="linenos"> 724</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span>
</span><span id="PDBIO-725"><a href="#PDBIO-725"><span class="linenos"> 725</span></a>             <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PDBIO-726"><a href="#PDBIO-726"><span class="linenos"> 726</span></a>             <span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PDBIO-727"><a href="#PDBIO-727"><span class="linenos"> 727</span></a>
</span><span id="PDBIO-728"><a href="#PDBIO-728"><span class="linenos"> 728</span></a>        <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">save_to_string</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO-729"><a href="#PDBIO-729"><span class="linenos"> 729</span></a>
</span><span id="PDBIO-730"><a href="#PDBIO-730"><span class="linenos"> 730</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="PDBIO-731"><a href="#PDBIO-731"><span class="linenos"> 731</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">)</span>
</span><span id="PDBIO-732"><a href="#PDBIO-732"><span class="linenos"> 732</span></a>
</span><span id="PDBIO-733"><a href="#PDBIO-733"><span class="linenos"> 733</span></a>    <span class="c1"># TODO: from_pdb_text and to_pdb_text was added by Claudio</span>
</span><span id="PDBIO-734"><a href="#PDBIO-734"><span class="linenos"> 734</span></a>    <span class="c1"># The intent is that one should parse proteins from text</span>
</span><span id="PDBIO-735"><a href="#PDBIO-735"><span class="linenos"> 735</span></a>    <span class="c1"># without working with files. However, a lot of code copying</span>
</span><span id="PDBIO-736"><a href="#PDBIO-736"><span class="linenos"> 736</span></a>    <span class="c1"># was made and it need to be reworked significantly.</span>
</span><span id="PDBIO-737"><a href="#PDBIO-737"><span class="linenos"> 737</span></a>
</span><span id="PDBIO-738"><a href="#PDBIO-738"><span class="linenos"> 738</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="PDBIO-739"><a href="#PDBIO-739"><span class="linenos"> 739</span></a>    <span class="c1"># def from_pdb_text(lines) -&gt; List[Protein]:</span>
</span><span id="PDBIO-740"><a href="#PDBIO-740"><span class="linenos"> 740</span></a>    <span class="c1">#     lines = lines.split(&quot;\n&quot;)</span>
</span><span id="PDBIO-741"><a href="#PDBIO-741"><span class="linenos"> 741</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-742"><a href="#PDBIO-742"><span class="linenos"> 742</span></a>    <span class="c1">#     entries = []</span>
</span><span id="PDBIO-743"><a href="#PDBIO-743"><span class="linenos"> 743</span></a>    <span class="c1">#     for line in lines:</span>
</span><span id="PDBIO-744"><a href="#PDBIO-744"><span class="linenos"> 744</span></a>    <span class="c1">#         record_name = line[0:6].strip().upper()</span>
</span><span id="PDBIO-745"><a href="#PDBIO-745"><span class="linenos"> 745</span></a>    <span class="c1">#         if record_name == &quot;ATOM&quot;:</span>
</span><span id="PDBIO-746"><a href="#PDBIO-746"><span class="linenos"> 746</span></a>    <span class="c1">#             pdb_atom_dict = PDBIO.parse_pdb_atom_line(line)</span>
</span><span id="PDBIO-747"><a href="#PDBIO-747"><span class="linenos"> 747</span></a>    <span class="c1">#             entries.append(pdb_atom_dict)</span>
</span><span id="PDBIO-748"><a href="#PDBIO-748"><span class="linenos"> 748</span></a>    <span class="c1">#         elif record_name == &quot;HETATM&quot;:</span>
</span><span id="PDBIO-749"><a href="#PDBIO-749"><span class="linenos"> 749</span></a>    <span class="c1">#             pdb_atom_dict = PDBIO.parse_pdb_atom_line(line)</span>
</span><span id="PDBIO-750"><a href="#PDBIO-750"><span class="linenos"> 750</span></a>    <span class="c1">#             entries.append(pdb_atom_dict)</span>
</span><span id="PDBIO-751"><a href="#PDBIO-751"><span class="linenos"> 751</span></a>    <span class="c1">#         elif record_name == &quot;TER&quot;:</span>
</span><span id="PDBIO-752"><a href="#PDBIO-752"><span class="linenos"> 752</span></a>    <span class="c1">#             pdb_ter_dict = PDBIO.parse_pdb_ter_line(line)</span>
</span><span id="PDBIO-753"><a href="#PDBIO-753"><span class="linenos"> 753</span></a>    <span class="c1">#             entries.append(pdb_ter_dict)</span>
</span><span id="PDBIO-754"><a href="#PDBIO-754"><span class="linenos"> 754</span></a>    <span class="c1">#         elif record_name == &quot;MODEL&quot;:</span>
</span><span id="PDBIO-755"><a href="#PDBIO-755"><span class="linenos"> 755</span></a>    <span class="c1">#             pdb_model_dict = PDBIO.parse_pdb_model_line(line)</span>
</span><span id="PDBIO-756"><a href="#PDBIO-756"><span class="linenos"> 756</span></a>    <span class="c1">#             entries.append(pdb_model_dict)</span>
</span><span id="PDBIO-757"><a href="#PDBIO-757"><span class="linenos"> 757</span></a>    <span class="c1">#         elif record_name == &quot;ENDMDL&quot;:</span>
</span><span id="PDBIO-758"><a href="#PDBIO-758"><span class="linenos"> 758</span></a>    <span class="c1">#             pdb_end_model_dict = PDBIO.parse_pdb_end_model_line(line)</span>
</span><span id="PDBIO-759"><a href="#PDBIO-759"><span class="linenos"> 759</span></a>    <span class="c1">#             entries.append(pdb_end_model_dict)</span>
</span><span id="PDBIO-760"><a href="#PDBIO-760"><span class="linenos"> 760</span></a>    <span class="c1">#         elif record_name == &quot;SEQRES&quot;:</span>
</span><span id="PDBIO-761"><a href="#PDBIO-761"><span class="linenos"> 761</span></a>    <span class="c1">#             pdb_seqres_dict = PDBIO.parse_pdb_seqres_line(line)</span>
</span><span id="PDBIO-762"><a href="#PDBIO-762"><span class="linenos"> 762</span></a>    <span class="c1">#             entries.append(pdb_seqres_dict)</span>
</span><span id="PDBIO-763"><a href="#PDBIO-763"><span class="linenos"> 763</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-764"><a href="#PDBIO-764"><span class="linenos"> 764</span></a>    <span class="c1">#     protein = Protein()</span>
</span><span id="PDBIO-765"><a href="#PDBIO-765"><span class="linenos"> 765</span></a>    <span class="c1">#     models = []</span>
</span><span id="PDBIO-766"><a href="#PDBIO-766"><span class="linenos"> 766</span></a>    <span class="c1">#     seqres = {}</span>
</span><span id="PDBIO-767"><a href="#PDBIO-767"><span class="linenos"> 767</span></a>    <span class="c1">#     current_model = None</span>
</span><span id="PDBIO-768"><a href="#PDBIO-768"><span class="linenos"> 768</span></a>    <span class="c1">#     current_chain: Optional[Chain] = None</span>
</span><span id="PDBIO-769"><a href="#PDBIO-769"><span class="linenos"> 769</span></a>    <span class="c1">#     current_chain_id = None</span>
</span><span id="PDBIO-770"><a href="#PDBIO-770"><span class="linenos"> 770</span></a>    <span class="c1">#     current_residue: Optional[Residue] = None</span>
</span><span id="PDBIO-771"><a href="#PDBIO-771"><span class="linenos"> 771</span></a>    <span class="c1">#     current_residue_id = None</span>
</span><span id="PDBIO-772"><a href="#PDBIO-772"><span class="linenos"> 772</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-773"><a href="#PDBIO-773"><span class="linenos"> 773</span></a>    <span class="c1">#     for entry in entries:</span>
</span><span id="PDBIO-774"><a href="#PDBIO-774"><span class="linenos"> 774</span></a>    <span class="c1">#         record_name = entry[&quot;record_name&quot;]</span>
</span><span id="PDBIO-775"><a href="#PDBIO-775"><span class="linenos"> 775</span></a>    <span class="c1">#         if record_name == &quot;SEQRES&quot;:</span>
</span><span id="PDBIO-776"><a href="#PDBIO-776"><span class="linenos"> 776</span></a>    <span class="c1">#             chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="PDBIO-777"><a href="#PDBIO-777"><span class="linenos"> 777</span></a>    <span class="c1">#             if chain_id not in seqres:</span>
</span><span id="PDBIO-778"><a href="#PDBIO-778"><span class="linenos"> 778</span></a>    <span class="c1">#                 seqres[chain_id] = []</span>
</span><span id="PDBIO-779"><a href="#PDBIO-779"><span class="linenos"> 779</span></a>    <span class="c1">#             seqres[chain_id].extend(entry[&quot;residues&quot;])</span>
</span><span id="PDBIO-780"><a href="#PDBIO-780"><span class="linenos"> 780</span></a>    <span class="c1">#         elif record_name == &quot;MODEL&quot;:</span>
</span><span id="PDBIO-781"><a href="#PDBIO-781"><span class="linenos"> 781</span></a>    <span class="c1">#             # Usually, the MODEL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO-782"><a href="#PDBIO-782"><span class="linenos"> 782</span></a>    <span class="c1">#             # We only use the first model in a file if provided.</span>
</span><span id="PDBIO-783"><a href="#PDBIO-783"><span class="linenos"> 783</span></a>    <span class="c1">#             # There is nothing to do, so we</span>
</span><span id="PDBIO-784"><a href="#PDBIO-784"><span class="linenos"> 784</span></a>    <span class="c1">#             pass</span>
</span><span id="PDBIO-785"><a href="#PDBIO-785"><span class="linenos"> 785</span></a>    <span class="c1">#         elif record_name == &quot;ENDMDL&quot;:</span>
</span><span id="PDBIO-786"><a href="#PDBIO-786"><span class="linenos"> 786</span></a>    <span class="c1">#             # Usually, the ENDMDL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO-787"><a href="#PDBIO-787"><span class="linenos"> 787</span></a>    <span class="c1">#             # it closes a corresponding MODEL field.</span>
</span><span id="PDBIO-788"><a href="#PDBIO-788"><span class="linenos"> 788</span></a>    <span class="c1">#             # Since the end of the model is reached, no more entries should be parsed.</span>
</span><span id="PDBIO-789"><a href="#PDBIO-789"><span class="linenos"> 789</span></a>    <span class="c1">#             break</span>
</span><span id="PDBIO-790"><a href="#PDBIO-790"><span class="linenos"> 790</span></a>    <span class="c1">#         elif record_name == &quot;TER&quot;:</span>
</span><span id="PDBIO-791"><a href="#PDBIO-791"><span class="linenos"> 791</span></a>    <span class="c1">#             # The TER field terminates the current chain.</span>
</span><span id="PDBIO-792"><a href="#PDBIO-792"><span class="linenos"> 792</span></a>    <span class="c1">#             current_chain = None</span>
</span><span id="PDBIO-793"><a href="#PDBIO-793"><span class="linenos"> 793</span></a>    <span class="c1">#             current_chain_id = None</span>
</span><span id="PDBIO-794"><a href="#PDBIO-794"><span class="linenos"> 794</span></a>    <span class="c1">#         elif record_name == &quot;ATOM&quot; or record_name == &quot;HETATM&quot;:</span>
</span><span id="PDBIO-795"><a href="#PDBIO-795"><span class="linenos"> 795</span></a>    <span class="c1">#             # If we switched chains, set the chain.</span>
</span><span id="PDBIO-796"><a href="#PDBIO-796"><span class="linenos"> 796</span></a>    <span class="c1">#             if entry[&quot;chain_id&quot;] != current_chain_id:</span>
</span><span id="PDBIO-797"><a href="#PDBIO-797"><span class="linenos"> 797</span></a>    <span class="c1">#                 current_chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="PDBIO-798"><a href="#PDBIO-798"><span class="linenos"> 798</span></a>    <span class="c1">#                 if protein.has_chain(current_chain_id):</span>
</span><span id="PDBIO-799"><a href="#PDBIO-799"><span class="linenos"> 799</span></a>    <span class="c1">#                     current_chain = protein.get_chain(current_chain_id)</span>
</span><span id="PDBIO-800"><a href="#PDBIO-800"><span class="linenos"> 800</span></a>    <span class="c1">#                 else:</span>
</span><span id="PDBIO-801"><a href="#PDBIO-801"><span class="linenos"> 801</span></a>    <span class="c1">#                     current_chain = protein.create_chain(current_chain_id)</span>
</span><span id="PDBIO-802"><a href="#PDBIO-802"><span class="linenos"> 802</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-803"><a href="#PDBIO-803"><span class="linenos"> 803</span></a>    <span class="c1">#             # Check if the residue exists</span>
</span><span id="PDBIO-804"><a href="#PDBIO-804"><span class="linenos"> 804</span></a>    <span class="c1">#             residue_id = current_chain_id + entry[&quot;res_seq&quot;] + entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-805"><a href="#PDBIO-805"><span class="linenos"> 805</span></a>    <span class="c1">#             if residue_id != current_residue_id:</span>
</span><span id="PDBIO-806"><a href="#PDBIO-806"><span class="linenos"> 806</span></a>    <span class="c1">#                 current_residue_id = residue_id</span>
</span><span id="PDBIO-807"><a href="#PDBIO-807"><span class="linenos"> 807</span></a>    <span class="c1">#                 if record_name == &quot;ATOM&quot;:</span>
</span><span id="PDBIO-808"><a href="#PDBIO-808"><span class="linenos"> 808</span></a>    <span class="c1">#                     # if entry[&quot;res_name&quot;] in ResidueTemplate.VALID_DNA_RESIDUES:</span>
</span><span id="PDBIO-809"><a href="#PDBIO-809"><span class="linenos"> 809</span></a>    <span class="c1">#                     #     current_residue = current_chain.add_dna_residue(</span>
</span><span id="PDBIO-810"><a href="#PDBIO-810"><span class="linenos"> 810</span></a>    <span class="c1">#                     #         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-811"><a href="#PDBIO-811"><span class="linenos"> 811</span></a>    <span class="c1">#                     #         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-812"><a href="#PDBIO-812"><span class="linenos"> 812</span></a>    <span class="c1">#                     #         insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-813"><a href="#PDBIO-813"><span class="linenos"> 813</span></a>    <span class="c1">#                     #     )</span>
</span><span id="PDBIO-814"><a href="#PDBIO-814"><span class="linenos"> 814</span></a>    <span class="c1">#                     # else:</span>
</span><span id="PDBIO-815"><a href="#PDBIO-815"><span class="linenos"> 815</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="PDBIO-816"><a href="#PDBIO-816"><span class="linenos"> 816</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-817"><a href="#PDBIO-817"><span class="linenos"> 817</span></a>    <span class="c1">#                         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-818"><a href="#PDBIO-818"><span class="linenos"> 818</span></a>    <span class="c1">#                         insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="PDBIO-819"><a href="#PDBIO-819"><span class="linenos"> 819</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="PDBIO-820"><a href="#PDBIO-820"><span class="linenos"> 820</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="PDBIO-821"><a href="#PDBIO-821"><span class="linenos"> 821</span></a>    <span class="c1">#                 elif record_name == &quot;HETATM&quot;:</span>
</span><span id="PDBIO-822"><a href="#PDBIO-822"><span class="linenos"> 822</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="PDBIO-823"><a href="#PDBIO-823"><span class="linenos"> 823</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-824"><a href="#PDBIO-824"><span class="linenos"> 824</span></a>    <span class="c1">#                         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-825"><a href="#PDBIO-825"><span class="linenos"> 825</span></a>    <span class="c1">#                         insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="PDBIO-826"><a href="#PDBIO-826"><span class="linenos"> 826</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="PDBIO-827"><a href="#PDBIO-827"><span class="linenos"> 827</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="PDBIO-828"><a href="#PDBIO-828"><span class="linenos"> 828</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-829"><a href="#PDBIO-829"><span class="linenos"> 829</span></a>    <span class="c1">#                     # current_residue = current_chain.add_het_residue(</span>
</span><span id="PDBIO-830"><a href="#PDBIO-830"><span class="linenos"> 830</span></a>    <span class="c1">#                     #     residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-831"><a href="#PDBIO-831"><span class="linenos"> 831</span></a>    <span class="c1">#                     #     sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-832"><a href="#PDBIO-832"><span class="linenos"> 832</span></a>    <span class="c1">#                     #     insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-833"><a href="#PDBIO-833"><span class="linenos"> 833</span></a>    <span class="c1">#                     # )</span>
</span><span id="PDBIO-834"><a href="#PDBIO-834"><span class="linenos"> 834</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-835"><a href="#PDBIO-835"><span class="linenos"> 835</span></a>    <span class="c1">#             # Temporary fix need to see if anything breaks (For Evo eg. 2HH1 -&gt; HH12)</span>
</span><span id="PDBIO-836"><a href="#PDBIO-836"><span class="linenos"> 836</span></a>    <span class="c1">#             # Fix atom naming</span>
</span><span id="PDBIO-837"><a href="#PDBIO-837"><span class="linenos"> 837</span></a>    <span class="c1">#             if entry[&quot;atom_name&quot;][0].isnumeric():</span>
</span><span id="PDBIO-838"><a href="#PDBIO-838"><span class="linenos"> 838</span></a>    <span class="c1">#                 entry[&quot;atom_name&quot;] = entry[&quot;atom_name&quot;][1:] + entry[&quot;atom_name&quot;][0]</span>
</span><span id="PDBIO-839"><a href="#PDBIO-839"><span class="linenos"> 839</span></a>    <span class="c1">#                 if entry[&quot;element&quot;] != &quot;H&quot;:</span>
</span><span id="PDBIO-840"><a href="#PDBIO-840"><span class="linenos"> 840</span></a>    <span class="c1">#                     print(0)</span>
</span><span id="PDBIO-841"><a href="#PDBIO-841"><span class="linenos"> 841</span></a>    <span class="c1">#                 if entry[&quot;atom_name&quot;][0] == &quot;H&quot;:</span>
</span><span id="PDBIO-842"><a href="#PDBIO-842"><span class="linenos"> 842</span></a>    <span class="c1">#                     entry[&quot;element&quot;] = &quot;H&quot;</span>
</span><span id="PDBIO-843"><a href="#PDBIO-843"><span class="linenos"> 843</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-844"><a href="#PDBIO-844"><span class="linenos"> 844</span></a>    <span class="c1">#             # Add the atom to the residue</span>
</span><span id="PDBIO-845"><a href="#PDBIO-845"><span class="linenos"> 845</span></a>    <span class="c1">#             if entry[&quot;alt_loc&quot;] == &quot;&quot;:</span>
</span><span id="PDBIO-846"><a href="#PDBIO-846"><span class="linenos"> 846</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;]</span>
</span><span id="PDBIO-847"><a href="#PDBIO-847"><span class="linenos"> 847</span></a>    <span class="c1">#             else:</span>
</span><span id="PDBIO-848"><a href="#PDBIO-848"><span class="linenos"> 848</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;] + &quot;_&quot; + entry[&quot;alt_loc&quot;]</span>
</span><span id="PDBIO-849"><a href="#PDBIO-849"><span class="linenos"> 849</span></a>    <span class="c1">#             atom = Atom(</span>
</span><span id="PDBIO-850"><a href="#PDBIO-850"><span class="linenos"> 850</span></a>    <span class="c1">#                 element=entry[&quot;element&quot;],</span>
</span><span id="PDBIO-851"><a href="#PDBIO-851"><span class="linenos"> 851</span></a>    <span class="c1">#                 atom_type=entry[&quot;atom_name&quot;],</span>
</span><span id="PDBIO-852"><a href="#PDBIO-852"><span class="linenos"> 852</span></a>    <span class="c1">#                 x=entry[&quot;x&quot;],</span>
</span><span id="PDBIO-853"><a href="#PDBIO-853"><span class="linenos"> 853</span></a>    <span class="c1">#                 y=entry[&quot;y&quot;],</span>
</span><span id="PDBIO-854"><a href="#PDBIO-854"><span class="linenos"> 854</span></a>    <span class="c1">#                 z=entry[&quot;z&quot;],</span>
</span><span id="PDBIO-855"><a href="#PDBIO-855"><span class="linenos"> 855</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-856"><a href="#PDBIO-856"><span class="linenos"> 856</span></a>    <span class="c1">#                 # pdb_serial=entry[&quot;serial&quot;],</span>
</span><span id="PDBIO-857"><a href="#PDBIO-857"><span class="linenos"> 857</span></a>    <span class="c1">#                 # pdb_alt_loc=entry[&quot;alt_loc&quot;],</span>
</span><span id="PDBIO-858"><a href="#PDBIO-858"><span class="linenos"> 858</span></a>    <span class="c1">#                 # pdb_occupancy=entry[&quot;occupancy&quot;],</span>
</span><span id="PDBIO-859"><a href="#PDBIO-859"><span class="linenos"> 859</span></a>    <span class="c1">#                 # pdb_temp_factor=entry[&quot;temp_factor&quot;],</span>
</span><span id="PDBIO-860"><a href="#PDBIO-860"><span class="linenos"> 860</span></a>    <span class="c1">#                 # pdb_assigned_charge=entry[&quot;assigned_charge&quot;],</span>
</span><span id="PDBIO-861"><a href="#PDBIO-861"><span class="linenos"> 861</span></a>    <span class="c1">#                 # pqr_calculated_charge=entry[&quot;calculated_charge&quot;],</span>
</span><span id="PDBIO-862"><a href="#PDBIO-862"><span class="linenos"> 862</span></a>    <span class="c1">#                 # pqr_radius=entry[&quot;radius&quot;],</span>
</span><span id="PDBIO-863"><a href="#PDBIO-863"><span class="linenos"> 863</span></a>    <span class="c1">#                 #</span>
</span><span id="PDBIO-864"><a href="#PDBIO-864"><span class="linenos"> 864</span></a>    <span class="c1">#                 is_hetero=(record_name == &quot;HETATM&quot;),</span>
</span><span id="PDBIO-865"><a href="#PDBIO-865"><span class="linenos"> 865</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-866"><a href="#PDBIO-866"><span class="linenos"> 866</span></a>    <span class="c1">#                 residue=current_residue</span>
</span><span id="PDBIO-867"><a href="#PDBIO-867"><span class="linenos"> 867</span></a>    <span class="c1">#             )</span>
</span><span id="PDBIO-868"><a href="#PDBIO-868"><span class="linenos"> 868</span></a>    <span class="c1">#             current_residue.add_atom(atom_id, atom)</span>
</span><span id="PDBIO-869"><a href="#PDBIO-869"><span class="linenos"> 869</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-870"><a href="#PDBIO-870"><span class="linenos"> 870</span></a>    <span class="c1">#     # if seqres:</span>
</span><span id="PDBIO-871"><a href="#PDBIO-871"><span class="linenos"> 871</span></a>    <span class="c1">#     #     for chain_id in seqres:</span>
</span><span id="PDBIO-872"><a href="#PDBIO-872"><span class="linenos"> 872</span></a>    <span class="c1">#     #         if seqres[chain_id]:</span>
</span><span id="PDBIO-873"><a href="#PDBIO-873"><span class="linenos"> 873</span></a>    <span class="c1">#     #             protein.chains[chain_id].sequence = seqres[chain_id]</span>
</span><span id="PDBIO-874"><a href="#PDBIO-874"><span class="linenos"> 874</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-875"><a href="#PDBIO-875"><span class="linenos"> 875</span></a>    <span class="c1">#     # Housekeeping</span>
</span><span id="PDBIO-876"><a href="#PDBIO-876"><span class="linenos"> 876</span></a>    <span class="c1">#     # protein.set_residue_indexing()</span>
</span><span id="PDBIO-877"><a href="#PDBIO-877"><span class="linenos"> 877</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-878"><a href="#PDBIO-878"><span class="linenos"> 878</span></a>    <span class="c1">#     return [protein]</span>
</span><span id="PDBIO-879"><a href="#PDBIO-879"><span class="linenos"> 879</span></a>
</span><span id="PDBIO-880"><a href="#PDBIO-880"><span class="linenos"> 880</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="PDBIO-881"><a href="#PDBIO-881"><span class="linenos"> 881</span></a>    <span class="c1"># def to_pdb_text(protein: Protein):</span>
</span><span id="PDBIO-882"><a href="#PDBIO-882"><span class="linenos"> 882</span></a>    <span class="c1">#     text_entries = &quot;&quot;</span>
</span><span id="PDBIO-883"><a href="#PDBIO-883"><span class="linenos"> 883</span></a>    <span class="c1">#     num_seqres = 0</span>
</span><span id="PDBIO-884"><a href="#PDBIO-884"><span class="linenos"> 884</span></a>    <span class="c1">#     num_atoms = 0</span>
</span><span id="PDBIO-885"><a href="#PDBIO-885"><span class="linenos"> 885</span></a>    <span class="c1">#     num_hetatoms = 0</span>
</span><span id="PDBIO-886"><a href="#PDBIO-886"><span class="linenos"> 886</span></a>    <span class="c1">#     num_ter = 0</span>
</span><span id="PDBIO-887"><a href="#PDBIO-887"><span class="linenos"> 887</span></a>    <span class="c1">#     serial = 1</span>
</span><span id="PDBIO-888"><a href="#PDBIO-888"><span class="linenos"> 888</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-889"><a href="#PDBIO-889"><span class="linenos"> 889</span></a>    <span class="c1">#     for chain in protein.chains:</span>
</span><span id="PDBIO-890"><a href="#PDBIO-890"><span class="linenos"> 890</span></a>    <span class="c1">#         for residue in chain.residues:</span>
</span><span id="PDBIO-891"><a href="#PDBIO-891"><span class="linenos"> 891</span></a>    <span class="c1">#             for atom in residue.atoms:</span>
</span><span id="PDBIO-892"><a href="#PDBIO-892"><span class="linenos"> 892</span></a>    <span class="c1">#                 if not atom.is_hetero:</span>
</span><span id="PDBIO-893"><a href="#PDBIO-893"><span class="linenos"> 893</span></a>    <span class="c1">#                     atom_entry = {</span>
</span><span id="PDBIO-894"><a href="#PDBIO-894"><span class="linenos"> 894</span></a>    <span class="c1">#                         &quot;element&quot;: atom.element,</span>
</span><span id="PDBIO-895"><a href="#PDBIO-895"><span class="linenos"> 895</span></a>    <span class="c1">#                         &quot;atom_name&quot;: atom.atom_type,</span>
</span><span id="PDBIO-896"><a href="#PDBIO-896"><span class="linenos"> 896</span></a>    <span class="c1">#                         &quot;alt_loc&quot;: atom.get_attribute(&quot;pdb_alt_loc&quot;),</span>
</span><span id="PDBIO-897"><a href="#PDBIO-897"><span class="linenos"> 897</span></a>    <span class="c1">#                         &quot;res_name&quot;: residue.residue_type,</span>
</span><span id="PDBIO-898"><a href="#PDBIO-898"><span class="linenos"> 898</span></a>    <span class="c1">#                         &quot;chain_id&quot;: chain.chain_id,</span>
</span><span id="PDBIO-899"><a href="#PDBIO-899"><span class="linenos"> 899</span></a>    <span class="c1">#                         &quot;res_seq&quot;: str(residue.sequence_no),</span>
</span><span id="PDBIO-900"><a href="#PDBIO-900"><span class="linenos"> 900</span></a>    <span class="c1">#                         &quot;icode&quot;: residue.insertion_code,</span>
</span><span id="PDBIO-901"><a href="#PDBIO-901"><span class="linenos"> 901</span></a>    <span class="c1">#                         &quot;x&quot;: atom.x,</span>
</span><span id="PDBIO-902"><a href="#PDBIO-902"><span class="linenos"> 902</span></a>    <span class="c1">#                         &quot;y&quot;: atom.y,</span>
</span><span id="PDBIO-903"><a href="#PDBIO-903"><span class="linenos"> 903</span></a>    <span class="c1">#                         &quot;z&quot;: atom.z,</span>
</span><span id="PDBIO-904"><a href="#PDBIO-904"><span class="linenos"> 904</span></a>    <span class="c1">#                         &quot;occupancy&quot;: atom.get_attribute(&quot;occupancy&quot;),</span>
</span><span id="PDBIO-905"><a href="#PDBIO-905"><span class="linenos"> 905</span></a>    <span class="c1">#                         # &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="PDBIO-906"><a href="#PDBIO-906"><span class="linenos"> 906</span></a>    <span class="c1">#                         &quot;temp_factor&quot;: atom.get_attribute(&quot;temp_factor&quot;),</span>
</span><span id="PDBIO-907"><a href="#PDBIO-907"><span class="linenos"> 907</span></a>    <span class="c1">#                         &quot;charge&quot;: atom.get_attribute(&quot;assigned_charge&quot;)</span>
</span><span id="PDBIO-908"><a href="#PDBIO-908"><span class="linenos"> 908</span></a>    <span class="c1">#                     }</span>
</span><span id="PDBIO-909"><a href="#PDBIO-909"><span class="linenos"> 909</span></a>    <span class="c1">#                     text_entries += PDBIO.create_pdb_atom_line(atom_entry, serial)</span>
</span><span id="PDBIO-910"><a href="#PDBIO-910"><span class="linenos"> 910</span></a>    <span class="c1">#                     text_entries += &quot;\n&quot;</span>
</span><span id="PDBIO-911"><a href="#PDBIO-911"><span class="linenos"> 911</span></a>    <span class="c1">#                     serial += 1</span>
</span><span id="PDBIO-912"><a href="#PDBIO-912"><span class="linenos"> 912</span></a>    <span class="c1">#                     num_atoms += 1</span>
</span><span id="PDBIO-913"><a href="#PDBIO-913"><span class="linenos"> 913</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-914"><a href="#PDBIO-914"><span class="linenos"> 914</span></a>    <span class="c1">#     # Bookkeeping records</span>
</span><span id="PDBIO-915"><a href="#PDBIO-915"><span class="linenos"> 915</span></a>    <span class="c1">#     text_entries += PDBIO.create_pdb_master_line(num_atoms, num_hetatoms, num_ter, num_seqres=num_seqres)</span>
</span><span id="PDBIO-916"><a href="#PDBIO-916"><span class="linenos"> 916</span></a>    <span class="c1">#     text_entries += &quot;END&quot;.ljust(80)</span>
</span><span id="PDBIO-917"><a href="#PDBIO-917"><span class="linenos"> 917</span></a>    <span class="c1">#     text_entries += &quot;\n&quot;</span>
</span><span id="PDBIO-918"><a href="#PDBIO-918"><span class="linenos"> 918</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-919"><a href="#PDBIO-919"><span class="linenos"> 919</span></a>    <span class="c1">#     return text_entries</span>
</span><span id="PDBIO-920"><a href="#PDBIO-920"><span class="linenos"> 920</span></a>
</span><span id="PDBIO-921"><a href="#PDBIO-921"><span class="linenos"> 921</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="PDBIO-922"><a href="#PDBIO-922"><span class="linenos"> 922</span></a>    <span class="c1"># def save_to_pdb(file_path: str, protein):</span>
</span><span id="PDBIO-923"><a href="#PDBIO-923"><span class="linenos"> 923</span></a>    <span class="c1">#     entries = []</span>
</span><span id="PDBIO-924"><a href="#PDBIO-924"><span class="linenos"> 924</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-925"><a href="#PDBIO-925"><span class="linenos"> 925</span></a>    <span class="c1">#     num_seqres = 0</span>
</span><span id="PDBIO-926"><a href="#PDBIO-926"><span class="linenos"> 926</span></a>    <span class="c1">#     num_atoms = 0</span>
</span><span id="PDBIO-927"><a href="#PDBIO-927"><span class="linenos"> 927</span></a>    <span class="c1">#     num_hetatoms = 0</span>
</span><span id="PDBIO-928"><a href="#PDBIO-928"><span class="linenos"> 928</span></a>    <span class="c1">#     num_ter = 0</span>
</span><span id="PDBIO-929"><a href="#PDBIO-929"><span class="linenos"> 929</span></a>    <span class="c1">#     serial = 1</span>
</span><span id="PDBIO-930"><a href="#PDBIO-930"><span class="linenos"> 930</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-931"><a href="#PDBIO-931"><span class="linenos"> 931</span></a>    <span class="c1">#     for chain in protein.chains:</span>
</span><span id="PDBIO-932"><a href="#PDBIO-932"><span class="linenos"> 932</span></a>    <span class="c1">#         for residue in chain.residues:</span>
</span><span id="PDBIO-933"><a href="#PDBIO-933"><span class="linenos"> 933</span></a>    <span class="c1">#             # ATOM entries</span>
</span><span id="PDBIO-934"><a href="#PDBIO-934"><span class="linenos"> 934</span></a>    <span class="c1">#             for atom in residue.atoms:</span>
</span><span id="PDBIO-935"><a href="#PDBIO-935"><span class="linenos"> 935</span></a>    <span class="c1">#                 if not atom.is_hetero:</span>
</span><span id="PDBIO-936"><a href="#PDBIO-936"><span class="linenos"> 936</span></a>    <span class="c1">#                     atom_entry = {</span>
</span><span id="PDBIO-937"><a href="#PDBIO-937"><span class="linenos"> 937</span></a>    <span class="c1">#                         &quot;element&quot;: atom.element,</span>
</span><span id="PDBIO-938"><a href="#PDBIO-938"><span class="linenos"> 938</span></a>    <span class="c1">#                         &quot;atom_name&quot;: atom.atom_type,</span>
</span><span id="PDBIO-939"><a href="#PDBIO-939"><span class="linenos"> 939</span></a>    <span class="c1">#                         &quot;alt_loc&quot;: atom._pdb_alt_loc,</span>
</span><span id="PDBIO-940"><a href="#PDBIO-940"><span class="linenos"> 940</span></a>    <span class="c1">#                         &quot;res_name&quot;: residue.residue_type,</span>
</span><span id="PDBIO-941"><a href="#PDBIO-941"><span class="linenos"> 941</span></a>    <span class="c1">#                         &quot;chain_id&quot;: chain.chain_id,</span>
</span><span id="PDBIO-942"><a href="#PDBIO-942"><span class="linenos"> 942</span></a>    <span class="c1">#                         &quot;res_seq&quot;: str(residue._pdb_sequence_no),</span>
</span><span id="PDBIO-943"><a href="#PDBIO-943"><span class="linenos"> 943</span></a>    <span class="c1">#                         &quot;icode&quot;: residue._pdb_insertion_code,</span>
</span><span id="PDBIO-944"><a href="#PDBIO-944"><span class="linenos"> 944</span></a>    <span class="c1">#                         &quot;x&quot;: atom.x,</span>
</span><span id="PDBIO-945"><a href="#PDBIO-945"><span class="linenos"> 945</span></a>    <span class="c1">#                         &quot;y&quot;: atom.y,</span>
</span><span id="PDBIO-946"><a href="#PDBIO-946"><span class="linenos"> 946</span></a>    <span class="c1">#                         &quot;z&quot;: atom.z,</span>
</span><span id="PDBIO-947"><a href="#PDBIO-947"><span class="linenos"> 947</span></a>    <span class="c1">#                         &quot;occupancy&quot;: atom._pdb_occupancy,</span>
</span><span id="PDBIO-948"><a href="#PDBIO-948"><span class="linenos"> 948</span></a>    <span class="c1">#                         &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="PDBIO-949"><a href="#PDBIO-949"><span class="linenos"> 949</span></a>    <span class="c1">#                         &quot;charge&quot;: atom._pdb_assigned_charge</span>
</span><span id="PDBIO-950"><a href="#PDBIO-950"><span class="linenos"> 950</span></a>    <span class="c1">#                     }</span>
</span><span id="PDBIO-951"><a href="#PDBIO-951"><span class="linenos"> 951</span></a>    <span class="c1">#                     entries.append(PDBParser.create_pdb_atom_line(atom_entry, serial))</span>
</span><span id="PDBIO-952"><a href="#PDBIO-952"><span class="linenos"> 952</span></a>    <span class="c1">#                     serial += 1</span>
</span><span id="PDBIO-953"><a href="#PDBIO-953"><span class="linenos"> 953</span></a>    <span class="c1">#                     num_atoms += 1</span>
</span><span id="PDBIO-954"><a href="#PDBIO-954"><span class="linenos"> 954</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-955"><a href="#PDBIO-955"><span class="linenos"> 955</span></a>    <span class="c1">#         # TER entry</span>
</span><span id="PDBIO-956"><a href="#PDBIO-956"><span class="linenos"> 956</span></a>    <span class="c1">#         if chain.num_residues - chain.num_hetero_residues &gt; 0:</span>
</span><span id="PDBIO-957"><a href="#PDBIO-957"><span class="linenos"> 957</span></a>    <span class="c1">#             entries.append(</span>
</span><span id="PDBIO-958"><a href="#PDBIO-958"><span class="linenos"> 958</span></a>    <span class="c1">#                 PDBParser.create_pdb_ter_line(serial, atom_entry[&quot;res_name&quot;], chain.chain_id, atom_entry[&quot;res_seq&quot;],</span>
</span><span id="PDBIO-959"><a href="#PDBIO-959"><span class="linenos"> 959</span></a>    <span class="c1">#                                               atom_entry[&quot;icode&quot;]))</span>
</span><span id="PDBIO-960"><a href="#PDBIO-960"><span class="linenos"> 960</span></a>    <span class="c1">#             serial = serial + 1</span>
</span><span id="PDBIO-961"><a href="#PDBIO-961"><span class="linenos"> 961</span></a>    <span class="c1">#             num_ter += 1</span>
</span><span id="PDBIO-962"><a href="#PDBIO-962"><span class="linenos"> 962</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-963"><a href="#PDBIO-963"><span class="linenos"> 963</span></a>    <span class="c1">#     for chain in protein.chains:</span>
</span><span id="PDBIO-964"><a href="#PDBIO-964"><span class="linenos"> 964</span></a>    <span class="c1">#         for residue in chain.residues:</span>
</span><span id="PDBIO-965"><a href="#PDBIO-965"><span class="linenos"> 965</span></a>    <span class="c1">#             # HETATM entries</span>
</span><span id="PDBIO-966"><a href="#PDBIO-966"><span class="linenos"> 966</span></a>    <span class="c1">#             for atom in residue.atoms:</span>
</span><span id="PDBIO-967"><a href="#PDBIO-967"><span class="linenos"> 967</span></a>    <span class="c1">#                 if atom.is_hetero:</span>
</span><span id="PDBIO-968"><a href="#PDBIO-968"><span class="linenos"> 968</span></a>    <span class="c1">#                     atom_entry = {</span>
</span><span id="PDBIO-969"><a href="#PDBIO-969"><span class="linenos"> 969</span></a>    <span class="c1">#                         &quot;element&quot;: atom.element,</span>
</span><span id="PDBIO-970"><a href="#PDBIO-970"><span class="linenos"> 970</span></a>    <span class="c1">#                         &quot;atom_name&quot;: atom.atom_type,</span>
</span><span id="PDBIO-971"><a href="#PDBIO-971"><span class="linenos"> 971</span></a>    <span class="c1">#                         &quot;alt_loc&quot;: atom._pdb_alt_loc,</span>
</span><span id="PDBIO-972"><a href="#PDBIO-972"><span class="linenos"> 972</span></a>    <span class="c1">#                         &quot;res_name&quot;: residue.residue_type,</span>
</span><span id="PDBIO-973"><a href="#PDBIO-973"><span class="linenos"> 973</span></a>    <span class="c1">#                         &quot;chain_id&quot;: chain.chain_id,</span>
</span><span id="PDBIO-974"><a href="#PDBIO-974"><span class="linenos"> 974</span></a>    <span class="c1">#                         &quot;res_seq&quot;: str(residue._pdb_sequence_no),</span>
</span><span id="PDBIO-975"><a href="#PDBIO-975"><span class="linenos"> 975</span></a>    <span class="c1">#                         &quot;icode&quot;: residue._pdb_insertion_code,</span>
</span><span id="PDBIO-976"><a href="#PDBIO-976"><span class="linenos"> 976</span></a>    <span class="c1">#                         &quot;x&quot;: atom.x,</span>
</span><span id="PDBIO-977"><a href="#PDBIO-977"><span class="linenos"> 977</span></a>    <span class="c1">#                         &quot;y&quot;: atom.y,</span>
</span><span id="PDBIO-978"><a href="#PDBIO-978"><span class="linenos"> 978</span></a>    <span class="c1">#                         &quot;z&quot;: atom.z,</span>
</span><span id="PDBIO-979"><a href="#PDBIO-979"><span class="linenos"> 979</span></a>    <span class="c1">#                         &quot;occupancy&quot;: atom._pdb_occupancy,</span>
</span><span id="PDBIO-980"><a href="#PDBIO-980"><span class="linenos"> 980</span></a>    <span class="c1">#                         &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="PDBIO-981"><a href="#PDBIO-981"><span class="linenos"> 981</span></a>    <span class="c1">#                         &quot;charge&quot;: atom._pdb_assigned_charge</span>
</span><span id="PDBIO-982"><a href="#PDBIO-982"><span class="linenos"> 982</span></a>    <span class="c1">#                     }</span>
</span><span id="PDBIO-983"><a href="#PDBIO-983"><span class="linenos"> 983</span></a>    <span class="c1">#                     entries.append(PDBParser.create_pdb_atom_line(atom_entry, serial, &quot;HETATM&quot;))</span>
</span><span id="PDBIO-984"><a href="#PDBIO-984"><span class="linenos"> 984</span></a>    <span class="c1">#                     serial += 1</span>
</span><span id="PDBIO-985"><a href="#PDBIO-985"><span class="linenos"> 985</span></a>    <span class="c1">#                     num_hetatoms += 1</span>
</span><span id="PDBIO-986"><a href="#PDBIO-986"><span class="linenos"> 986</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-987"><a href="#PDBIO-987"><span class="linenos"> 987</span></a>    <span class="c1">#         # Hetero residues have no TER records, so no need to write a termination code.</span>
</span><span id="PDBIO-988"><a href="#PDBIO-988"><span class="linenos"> 988</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-989"><a href="#PDBIO-989"><span class="linenos"> 989</span></a>    <span class="c1">#     # Bookkeeping records</span>
</span><span id="PDBIO-990"><a href="#PDBIO-990"><span class="linenos"> 990</span></a>    <span class="c1">#     entries.append(PDBParser.create_pdb_master_line(num_atoms, num_hetatoms, num_ter, num_seqres=num_seqres))</span>
</span><span id="PDBIO-991"><a href="#PDBIO-991"><span class="linenos"> 991</span></a>    <span class="c1">#     entries.append(&quot;END&quot;.ljust(80))</span>
</span><span id="PDBIO-992"><a href="#PDBIO-992"><span class="linenos"> 992</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-993"><a href="#PDBIO-993"><span class="linenos"> 993</span></a>    <span class="c1">#     # Write file</span>
</span><span id="PDBIO-994"><a href="#PDBIO-994"><span class="linenos"> 994</span></a>    <span class="c1">#     with open(file_path, &quot;w&quot;) as file:</span>
</span><span id="PDBIO-995"><a href="#PDBIO-995"><span class="linenos"> 995</span></a>    <span class="c1">#         file.write(&quot;\n&quot;.join(entries))</span>
</span><span id="PDBIO-996"><a href="#PDBIO-996"><span class="linenos"> 996</span></a>
</span><span id="PDBIO-997"><a href="#PDBIO-997"><span class="linenos"> 997</span></a>    <span class="c1"># @staticmethod</span>
</span><span id="PDBIO-998"><a href="#PDBIO-998"><span class="linenos"> 998</span></a>    <span class="c1"># def load_from_pdb(file_path: str):</span>
</span><span id="PDBIO-999"><a href="#PDBIO-999"><span class="linenos"> 999</span></a>    <span class="c1">#     entries = PDBParser.parse_pdb_entries(file_path)</span>
</span><span id="PDBIO-1000"><a href="#PDBIO-1000"><span class="linenos">1000</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1001"><a href="#PDBIO-1001"><span class="linenos">1001</span></a>    <span class="c1">#     protein = Protein()</span>
</span><span id="PDBIO-1002"><a href="#PDBIO-1002"><span class="linenos">1002</span></a>    <span class="c1">#     models = []</span>
</span><span id="PDBIO-1003"><a href="#PDBIO-1003"><span class="linenos">1003</span></a>    <span class="c1">#     seqres = {}</span>
</span><span id="PDBIO-1004"><a href="#PDBIO-1004"><span class="linenos">1004</span></a>    <span class="c1">#     current_model = None</span>
</span><span id="PDBIO-1005"><a href="#PDBIO-1005"><span class="linenos">1005</span></a>    <span class="c1">#     current_chain: Chain = None</span>
</span><span id="PDBIO-1006"><a href="#PDBIO-1006"><span class="linenos">1006</span></a>    <span class="c1">#     current_chain_id = None</span>
</span><span id="PDBIO-1007"><a href="#PDBIO-1007"><span class="linenos">1007</span></a>    <span class="c1">#     current_residue: Residue = None</span>
</span><span id="PDBIO-1008"><a href="#PDBIO-1008"><span class="linenos">1008</span></a>    <span class="c1">#     current_residue_id = None</span>
</span><span id="PDBIO-1009"><a href="#PDBIO-1009"><span class="linenos">1009</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1010"><a href="#PDBIO-1010"><span class="linenos">1010</span></a>    <span class="c1">#     for entry in entries:</span>
</span><span id="PDBIO-1011"><a href="#PDBIO-1011"><span class="linenos">1011</span></a>    <span class="c1">#         record_name = entry[&quot;record_name&quot;]</span>
</span><span id="PDBIO-1012"><a href="#PDBIO-1012"><span class="linenos">1012</span></a>    <span class="c1">#         if record_name == &quot;SEQRES&quot;:</span>
</span><span id="PDBIO-1013"><a href="#PDBIO-1013"><span class="linenos">1013</span></a>    <span class="c1">#             chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="PDBIO-1014"><a href="#PDBIO-1014"><span class="linenos">1014</span></a>    <span class="c1">#             if chain_id not in seqres:</span>
</span><span id="PDBIO-1015"><a href="#PDBIO-1015"><span class="linenos">1015</span></a>    <span class="c1">#                 seqres[chain_id] = []</span>
</span><span id="PDBIO-1016"><a href="#PDBIO-1016"><span class="linenos">1016</span></a>    <span class="c1">#             seqres[chain_id].extend(entry[&quot;residues&quot;])</span>
</span><span id="PDBIO-1017"><a href="#PDBIO-1017"><span class="linenos">1017</span></a>    <span class="c1">#         elif record_name == &quot;MODEL&quot;:</span>
</span><span id="PDBIO-1018"><a href="#PDBIO-1018"><span class="linenos">1018</span></a>    <span class="c1">#             # Usually, the MODEL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO-1019"><a href="#PDBIO-1019"><span class="linenos">1019</span></a>    <span class="c1">#             # We only use the first model in a file if provided.</span>
</span><span id="PDBIO-1020"><a href="#PDBIO-1020"><span class="linenos">1020</span></a>    <span class="c1">#             # There is nothing to do, so we</span>
</span><span id="PDBIO-1021"><a href="#PDBIO-1021"><span class="linenos">1021</span></a>    <span class="c1">#             pass</span>
</span><span id="PDBIO-1022"><a href="#PDBIO-1022"><span class="linenos">1022</span></a>    <span class="c1">#         elif record_name == &quot;ENDMDL&quot;:</span>
</span><span id="PDBIO-1023"><a href="#PDBIO-1023"><span class="linenos">1023</span></a>    <span class="c1">#             # Usually, the ENDMDL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO-1024"><a href="#PDBIO-1024"><span class="linenos">1024</span></a>    <span class="c1">#             # it closes a corresponding MODEL field.</span>
</span><span id="PDBIO-1025"><a href="#PDBIO-1025"><span class="linenos">1025</span></a>    <span class="c1">#             # Since the end of the model is reached, no more entries should be parsed.</span>
</span><span id="PDBIO-1026"><a href="#PDBIO-1026"><span class="linenos">1026</span></a>    <span class="c1">#             break</span>
</span><span id="PDBIO-1027"><a href="#PDBIO-1027"><span class="linenos">1027</span></a>    <span class="c1">#         elif record_name == &quot;TER&quot;:</span>
</span><span id="PDBIO-1028"><a href="#PDBIO-1028"><span class="linenos">1028</span></a>    <span class="c1">#             # The TER field terminates the current chain.</span>
</span><span id="PDBIO-1029"><a href="#PDBIO-1029"><span class="linenos">1029</span></a>    <span class="c1">#             current_chain = None</span>
</span><span id="PDBIO-1030"><a href="#PDBIO-1030"><span class="linenos">1030</span></a>    <span class="c1">#             current_chain_id = None</span>
</span><span id="PDBIO-1031"><a href="#PDBIO-1031"><span class="linenos">1031</span></a>    <span class="c1">#         elif record_name == &quot;ATOM&quot; or record_name == &quot;HETATM&quot;:</span>
</span><span id="PDBIO-1032"><a href="#PDBIO-1032"><span class="linenos">1032</span></a>    <span class="c1">#             # If we switched chains, set the chain.</span>
</span><span id="PDBIO-1033"><a href="#PDBIO-1033"><span class="linenos">1033</span></a>    <span class="c1">#             if entry[&quot;chain_id&quot;] != current_chain_id:</span>
</span><span id="PDBIO-1034"><a href="#PDBIO-1034"><span class="linenos">1034</span></a>    <span class="c1">#                 current_chain_id = entry[&quot;chain_id&quot;]</span>
</span><span id="PDBIO-1035"><a href="#PDBIO-1035"><span class="linenos">1035</span></a>    <span class="c1">#                 if current_chain_id in protein._chains:</span>
</span><span id="PDBIO-1036"><a href="#PDBIO-1036"><span class="linenos">1036</span></a>    <span class="c1">#                     current_chain = protein._chains[current_chain_id]</span>
</span><span id="PDBIO-1037"><a href="#PDBIO-1037"><span class="linenos">1037</span></a>    <span class="c1">#                 else:</span>
</span><span id="PDBIO-1038"><a href="#PDBIO-1038"><span class="linenos">1038</span></a>    <span class="c1">#                     current_chain = protein.create_chain(current_chain_id)</span>
</span><span id="PDBIO-1039"><a href="#PDBIO-1039"><span class="linenos">1039</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1040"><a href="#PDBIO-1040"><span class="linenos">1040</span></a>    <span class="c1">#             # Check if the residue exists</span>
</span><span id="PDBIO-1041"><a href="#PDBIO-1041"><span class="linenos">1041</span></a>    <span class="c1">#             residue_id = current_chain_id + entry[&quot;res_seq&quot;] + entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-1042"><a href="#PDBIO-1042"><span class="linenos">1042</span></a>    <span class="c1">#             if residue_id != current_residue_id:</span>
</span><span id="PDBIO-1043"><a href="#PDBIO-1043"><span class="linenos">1043</span></a>    <span class="c1">#                 current_residue_id = residue_id</span>
</span><span id="PDBIO-1044"><a href="#PDBIO-1044"><span class="linenos">1044</span></a>    <span class="c1">#                 if record_name == &quot;ATOM&quot;:</span>
</span><span id="PDBIO-1045"><a href="#PDBIO-1045"><span class="linenos">1045</span></a>    <span class="c1">#                     # if entry[&quot;res_name&quot;] in ResidueTemplate.VALID_DNA_RESIDUES:</span>
</span><span id="PDBIO-1046"><a href="#PDBIO-1046"><span class="linenos">1046</span></a>    <span class="c1">#                     #     current_residue = current_chain.add_dna_residue(</span>
</span><span id="PDBIO-1047"><a href="#PDBIO-1047"><span class="linenos">1047</span></a>    <span class="c1">#                     #         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-1048"><a href="#PDBIO-1048"><span class="linenos">1048</span></a>    <span class="c1">#                     #         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-1049"><a href="#PDBIO-1049"><span class="linenos">1049</span></a>    <span class="c1">#                     #         insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-1050"><a href="#PDBIO-1050"><span class="linenos">1050</span></a>    <span class="c1">#                     #     )</span>
</span><span id="PDBIO-1051"><a href="#PDBIO-1051"><span class="linenos">1051</span></a>    <span class="c1">#                     # else:</span>
</span><span id="PDBIO-1052"><a href="#PDBIO-1052"><span class="linenos">1052</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="PDBIO-1053"><a href="#PDBIO-1053"><span class="linenos">1053</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-1054"><a href="#PDBIO-1054"><span class="linenos">1054</span></a>    <span class="c1">#                         pdb_sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-1055"><a href="#PDBIO-1055"><span class="linenos">1055</span></a>    <span class="c1">#                         pdb_insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="PDBIO-1056"><a href="#PDBIO-1056"><span class="linenos">1056</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="PDBIO-1057"><a href="#PDBIO-1057"><span class="linenos">1057</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="PDBIO-1058"><a href="#PDBIO-1058"><span class="linenos">1058</span></a>    <span class="c1">#                 elif record_name == &quot;HETATM&quot;:</span>
</span><span id="PDBIO-1059"><a href="#PDBIO-1059"><span class="linenos">1059</span></a>    <span class="c1">#                     current_residue = Residue(</span>
</span><span id="PDBIO-1060"><a href="#PDBIO-1060"><span class="linenos">1060</span></a>    <span class="c1">#                         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-1061"><a href="#PDBIO-1061"><span class="linenos">1061</span></a>    <span class="c1">#                         pdb_sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-1062"><a href="#PDBIO-1062"><span class="linenos">1062</span></a>    <span class="c1">#                         pdb_insertion_code=entry[&quot;icode&quot;],</span>
</span><span id="PDBIO-1063"><a href="#PDBIO-1063"><span class="linenos">1063</span></a>    <span class="c1">#                         chain=current_chain)</span>
</span><span id="PDBIO-1064"><a href="#PDBIO-1064"><span class="linenos">1064</span></a>    <span class="c1">#                     current_chain.add_residue(current_residue)</span>
</span><span id="PDBIO-1065"><a href="#PDBIO-1065"><span class="linenos">1065</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1066"><a href="#PDBIO-1066"><span class="linenos">1066</span></a>    <span class="c1">#                     # current_residue = current_chain.add_het_residue(</span>
</span><span id="PDBIO-1067"><a href="#PDBIO-1067"><span class="linenos">1067</span></a>    <span class="c1">#                     #     residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO-1068"><a href="#PDBIO-1068"><span class="linenos">1068</span></a>    <span class="c1">#                     #     sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO-1069"><a href="#PDBIO-1069"><span class="linenos">1069</span></a>    <span class="c1">#                     #     insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO-1070"><a href="#PDBIO-1070"><span class="linenos">1070</span></a>    <span class="c1">#                     # )</span>
</span><span id="PDBIO-1071"><a href="#PDBIO-1071"><span class="linenos">1071</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1072"><a href="#PDBIO-1072"><span class="linenos">1072</span></a>    <span class="c1">#             # Temporary fix need to see if anything breaks (For Evo eg. 2HH1 -&gt; HH12)</span>
</span><span id="PDBIO-1073"><a href="#PDBIO-1073"><span class="linenos">1073</span></a>    <span class="c1">#             # Fix atom naming</span>
</span><span id="PDBIO-1074"><a href="#PDBIO-1074"><span class="linenos">1074</span></a>    <span class="c1">#             if entry[&quot;atom_name&quot;][0].isnumeric():</span>
</span><span id="PDBIO-1075"><a href="#PDBIO-1075"><span class="linenos">1075</span></a>    <span class="c1">#                 entry[&quot;atom_name&quot;] = entry[&quot;atom_name&quot;][1:] + entry[&quot;atom_name&quot;][0]</span>
</span><span id="PDBIO-1076"><a href="#PDBIO-1076"><span class="linenos">1076</span></a>    <span class="c1">#                 if entry[&quot;element&quot;] != &quot;H&quot;:</span>
</span><span id="PDBIO-1077"><a href="#PDBIO-1077"><span class="linenos">1077</span></a>    <span class="c1">#                     print(0)</span>
</span><span id="PDBIO-1078"><a href="#PDBIO-1078"><span class="linenos">1078</span></a>    <span class="c1">#                 if entry[&quot;atom_name&quot;][0] == &quot;H&quot;:</span>
</span><span id="PDBIO-1079"><a href="#PDBIO-1079"><span class="linenos">1079</span></a>    <span class="c1">#                     entry[&quot;element&quot;] = &quot;H&quot;</span>
</span><span id="PDBIO-1080"><a href="#PDBIO-1080"><span class="linenos">1080</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1081"><a href="#PDBIO-1081"><span class="linenos">1081</span></a>    <span class="c1">#             # Add the atom to the residue</span>
</span><span id="PDBIO-1082"><a href="#PDBIO-1082"><span class="linenos">1082</span></a>    <span class="c1">#             if entry[&quot;alt_loc&quot;] == &quot;&quot;:</span>
</span><span id="PDBIO-1083"><a href="#PDBIO-1083"><span class="linenos">1083</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;]</span>
</span><span id="PDBIO-1084"><a href="#PDBIO-1084"><span class="linenos">1084</span></a>    <span class="c1">#             else:</span>
</span><span id="PDBIO-1085"><a href="#PDBIO-1085"><span class="linenos">1085</span></a>    <span class="c1">#                 atom_id = entry[&quot;atom_name&quot;] + &quot;_&quot; + entry[&quot;alt_loc&quot;]</span>
</span><span id="PDBIO-1086"><a href="#PDBIO-1086"><span class="linenos">1086</span></a>    <span class="c1">#             atom = Atom(</span>
</span><span id="PDBIO-1087"><a href="#PDBIO-1087"><span class="linenos">1087</span></a>    <span class="c1">#                 element=entry[&quot;element&quot;],</span>
</span><span id="PDBIO-1088"><a href="#PDBIO-1088"><span class="linenos">1088</span></a>    <span class="c1">#                 atom_type=entry[&quot;atom_name&quot;],</span>
</span><span id="PDBIO-1089"><a href="#PDBIO-1089"><span class="linenos">1089</span></a>    <span class="c1">#                 x=entry[&quot;x&quot;],</span>
</span><span id="PDBIO-1090"><a href="#PDBIO-1090"><span class="linenos">1090</span></a>    <span class="c1">#                 y=entry[&quot;y&quot;],</span>
</span><span id="PDBIO-1091"><a href="#PDBIO-1091"><span class="linenos">1091</span></a>    <span class="c1">#                 z=entry[&quot;z&quot;],</span>
</span><span id="PDBIO-1092"><a href="#PDBIO-1092"><span class="linenos">1092</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1093"><a href="#PDBIO-1093"><span class="linenos">1093</span></a>    <span class="c1">#                 pdb_serial=entry[&quot;serial&quot;],</span>
</span><span id="PDBIO-1094"><a href="#PDBIO-1094"><span class="linenos">1094</span></a>    <span class="c1">#                 pdb_alt_loc=entry[&quot;alt_loc&quot;],</span>
</span><span id="PDBIO-1095"><a href="#PDBIO-1095"><span class="linenos">1095</span></a>    <span class="c1">#                 pdb_occupancy=entry[&quot;occupancy&quot;],</span>
</span><span id="PDBIO-1096"><a href="#PDBIO-1096"><span class="linenos">1096</span></a>    <span class="c1">#                 pdb_temp_factor=entry[&quot;temp_factor&quot;],</span>
</span><span id="PDBIO-1097"><a href="#PDBIO-1097"><span class="linenos">1097</span></a>    <span class="c1">#                 pdb_assigned_charge=entry[&quot;assigned_charge&quot;],</span>
</span><span id="PDBIO-1098"><a href="#PDBIO-1098"><span class="linenos">1098</span></a>    <span class="c1">#                 pqr_calculated_charge=entry[&quot;calculated_charge&quot;],</span>
</span><span id="PDBIO-1099"><a href="#PDBIO-1099"><span class="linenos">1099</span></a>    <span class="c1">#                 pqr_radius=entry[&quot;radius&quot;],</span>
</span><span id="PDBIO-1100"><a href="#PDBIO-1100"><span class="linenos">1100</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1101"><a href="#PDBIO-1101"><span class="linenos">1101</span></a>    <span class="c1">#                 is_hetero=(record_name == &quot;HETATM&quot;),</span>
</span><span id="PDBIO-1102"><a href="#PDBIO-1102"><span class="linenos">1102</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1103"><a href="#PDBIO-1103"><span class="linenos">1103</span></a>    <span class="c1">#                 residue=current_residue</span>
</span><span id="PDBIO-1104"><a href="#PDBIO-1104"><span class="linenos">1104</span></a>    <span class="c1">#             )</span>
</span><span id="PDBIO-1105"><a href="#PDBIO-1105"><span class="linenos">1105</span></a>    <span class="c1">#             current_residue.add_atom(atom_id, atom)</span>
</span><span id="PDBIO-1106"><a href="#PDBIO-1106"><span class="linenos">1106</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1107"><a href="#PDBIO-1107"><span class="linenos">1107</span></a>    <span class="c1">#     # if seqres:</span>
</span><span id="PDBIO-1108"><a href="#PDBIO-1108"><span class="linenos">1108</span></a>    <span class="c1">#     #     for chain_id in seqres:</span>
</span><span id="PDBIO-1109"><a href="#PDBIO-1109"><span class="linenos">1109</span></a>    <span class="c1">#     #         if seqres[chain_id]:</span>
</span><span id="PDBIO-1110"><a href="#PDBIO-1110"><span class="linenos">1110</span></a>    <span class="c1">#     #             protein.chains[chain_id].sequence = seqres[chain_id]</span>
</span><span id="PDBIO-1111"><a href="#PDBIO-1111"><span class="linenos">1111</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1112"><a href="#PDBIO-1112"><span class="linenos">1112</span></a>    <span class="c1">#     # Housekeeping</span>
</span><span id="PDBIO-1113"><a href="#PDBIO-1113"><span class="linenos">1113</span></a>    <span class="c1">#     protein.set_residue_indexing()</span>
</span><span id="PDBIO-1114"><a href="#PDBIO-1114"><span class="linenos">1114</span></a>    <span class="c1">#</span>
</span><span id="PDBIO-1115"><a href="#PDBIO-1115"><span class="linenos">1115</span></a>    <span class="c1">#     return protein</span>
</span></pre></div>


    

                            <div id="PDBIO.parse_pdb_model_line" class="classattr">
                                        <input id="PDBIO.parse_pdb_model_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_pdb_model_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.parse_pdb_model_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.parse_pdb_model_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.parse_pdb_model_line-49"><a href="#PDBIO.parse_pdb_model_line-49"><span class="linenos">49</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.parse_pdb_model_line-50"><a href="#PDBIO.parse_pdb_model_line-50"><span class="linenos">50</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO.parse_pdb_model_line-51"><a href="#PDBIO.parse_pdb_model_line-51"><span class="linenos">51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_model_line-52"><a href="#PDBIO.parse_pdb_model_line-52"><span class="linenos">52</span></a><span class="sd">        Parse a MODEL (start model) line from a PDB file.</span>
</span><span id="PDBIO.parse_pdb_model_line-53"><a href="#PDBIO.parse_pdb_model_line-53"><span class="linenos">53</span></a>
</span><span id="PDBIO.parse_pdb_model_line-54"><a href="#PDBIO.parse_pdb_model_line-54"><span class="linenos">54</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD          DEFINITION</span>
</span><span id="PDBIO.parse_pdb_model_line-55"><a href="#PDBIO.parse_pdb_model_line-55"><span class="linenos">55</span></a><span class="sd">        ---------------------------------------------------------------------------------------</span>
</span><span id="PDBIO.parse_pdb_model_line-56"><a href="#PDBIO.parse_pdb_model_line-56"><span class="linenos">56</span></a><span class="sd">         1 -  6        Record name   &quot;MODEL &quot;</span>
</span><span id="PDBIO.parse_pdb_model_line-57"><a href="#PDBIO.parse_pdb_model_line-57"><span class="linenos">57</span></a><span class="sd">        11 - 14        Integer       serial         Model serial number.</span>
</span><span id="PDBIO.parse_pdb_model_line-58"><a href="#PDBIO.parse_pdb_model_line-58"><span class="linenos">58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_model_line-59"><a href="#PDBIO.parse_pdb_model_line-59"><span class="linenos">59</span></a>        <span class="n">pdb_model_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.parse_pdb_model_line-60"><a href="#PDBIO.parse_pdb_model_line-60"><span class="linenos">60</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_model_line-61"><a href="#PDBIO.parse_pdb_model_line-61"><span class="linenos">61</span></a>            <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span>
</span><span id="PDBIO.parse_pdb_model_line-62"><a href="#PDBIO.parse_pdb_model_line-62"><span class="linenos">62</span></a>        <span class="p">}</span>
</span><span id="PDBIO.parse_pdb_model_line-63"><a href="#PDBIO.parse_pdb_model_line-63"><span class="linenos">63</span></a>
</span><span id="PDBIO.parse_pdb_model_line-64"><a href="#PDBIO.parse_pdb_model_line-64"><span class="linenos">64</span></a>        <span class="k">return</span> <span class="n">pdb_model_dict</span>
</span></pre></div>


            <div class="docstring"><p>Parse a MODEL (start model) line from a PDB file.</p>

<h2 id="columns-data-type-field-definition">COLUMNS        DATA  TYPE    FIELD          DEFINITION</h2>

<p>1 -  6        Record name   "MODEL "
11 - 14        Integer       serial         Model serial number.</p>
</div>


                            </div>
                            <div id="PDBIO.create_pdb_model_line" class="classattr">
                                        <input id="PDBIO.create_pdb_model_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_pdb_model_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">serial</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.create_pdb_model_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.create_pdb_model_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.create_pdb_model_line-66"><a href="#PDBIO.create_pdb_model_line-66"><span class="linenos">66</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.create_pdb_model_line-67"><a href="#PDBIO.create_pdb_model_line-67"><span class="linenos">67</span></a>    <span class="k">def</span> <span class="nf">create_pdb_model_line</span><span class="p">(</span><span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PDBIO.create_pdb_model_line-68"><a href="#PDBIO.create_pdb_model_line-68"><span class="linenos">68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_model_line-69"><a href="#PDBIO.create_pdb_model_line-69"><span class="linenos">69</span></a><span class="sd">        Creates a MODEL (start model) line for a PDB file.</span>
</span><span id="PDBIO.create_pdb_model_line-70"><a href="#PDBIO.create_pdb_model_line-70"><span class="linenos">70</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_model_line-71"><a href="#PDBIO.create_pdb_model_line-71"><span class="linenos">71</span></a>        <span class="k">return</span> <span class="s2">&quot;MODEL&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a MODEL (start model) line for a PDB file.</p>
</div>


                            </div>
                            <div id="PDBIO.parse_pdb_end_model_line" class="classattr">
                                        <input id="PDBIO.parse_pdb_end_model_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_pdb_end_model_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.parse_pdb_end_model_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.parse_pdb_end_model_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.parse_pdb_end_model_line-77"><a href="#PDBIO.parse_pdb_end_model_line-77"><span class="linenos">77</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.parse_pdb_end_model_line-78"><a href="#PDBIO.parse_pdb_end_model_line-78"><span class="linenos">78</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_end_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO.parse_pdb_end_model_line-79"><a href="#PDBIO.parse_pdb_end_model_line-79"><span class="linenos">79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_end_model_line-80"><a href="#PDBIO.parse_pdb_end_model_line-80"><span class="linenos">80</span></a><span class="sd">        Parse a ENDMDL (end model) line from a PDB file.</span>
</span><span id="PDBIO.parse_pdb_end_model_line-81"><a href="#PDBIO.parse_pdb_end_model_line-81"><span class="linenos">81</span></a>
</span><span id="PDBIO.parse_pdb_end_model_line-82"><a href="#PDBIO.parse_pdb_end_model_line-82"><span class="linenos">82</span></a><span class="sd">        COLUMNS       DATA  TYPE     FIELD        DEFINITION</span>
</span><span id="PDBIO.parse_pdb_end_model_line-83"><a href="#PDBIO.parse_pdb_end_model_line-83"><span class="linenos">83</span></a><span class="sd">        ------------------------------------------------------------------</span>
</span><span id="PDBIO.parse_pdb_end_model_line-84"><a href="#PDBIO.parse_pdb_end_model_line-84"><span class="linenos">84</span></a><span class="sd">        1 - 6         Record name   &quot;ENDMDL&quot;</span>
</span><span id="PDBIO.parse_pdb_end_model_line-85"><a href="#PDBIO.parse_pdb_end_model_line-85"><span class="linenos">85</span></a>
</span><span id="PDBIO.parse_pdb_end_model_line-86"><a href="#PDBIO.parse_pdb_end_model_line-86"><span class="linenos">86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_end_model_line-87"><a href="#PDBIO.parse_pdb_end_model_line-87"><span class="linenos">87</span></a>        <span class="n">pdb_end_model_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.parse_pdb_end_model_line-88"><a href="#PDBIO.parse_pdb_end_model_line-88"><span class="linenos">88</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ENDMDL&quot;</span>
</span><span id="PDBIO.parse_pdb_end_model_line-89"><a href="#PDBIO.parse_pdb_end_model_line-89"><span class="linenos">89</span></a>        <span class="p">}</span>
</span><span id="PDBIO.parse_pdb_end_model_line-90"><a href="#PDBIO.parse_pdb_end_model_line-90"><span class="linenos">90</span></a>
</span><span id="PDBIO.parse_pdb_end_model_line-91"><a href="#PDBIO.parse_pdb_end_model_line-91"><span class="linenos">91</span></a>        <span class="k">return</span> <span class="n">pdb_end_model_dict</span>
</span></pre></div>


            <div class="docstring"><p>Parse a ENDMDL (end model) line from a PDB file.</p>

<h2 id="columns-data-type-field-definition">COLUMNS       DATA  TYPE     FIELD        DEFINITION</h2>

<p>1 - 6         Record name   "ENDMDL"</p>
</div>


                            </div>
                            <div id="PDBIO.create_pdb_end_model_line" class="classattr">
                                        <input id="PDBIO.create_pdb_end_model_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_pdb_end_model_line</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.create_pdb_end_model_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.create_pdb_end_model_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.create_pdb_end_model_line-93"><a href="#PDBIO.create_pdb_end_model_line-93"><span class="linenos">93</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.create_pdb_end_model_line-94"><a href="#PDBIO.create_pdb_end_model_line-94"><span class="linenos">94</span></a>    <span class="k">def</span> <span class="nf">create_pdb_end_model_line</span><span class="p">():</span>
</span><span id="PDBIO.create_pdb_end_model_line-95"><a href="#PDBIO.create_pdb_end_model_line-95"><span class="linenos">95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_end_model_line-96"><a href="#PDBIO.create_pdb_end_model_line-96"><span class="linenos">96</span></a><span class="sd">        Creates a ENDMDL (end model) line for a PDB file.</span>
</span><span id="PDBIO.create_pdb_end_model_line-97"><a href="#PDBIO.create_pdb_end_model_line-97"><span class="linenos">97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_end_model_line-98"><a href="#PDBIO.create_pdb_end_model_line-98"><span class="linenos">98</span></a>        <span class="k">return</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a ENDMDL (end model) line for a PDB file.</p>
</div>


                            </div>
                            <div id="PDBIO.create_pdb_master_line" class="classattr">
                                        <input id="PDBIO.create_pdb_master_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_pdb_master_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">num_atoms</span>,</span><span class="param">	<span class="n">num_hetatoms</span>,</span><span class="param">	<span class="n">num_ter</span>,</span><span class="param">	<span class="n">num_remark</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">num_het</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">num_helix</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">num_sheet</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">num_site</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">num_trans</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">num_conect</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">num_seqres</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.create_pdb_master_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.create_pdb_master_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.create_pdb_master_line-104"><a href="#PDBIO.create_pdb_master_line-104"><span class="linenos">104</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.create_pdb_master_line-105"><a href="#PDBIO.create_pdb_master_line-105"><span class="linenos">105</span></a>    <span class="k">def</span> <span class="nf">create_pdb_master_line</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_hetatoms</span><span class="p">,</span> <span class="n">num_ter</span><span class="p">,</span> <span class="n">num_remark</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_het</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_helix</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_sheet</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="PDBIO.create_pdb_master_line-106"><a href="#PDBIO.create_pdb_master_line-106"><span class="linenos">106</span></a>                               <span class="n">num_site</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_trans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_conect</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_seqres</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="PDBIO.create_pdb_master_line-107"><a href="#PDBIO.create_pdb_master_line-107"><span class="linenos">107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_master_line-108"><a href="#PDBIO.create_pdb_master_line-108"><span class="linenos">108</span></a><span class="sd">        Creates a MASTER (recordkeeping) line for a PDB file.</span>
</span><span id="PDBIO.create_pdb_master_line-109"><a href="#PDBIO.create_pdb_master_line-109"><span class="linenos">109</span></a>
</span><span id="PDBIO.create_pdb_master_line-110"><a href="#PDBIO.create_pdb_master_line-110"><span class="linenos">110</span></a><span class="sd">        COLUMNS         DATA TYPE     FIELD          DEFINITION</span>
</span><span id="PDBIO.create_pdb_master_line-111"><a href="#PDBIO.create_pdb_master_line-111"><span class="linenos">111</span></a><span class="sd">        ----------------------------------------------------------------------------------</span>
</span><span id="PDBIO.create_pdb_master_line-112"><a href="#PDBIO.create_pdb_master_line-112"><span class="linenos">112</span></a><span class="sd">         1 -  6         Record name   &quot;MASTER&quot;</span>
</span><span id="PDBIO.create_pdb_master_line-113"><a href="#PDBIO.create_pdb_master_line-113"><span class="linenos">113</span></a><span class="sd">        11 - 15         Integer       numRemark      Number of REMARK records</span>
</span><span id="PDBIO.create_pdb_master_line-114"><a href="#PDBIO.create_pdb_master_line-114"><span class="linenos">114</span></a><span class="sd">        16 - 20         Integer       &quot;0&quot;</span>
</span><span id="PDBIO.create_pdb_master_line-115"><a href="#PDBIO.create_pdb_master_line-115"><span class="linenos">115</span></a><span class="sd">        21 - 25         Integer       numHet         Number of HET records</span>
</span><span id="PDBIO.create_pdb_master_line-116"><a href="#PDBIO.create_pdb_master_line-116"><span class="linenos">116</span></a><span class="sd">        26 - 30         Integer       numHelix       Number of HELIX records</span>
</span><span id="PDBIO.create_pdb_master_line-117"><a href="#PDBIO.create_pdb_master_line-117"><span class="linenos">117</span></a><span class="sd">        31 - 35         Integer       numSheet       Number of SHEET records</span>
</span><span id="PDBIO.create_pdb_master_line-118"><a href="#PDBIO.create_pdb_master_line-118"><span class="linenos">118</span></a><span class="sd">        36 - 40         Integer       numTurn        deprecated</span>
</span><span id="PDBIO.create_pdb_master_line-119"><a href="#PDBIO.create_pdb_master_line-119"><span class="linenos">119</span></a><span class="sd">        41 - 45         Integer       numSite        Number of SITE records</span>
</span><span id="PDBIO.create_pdb_master_line-120"><a href="#PDBIO.create_pdb_master_line-120"><span class="linenos">120</span></a><span class="sd">        46 - 50         Integer       numXform       Number of coordinate transformation</span>
</span><span id="PDBIO.create_pdb_master_line-121"><a href="#PDBIO.create_pdb_master_line-121"><span class="linenos">121</span></a><span class="sd">                                                     records  (ORIGX+SCALE+MTRIX)</span>
</span><span id="PDBIO.create_pdb_master_line-122"><a href="#PDBIO.create_pdb_master_line-122"><span class="linenos">122</span></a><span class="sd">        51 - 55         Integer       numCoord       Number of atomic coordinate records</span>
</span><span id="PDBIO.create_pdb_master_line-123"><a href="#PDBIO.create_pdb_master_line-123"><span class="linenos">123</span></a><span class="sd">                                                     records (ATOM+HETATM)</span>
</span><span id="PDBIO.create_pdb_master_line-124"><a href="#PDBIO.create_pdb_master_line-124"><span class="linenos">124</span></a><span class="sd">        56 - 60         Integer       numTer         Number of TER records</span>
</span><span id="PDBIO.create_pdb_master_line-125"><a href="#PDBIO.create_pdb_master_line-125"><span class="linenos">125</span></a><span class="sd">        61 - 65         Integer       numConect      Number of CONECT records</span>
</span><span id="PDBIO.create_pdb_master_line-126"><a href="#PDBIO.create_pdb_master_line-126"><span class="linenos">126</span></a><span class="sd">        66 - 70         Integer       numSeq         Number of SEQRES records</span>
</span><span id="PDBIO.create_pdb_master_line-127"><a href="#PDBIO.create_pdb_master_line-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_master_line-128"><a href="#PDBIO.create_pdb_master_line-128"><span class="linenos">128</span></a>
</span><span id="PDBIO.create_pdb_master_line-129"><a href="#PDBIO.create_pdb_master_line-129"><span class="linenos">129</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PDBIO.create_pdb_master_line-130"><a href="#PDBIO.create_pdb_master_line-130"><span class="linenos">130</span></a>            <span class="s2">&quot;MASTER&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-131"><a href="#PDBIO.create_pdb_master_line-131"><span class="linenos">131</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_remark</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-132"><a href="#PDBIO.create_pdb_master_line-132"><span class="linenos">132</span></a>            <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-133"><a href="#PDBIO.create_pdb_master_line-133"><span class="linenos">133</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_het</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-134"><a href="#PDBIO.create_pdb_master_line-134"><span class="linenos">134</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_helix</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-135"><a href="#PDBIO.create_pdb_master_line-135"><span class="linenos">135</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_sheet</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-136"><a href="#PDBIO.create_pdb_master_line-136"><span class="linenos">136</span></a>            <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-137"><a href="#PDBIO.create_pdb_master_line-137"><span class="linenos">137</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_site</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-138"><a href="#PDBIO.create_pdb_master_line-138"><span class="linenos">138</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_trans</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-139"><a href="#PDBIO.create_pdb_master_line-139"><span class="linenos">139</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_atoms</span> <span class="o">+</span> <span class="n">num_hetatoms</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-140"><a href="#PDBIO.create_pdb_master_line-140"><span class="linenos">140</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_ter</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-141"><a href="#PDBIO.create_pdb_master_line-141"><span class="linenos">141</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_conect</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-142"><a href="#PDBIO.create_pdb_master_line-142"><span class="linenos">142</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_seqres</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="PDBIO.create_pdb_master_line-143"><a href="#PDBIO.create_pdb_master_line-143"><span class="linenos">143</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_master_line-144"><a href="#PDBIO.create_pdb_master_line-144"><span class="linenos">144</span></a>        <span class="p">]</span>
</span><span id="PDBIO.create_pdb_master_line-145"><a href="#PDBIO.create_pdb_master_line-145"><span class="linenos">145</span></a>
</span><span id="PDBIO.create_pdb_master_line-146"><a href="#PDBIO.create_pdb_master_line-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a MASTER (recordkeeping) line for a PDB file.</p>

<h2 id="columns-data-type-field-definition">COLUMNS         DATA TYPE     FIELD          DEFINITION</h2>

<p>1 -  6         Record name   "MASTER"
11 - 15         Integer       numRemark      Number of REMARK records
16 - 20         Integer       "0"
21 - 25         Integer       numHet         Number of HET records
26 - 30         Integer       numHelix       Number of HELIX records
31 - 35         Integer       numSheet       Number of SHEET records
36 - 40         Integer       numTurn        deprecated
41 - 45         Integer       numSite        Number of SITE records
46 - 50         Integer       numXform       Number of coordinate transformation
                                             records  (ORIGX+SCALE+MTRIX)
51 - 55         Integer       numCoord       Number of atomic coordinate records
                                             records (ATOM+HETATM)
56 - 60         Integer       numTer         Number of TER records
61 - 65         Integer       numConect      Number of CONECT records
66 - 70         Integer       numSeq         Number of SEQRES records</p>
</div>


                            </div>
                            <div id="PDBIO.parse_pdb_seqres_line" class="classattr">
                                        <input id="PDBIO.parse_pdb_seqres_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_pdb_seqres_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.parse_pdb_seqres_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.parse_pdb_seqres_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.parse_pdb_seqres_line-152"><a href="#PDBIO.parse_pdb_seqres_line-152"><span class="linenos">152</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.parse_pdb_seqres_line-153"><a href="#PDBIO.parse_pdb_seqres_line-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_seqres_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO.parse_pdb_seqres_line-154"><a href="#PDBIO.parse_pdb_seqres_line-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_seqres_line-155"><a href="#PDBIO.parse_pdb_seqres_line-155"><span class="linenos">155</span></a><span class="sd">        Parse a SEQRES (sequence) line from a PDB file.</span>
</span><span id="PDBIO.parse_pdb_seqres_line-156"><a href="#PDBIO.parse_pdb_seqres_line-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_seqres_line-157"><a href="#PDBIO.parse_pdb_seqres_line-157"><span class="linenos">157</span></a>        <span class="n">pdb_seqres_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.parse_pdb_seqres_line-158"><a href="#PDBIO.parse_pdb_seqres_line-158"><span class="linenos">158</span></a>            <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_seqres_line-159"><a href="#PDBIO.parse_pdb_seqres_line-159"><span class="linenos">159</span></a>            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
</span><span id="PDBIO.parse_pdb_seqres_line-160"><a href="#PDBIO.parse_pdb_seqres_line-160"><span class="linenos">160</span></a>            <span class="s2">&quot;residues&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="PDBIO.parse_pdb_seqres_line-161"><a href="#PDBIO.parse_pdb_seqres_line-161"><span class="linenos">161</span></a>        <span class="p">}</span>
</span><span id="PDBIO.parse_pdb_seqres_line-162"><a href="#PDBIO.parse_pdb_seqres_line-162"><span class="linenos">162</span></a>
</span><span id="PDBIO.parse_pdb_seqres_line-163"><a href="#PDBIO.parse_pdb_seqres_line-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="n">pdb_seqres_dict</span>
</span></pre></div>


            <div class="docstring"><p>Parse a SEQRES (sequence) line from a PDB file.</p>
</div>


                            </div>
                            <div id="PDBIO.create_seqres_line" class="classattr">
                                        <input id="PDBIO.create_seqres_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_seqres_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line_no</span>, </span><span class="param"><span class="n">chain_id</span>, </span><span class="param"><span class="n">num_residues</span>, </span><span class="param"><span class="n">residues</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.create_seqres_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.create_seqres_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.create_seqres_line-165"><a href="#PDBIO.create_seqres_line-165"><span class="linenos">165</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.create_seqres_line-166"><a href="#PDBIO.create_seqres_line-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">create_seqres_line</span><span class="p">(</span><span class="n">line_no</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">num_residues</span><span class="p">,</span> <span class="n">residues</span><span class="p">):</span>
</span><span id="PDBIO.create_seqres_line-167"><a href="#PDBIO.create_seqres_line-167"><span class="linenos">167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.create_seqres_line-168"><a href="#PDBIO.create_seqres_line-168"><span class="linenos">168</span></a><span class="sd">        Creates a SEQRES (sequence) line for a PDB file.</span>
</span><span id="PDBIO.create_seqres_line-169"><a href="#PDBIO.create_seqres_line-169"><span class="linenos">169</span></a>
</span><span id="PDBIO.create_seqres_line-170"><a href="#PDBIO.create_seqres_line-170"><span class="linenos">170</span></a><span class="sd">         1 -  6        Record name    &quot;SEQRES&quot;</span>
</span><span id="PDBIO.create_seqres_line-171"><a href="#PDBIO.create_seqres_line-171"><span class="linenos">171</span></a><span class="sd">         8 - 10        Integer        serNum       Serial number of the SEQRES record for  the</span>
</span><span id="PDBIO.create_seqres_line-172"><a href="#PDBIO.create_seqres_line-172"><span class="linenos">172</span></a><span class="sd">                                                   current  chain. Starts at 1 and increments</span>
</span><span id="PDBIO.create_seqres_line-173"><a href="#PDBIO.create_seqres_line-173"><span class="linenos">173</span></a><span class="sd">                                                   by one  each line. Reset to 1 for each chain.</span>
</span><span id="PDBIO.create_seqres_line-174"><a href="#PDBIO.create_seqres_line-174"><span class="linenos">174</span></a><span class="sd">        12             Character      chainID      Chain identifier. This may be any single</span>
</span><span id="PDBIO.create_seqres_line-175"><a href="#PDBIO.create_seqres_line-175"><span class="linenos">175</span></a><span class="sd">                                                   legal  character, including a blank which</span>
</span><span id="PDBIO.create_seqres_line-176"><a href="#PDBIO.create_seqres_line-176"><span class="linenos">176</span></a><span class="sd">                                                   is used if there is only one chain.</span>
</span><span id="PDBIO.create_seqres_line-177"><a href="#PDBIO.create_seqres_line-177"><span class="linenos">177</span></a><span class="sd">        14 - 17        Integer        numRes       Number of residues in the chain.</span>
</span><span id="PDBIO.create_seqres_line-178"><a href="#PDBIO.create_seqres_line-178"><span class="linenos">178</span></a><span class="sd">                                                   This  value is repeated on every record.</span>
</span><span id="PDBIO.create_seqres_line-179"><a href="#PDBIO.create_seqres_line-179"><span class="linenos">179</span></a><span class="sd">        20 - 22        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-180"><a href="#PDBIO.create_seqres_line-180"><span class="linenos">180</span></a><span class="sd">        24 - 26        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-181"><a href="#PDBIO.create_seqres_line-181"><span class="linenos">181</span></a><span class="sd">        28 - 30        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-182"><a href="#PDBIO.create_seqres_line-182"><span class="linenos">182</span></a><span class="sd">        32 - 34        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-183"><a href="#PDBIO.create_seqres_line-183"><span class="linenos">183</span></a><span class="sd">        36 - 38        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-184"><a href="#PDBIO.create_seqres_line-184"><span class="linenos">184</span></a><span class="sd">        40 - 42        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-185"><a href="#PDBIO.create_seqres_line-185"><span class="linenos">185</span></a><span class="sd">        44 - 46        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-186"><a href="#PDBIO.create_seqres_line-186"><span class="linenos">186</span></a><span class="sd">        48 - 50        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-187"><a href="#PDBIO.create_seqres_line-187"><span class="linenos">187</span></a><span class="sd">        52 - 54        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-188"><a href="#PDBIO.create_seqres_line-188"><span class="linenos">188</span></a><span class="sd">        56 - 58        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-189"><a href="#PDBIO.create_seqres_line-189"><span class="linenos">189</span></a><span class="sd">        60 - 62        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-190"><a href="#PDBIO.create_seqres_line-190"><span class="linenos">190</span></a><span class="sd">        64 - 66        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-191"><a href="#PDBIO.create_seqres_line-191"><span class="linenos">191</span></a><span class="sd">        68 - 70        Residue name   resName      Residue name.</span>
</span><span id="PDBIO.create_seqres_line-192"><a href="#PDBIO.create_seqres_line-192"><span class="linenos">192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.create_seqres_line-193"><a href="#PDBIO.create_seqres_line-193"><span class="linenos">193</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PDBIO.create_seqres_line-194"><a href="#PDBIO.create_seqres_line-194"><span class="linenos">194</span></a>            <span class="s2">&quot;SEQRES &quot;</span><span class="p">,</span>
</span><span id="PDBIO.create_seqres_line-195"><a href="#PDBIO.create_seqres_line-195"><span class="linenos">195</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">line_no</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
</span><span id="PDBIO.create_seqres_line-196"><a href="#PDBIO.create_seqres_line-196"><span class="linenos">196</span></a>            <span class="n">chain_id</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
</span><span id="PDBIO.create_seqres_line-197"><a href="#PDBIO.create_seqres_line-197"><span class="linenos">197</span></a>            <span class="nb">str</span><span class="p">(</span><span class="n">num_residues</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span>
</span><span id="PDBIO.create_seqres_line-198"><a href="#PDBIO.create_seqres_line-198"><span class="linenos">198</span></a>        <span class="p">]</span>
</span><span id="PDBIO.create_seqres_line-199"><a href="#PDBIO.create_seqres_line-199"><span class="linenos">199</span></a>        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
</span><span id="PDBIO.create_seqres_line-200"><a href="#PDBIO.create_seqres_line-200"><span class="linenos">200</span></a>            <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residue</span><span class="p">[</span><span class="s2">&quot;residue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span id="PDBIO.create_seqres_line-201"><a href="#PDBIO.create_seqres_line-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a SEQRES (sequence) line for a PDB file.</p>

<p>1 -  6        Record name    "SEQRES"
 8 - 10        Integer        serNum       Serial number of the SEQRES record for  the
                                           current  chain. Starts at 1 and increments
                                           by one  each line. Reset to 1 for each chain.
12             Character      chainID      Chain identifier. This may be any single
                                           legal  character, including a blank which
                                           is used if there is only one chain.
14 - 17        Integer        numRes       Number of residues in the chain.
                                           This  value is repeated on every record.
20 - 22        Residue name   resName      Residue name.
24 - 26        Residue name   resName      Residue name.
28 - 30        Residue name   resName      Residue name.
32 - 34        Residue name   resName      Residue name.
36 - 38        Residue name   resName      Residue name.
40 - 42        Residue name   resName      Residue name.
44 - 46        Residue name   resName      Residue name.
48 - 50        Residue name   resName      Residue name.
52 - 54        Residue name   resName      Residue name.
56 - 58        Residue name   resName      Residue name.
60 - 62        Residue name   resName      Residue name.
64 - 66        Residue name   resName      Residue name.
68 - 70        Residue name   resName      Residue name.</p>
</div>


                            </div>
                            <div id="PDBIO.parse_pdb_ter_line" class="classattr">
                                        <input id="PDBIO.parse_pdb_ter_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_pdb_ter_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.parse_pdb_ter_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.parse_pdb_ter_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.parse_pdb_ter_line-207"><a href="#PDBIO.parse_pdb_ter_line-207"><span class="linenos">207</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.parse_pdb_ter_line-208"><a href="#PDBIO.parse_pdb_ter_line-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_ter_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PDBIO.parse_pdb_ter_line-209"><a href="#PDBIO.parse_pdb_ter_line-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_ter_line-210"><a href="#PDBIO.parse_pdb_ter_line-210"><span class="linenos">210</span></a><span class="sd">        Parse a TER (chain termination) line from a PDB file.</span>
</span><span id="PDBIO.parse_pdb_ter_line-211"><a href="#PDBIO.parse_pdb_ter_line-211"><span class="linenos">211</span></a>
</span><span id="PDBIO.parse_pdb_ter_line-212"><a href="#PDBIO.parse_pdb_ter_line-212"><span class="linenos">212</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD           DEFINITION</span>
</span><span id="PDBIO.parse_pdb_ter_line-213"><a href="#PDBIO.parse_pdb_ter_line-213"><span class="linenos">213</span></a><span class="sd">        -------------------------------------------------------------------------</span>
</span><span id="PDBIO.parse_pdb_ter_line-214"><a href="#PDBIO.parse_pdb_ter_line-214"><span class="linenos">214</span></a><span class="sd">         1 -  6        Record name   &quot;TER   &quot;</span>
</span><span id="PDBIO.parse_pdb_ter_line-215"><a href="#PDBIO.parse_pdb_ter_line-215"><span class="linenos">215</span></a><span class="sd">         7 - 11        Integer       serial          Serial number.</span>
</span><span id="PDBIO.parse_pdb_ter_line-216"><a href="#PDBIO.parse_pdb_ter_line-216"><span class="linenos">216</span></a><span class="sd">        18 - 20        Residue name  resName         Residue name.</span>
</span><span id="PDBIO.parse_pdb_ter_line-217"><a href="#PDBIO.parse_pdb_ter_line-217"><span class="linenos">217</span></a><span class="sd">        22             Character     chainID         Chain identifier.</span>
</span><span id="PDBIO.parse_pdb_ter_line-218"><a href="#PDBIO.parse_pdb_ter_line-218"><span class="linenos">218</span></a><span class="sd">        23 - 26        Integer       resSeq          Residue sequence number.</span>
</span><span id="PDBIO.parse_pdb_ter_line-219"><a href="#PDBIO.parse_pdb_ter_line-219"><span class="linenos">219</span></a><span class="sd">        27             AChar         iCode           Insertion code.</span>
</span><span id="PDBIO.parse_pdb_ter_line-220"><a href="#PDBIO.parse_pdb_ter_line-220"><span class="linenos">220</span></a>
</span><span id="PDBIO.parse_pdb_ter_line-221"><a href="#PDBIO.parse_pdb_ter_line-221"><span class="linenos">221</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_ter_line-222"><a href="#PDBIO.parse_pdb_ter_line-222"><span class="linenos">222</span></a>        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_ter_line-223"><a href="#PDBIO.parse_pdb_ter_line-223"><span class="linenos">223</span></a>            <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.parse_pdb_ter_line-224"><a href="#PDBIO.parse_pdb_ter_line-224"><span class="linenos">224</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TER&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_ter_line-225"><a href="#PDBIO.parse_pdb_ter_line-225"><span class="linenos">225</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_ter_line-226"><a href="#PDBIO.parse_pdb_ter_line-226"><span class="linenos">226</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_ter_line-227"><a href="#PDBIO.parse_pdb_ter_line-227"><span class="linenos">227</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_ter_line-228"><a href="#PDBIO.parse_pdb_ter_line-228"><span class="linenos">228</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_ter_line-229"><a href="#PDBIO.parse_pdb_ter_line-229"><span class="linenos">229</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_ter_line-230"><a href="#PDBIO.parse_pdb_ter_line-230"><span class="linenos">230</span></a>            <span class="p">}</span>
</span><span id="PDBIO.parse_pdb_ter_line-231"><a href="#PDBIO.parse_pdb_ter_line-231"><span class="linenos">231</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_ter_line-232"><a href="#PDBIO.parse_pdb_ter_line-232"><span class="linenos">232</span></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_ter_line-233"><a href="#PDBIO.parse_pdb_ter_line-233"><span class="linenos">233</span></a>            <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.parse_pdb_ter_line-234"><a href="#PDBIO.parse_pdb_ter_line-234"><span class="linenos">234</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TER&quot;</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_ter_line-235"><a href="#PDBIO.parse_pdb_ter_line-235"><span class="linenos">235</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span>
</span><span id="PDBIO.parse_pdb_ter_line-236"><a href="#PDBIO.parse_pdb_ter_line-236"><span class="linenos">236</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">21</span><span class="p">],</span>
</span><span id="PDBIO.parse_pdb_ter_line-237"><a href="#PDBIO.parse_pdb_ter_line-237"><span class="linenos">237</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span>
</span><span id="PDBIO.parse_pdb_ter_line-238"><a href="#PDBIO.parse_pdb_ter_line-238"><span class="linenos">238</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">],</span>
</span><span id="PDBIO.parse_pdb_ter_line-239"><a href="#PDBIO.parse_pdb_ter_line-239"><span class="linenos">239</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
</span><span id="PDBIO.parse_pdb_ter_line-240"><a href="#PDBIO.parse_pdb_ter_line-240"><span class="linenos">240</span></a>            <span class="p">}</span>
</span><span id="PDBIO.parse_pdb_ter_line-241"><a href="#PDBIO.parse_pdb_ter_line-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="n">pdb_ter_dict</span>
</span></pre></div>


            <div class="docstring"><p>Parse a TER (chain termination) line from a PDB file.</p>

<h2 id="columns-data-type-field-definition">COLUMNS        DATA  TYPE    FIELD           DEFINITION</h2>

<p>1 -  6        Record name   "TER   "
 7 - 11        Integer       serial          Serial number.
18 - 20        Residue name  resName         Residue name.
22             Character     chainID         Chain identifier.
23 - 26        Integer       resSeq          Residue sequence number.
27             AChar         iCode           Insertion code.</p>
</div>


                            </div>
                            <div id="PDBIO.create_pdb_ter_line" class="classattr">
                                        <input id="PDBIO.create_pdb_ter_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_pdb_ter_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">serial</span>, </span><span class="param"><span class="n">res_name</span>, </span><span class="param"><span class="n">chain_id</span>, </span><span class="param"><span class="n">res_seq</span>, </span><span class="param"><span class="n">icode</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.create_pdb_ter_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.create_pdb_ter_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.create_pdb_ter_line-243"><a href="#PDBIO.create_pdb_ter_line-243"><span class="linenos">243</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.create_pdb_ter_line-244"><a href="#PDBIO.create_pdb_ter_line-244"><span class="linenos">244</span></a>    <span class="k">def</span> <span class="nf">create_pdb_ter_line</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span> <span class="n">res_name</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">res_seq</span><span class="p">,</span> <span class="n">icode</span><span class="p">):</span>
</span><span id="PDBIO.create_pdb_ter_line-245"><a href="#PDBIO.create_pdb_ter_line-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_ter_line-246"><a href="#PDBIO.create_pdb_ter_line-246"><span class="linenos">246</span></a><span class="sd">        Creates a TER (chain termination) line for a PDB file.</span>
</span><span id="PDBIO.create_pdb_ter_line-247"><a href="#PDBIO.create_pdb_ter_line-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_ter_line-248"><a href="#PDBIO.create_pdb_ter_line-248"><span class="linenos">248</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;TER&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_ter_line-249"><a href="#PDBIO.create_pdb_ter_line-249"><span class="linenos">249</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;      &quot;</span>
</span><span id="PDBIO.create_pdb_ter_line-250"><a href="#PDBIO.create_pdb_ter_line-250"><span class="linenos">250</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">res_name</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO.create_pdb_ter_line-251"><a href="#PDBIO.create_pdb_ter_line-251"><span class="linenos">251</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">chain_id</span>
</span><span id="PDBIO.create_pdb_ter_line-252"><a href="#PDBIO.create_pdb_ter_line-252"><span class="linenos">252</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">res_seq</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_ter_line-253"><a href="#PDBIO.create_pdb_ter_line-253"><span class="linenos">253</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">icode</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_ter_line-254"><a href="#PDBIO.create_pdb_ter_line-254"><span class="linenos">254</span></a>
</span><span id="PDBIO.create_pdb_ter_line-255"><a href="#PDBIO.create_pdb_ter_line-255"><span class="linenos">255</span></a>        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a TER (chain termination) line for a PDB file.</p>
</div>


                            </div>
                            <div id="PDBIO.parse_pdb_atom_line" class="classattr">
                                        <input id="PDBIO.parse_pdb_atom_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_pdb_atom_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span>, </span><span class="param"><span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.parse_pdb_atom_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.parse_pdb_atom_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.parse_pdb_atom_line-261"><a href="#PDBIO.parse_pdb_atom_line-261"><span class="linenos">261</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.parse_pdb_atom_line-262"><a href="#PDBIO.parse_pdb_atom_line-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="PDBIO.parse_pdb_atom_line-263"><a href="#PDBIO.parse_pdb_atom_line-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_atom_line-264"><a href="#PDBIO.parse_pdb_atom_line-264"><span class="linenos">264</span></a><span class="sd">        Parse a ATOM (individual atom) or HETATM (hetero atom) line from a PDB file.</span>
</span><span id="PDBIO.parse_pdb_atom_line-265"><a href="#PDBIO.parse_pdb_atom_line-265"><span class="linenos">265</span></a>
</span><span id="PDBIO.parse_pdb_atom_line-266"><a href="#PDBIO.parse_pdb_atom_line-266"><span class="linenos">266</span></a><span class="sd">        COLUMNS        DATA  TYPE    FIELD        DEFINITION</span>
</span><span id="PDBIO.parse_pdb_atom_line-267"><a href="#PDBIO.parse_pdb_atom_line-267"><span class="linenos">267</span></a><span class="sd">        -------------------------------------------------------------------------------------</span>
</span><span id="PDBIO.parse_pdb_atom_line-268"><a href="#PDBIO.parse_pdb_atom_line-268"><span class="linenos">268</span></a><span class="sd">         1 -  6        Record name   &quot;ATOM  &quot;</span>
</span><span id="PDBIO.parse_pdb_atom_line-269"><a href="#PDBIO.parse_pdb_atom_line-269"><span class="linenos">269</span></a><span class="sd">         7 - 11        Integer       serial       Atom  serial number.</span>
</span><span id="PDBIO.parse_pdb_atom_line-270"><a href="#PDBIO.parse_pdb_atom_line-270"><span class="linenos">270</span></a><span class="sd">        13 - 16        Atom          name         Atom name.</span>
</span><span id="PDBIO.parse_pdb_atom_line-271"><a href="#PDBIO.parse_pdb_atom_line-271"><span class="linenos">271</span></a><span class="sd">        17             Character     altLoc       Alternate location indicator.</span>
</span><span id="PDBIO.parse_pdb_atom_line-272"><a href="#PDBIO.parse_pdb_atom_line-272"><span class="linenos">272</span></a><span class="sd">        18 - 20        Residue name  resName      Residue name.</span>
</span><span id="PDBIO.parse_pdb_atom_line-273"><a href="#PDBIO.parse_pdb_atom_line-273"><span class="linenos">273</span></a><span class="sd">        22             Character     chainID      Chain identifier.</span>
</span><span id="PDBIO.parse_pdb_atom_line-274"><a href="#PDBIO.parse_pdb_atom_line-274"><span class="linenos">274</span></a><span class="sd">        23 - 26        Integer       resSeq       Residue sequence number.</span>
</span><span id="PDBIO.parse_pdb_atom_line-275"><a href="#PDBIO.parse_pdb_atom_line-275"><span class="linenos">275</span></a><span class="sd">        27             AChar         iCode        Code for insertion of residues.</span>
</span><span id="PDBIO.parse_pdb_atom_line-276"><a href="#PDBIO.parse_pdb_atom_line-276"><span class="linenos">276</span></a><span class="sd">        31 - 38        Real(8.3)     x            Orthogonal coordinates for X in Angstroms.</span>
</span><span id="PDBIO.parse_pdb_atom_line-277"><a href="#PDBIO.parse_pdb_atom_line-277"><span class="linenos">277</span></a><span class="sd">        39 - 46        Real(8.3)     y            Orthogonal coordinates for Y in Angstroms.</span>
</span><span id="PDBIO.parse_pdb_atom_line-278"><a href="#PDBIO.parse_pdb_atom_line-278"><span class="linenos">278</span></a><span class="sd">        47 - 54        Real(8.3)     z            Orthogonal coordinates for Z in Angstroms.</span>
</span><span id="PDBIO.parse_pdb_atom_line-279"><a href="#PDBIO.parse_pdb_atom_line-279"><span class="linenos">279</span></a><span class="sd">        55 - 60        Real(6.2)     occupancy    Occupancy.</span>
</span><span id="PDBIO.parse_pdb_atom_line-280"><a href="#PDBIO.parse_pdb_atom_line-280"><span class="linenos">280</span></a><span class="sd">        61 - 66        Real(6.2)     tempFactor   Temperature  factor.</span>
</span><span id="PDBIO.parse_pdb_atom_line-281"><a href="#PDBIO.parse_pdb_atom_line-281"><span class="linenos">281</span></a><span class="sd">        77 - 78        LString(2)    element      Element symbol, right-justified.</span>
</span><span id="PDBIO.parse_pdb_atom_line-282"><a href="#PDBIO.parse_pdb_atom_line-282"><span class="linenos">282</span></a><span class="sd">        79 - 80        LString(2)    charge       Charge  on the atom.`</span>
</span><span id="PDBIO.parse_pdb_atom_line-283"><a href="#PDBIO.parse_pdb_atom_line-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_atom_line-284"><a href="#PDBIO.parse_pdb_atom_line-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_atom_line-285"><a href="#PDBIO.parse_pdb_atom_line-285"><span class="linenos">285</span></a>            <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.parse_pdb_atom_line-286"><a href="#PDBIO.parse_pdb_atom_line-286"><span class="linenos">286</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-287"><a href="#PDBIO.parse_pdb_atom_line-287"><span class="linenos">287</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-288"><a href="#PDBIO.parse_pdb_atom_line-288"><span class="linenos">288</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO.parse_pdb_atom_line-289"><a href="#PDBIO.parse_pdb_atom_line-289"><span class="linenos">289</span></a>                <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-290"><a href="#PDBIO.parse_pdb_atom_line-290"><span class="linenos">290</span></a>                <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-291"><a href="#PDBIO.parse_pdb_atom_line-291"><span class="linenos">291</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-292"><a href="#PDBIO.parse_pdb_atom_line-292"><span class="linenos">292</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO.parse_pdb_atom_line-293"><a href="#PDBIO.parse_pdb_atom_line-293"><span class="linenos">293</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-294"><a href="#PDBIO.parse_pdb_atom_line-294"><span class="linenos">294</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-295"><a href="#PDBIO.parse_pdb_atom_line-295"><span class="linenos">295</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-296"><a href="#PDBIO.parse_pdb_atom_line-296"><span class="linenos">296</span></a>                <span class="c1"># 3x Open space</span>
</span><span id="PDBIO.parse_pdb_atom_line-297"><a href="#PDBIO.parse_pdb_atom_line-297"><span class="linenos">297</span></a>                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-298"><a href="#PDBIO.parse_pdb_atom_line-298"><span class="linenos">298</span></a>                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-299"><a href="#PDBIO.parse_pdb_atom_line-299"><span class="linenos">299</span></a>                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-300"><a href="#PDBIO.parse_pdb_atom_line-300"><span class="linenos">300</span></a>                <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">60</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-301"><a href="#PDBIO.parse_pdb_atom_line-301"><span class="linenos">301</span></a>                <span class="c1"># &quot;temp_factor&quot;: None,</span>
</span><span id="PDBIO.parse_pdb_atom_line-302"><a href="#PDBIO.parse_pdb_atom_line-302"><span class="linenos">302</span></a>                <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">66</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-303"><a href="#PDBIO.parse_pdb_atom_line-303"><span class="linenos">303</span></a>                <span class="c1"># 66 - 75?</span>
</span><span id="PDBIO.parse_pdb_atom_line-304"><a href="#PDBIO.parse_pdb_atom_line-304"><span class="linenos">304</span></a>                <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-305"><a href="#PDBIO.parse_pdb_atom_line-305"><span class="linenos">305</span></a>                <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">78</span><span class="p">:</span><span class="mi">80</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-306"><a href="#PDBIO.parse_pdb_atom_line-306"><span class="linenos">306</span></a>                <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_atom_line-307"><a href="#PDBIO.parse_pdb_atom_line-307"><span class="linenos">307</span></a>                <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="PDBIO.parse_pdb_atom_line-308"><a href="#PDBIO.parse_pdb_atom_line-308"><span class="linenos">308</span></a>            <span class="p">}</span>
</span><span id="PDBIO.parse_pdb_atom_line-309"><a href="#PDBIO.parse_pdb_atom_line-309"><span class="linenos">309</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_atom_line-310"><a href="#PDBIO.parse_pdb_atom_line-310"><span class="linenos">310</span></a>            <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.parse_pdb_atom_line-311"><a href="#PDBIO.parse_pdb_atom_line-311"><span class="linenos">311</span></a>                <span class="s2">&quot;record_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-312"><a href="#PDBIO.parse_pdb_atom_line-312"><span class="linenos">312</span></a>                <span class="s2">&quot;serial&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-313"><a href="#PDBIO.parse_pdb_atom_line-313"><span class="linenos">313</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO.parse_pdb_atom_line-314"><a href="#PDBIO.parse_pdb_atom_line-314"><span class="linenos">314</span></a>                <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-315"><a href="#PDBIO.parse_pdb_atom_line-315"><span class="linenos">315</span></a>                <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-316"><a href="#PDBIO.parse_pdb_atom_line-316"><span class="linenos">316</span></a>                <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-317"><a href="#PDBIO.parse_pdb_atom_line-317"><span class="linenos">317</span></a>                <span class="c1"># Open space</span>
</span><span id="PDBIO.parse_pdb_atom_line-318"><a href="#PDBIO.parse_pdb_atom_line-318"><span class="linenos">318</span></a>                <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-319"><a href="#PDBIO.parse_pdb_atom_line-319"><span class="linenos">319</span></a>                <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-320"><a href="#PDBIO.parse_pdb_atom_line-320"><span class="linenos">320</span></a>                <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-321"><a href="#PDBIO.parse_pdb_atom_line-321"><span class="linenos">321</span></a>                <span class="c1"># 3x Open space</span>
</span><span id="PDBIO.parse_pdb_atom_line-322"><a href="#PDBIO.parse_pdb_atom_line-322"><span class="linenos">322</span></a>                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-323"><a href="#PDBIO.parse_pdb_atom_line-323"><span class="linenos">323</span></a>                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-324"><a href="#PDBIO.parse_pdb_atom_line-324"><span class="linenos">324</span></a>                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-325"><a href="#PDBIO.parse_pdb_atom_line-325"><span class="linenos">325</span></a>
</span><span id="PDBIO.parse_pdb_atom_line-326"><a href="#PDBIO.parse_pdb_atom_line-326"><span class="linenos">326</span></a>                <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_atom_line-327"><a href="#PDBIO.parse_pdb_atom_line-327"><span class="linenos">327</span></a>                <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_atom_line-328"><a href="#PDBIO.parse_pdb_atom_line-328"><span class="linenos">328</span></a>
</span><span id="PDBIO.parse_pdb_atom_line-329"><a href="#PDBIO.parse_pdb_atom_line-329"><span class="linenos">329</span></a>                <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="PDBIO.parse_pdb_atom_line-330"><a href="#PDBIO.parse_pdb_atom_line-330"><span class="linenos">330</span></a>                <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PDBIO.parse_pdb_atom_line-331"><a href="#PDBIO.parse_pdb_atom_line-331"><span class="linenos">331</span></a>                <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">62</span><span class="p">]),</span>
</span><span id="PDBIO.parse_pdb_atom_line-332"><a href="#PDBIO.parse_pdb_atom_line-332"><span class="linenos">332</span></a>                <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">62</span><span class="p">:</span><span class="mi">70</span><span class="p">])</span>
</span><span id="PDBIO.parse_pdb_atom_line-333"><a href="#PDBIO.parse_pdb_atom_line-333"><span class="linenos">333</span></a>            <span class="p">}</span>
</span><span id="PDBIO.parse_pdb_atom_line-334"><a href="#PDBIO.parse_pdb_atom_line-334"><span class="linenos">334</span></a>        <span class="k">return</span> <span class="n">pdb_atom_dict</span>
</span></pre></div>


            <div class="docstring"><p>Parse a ATOM (individual atom) or HETATM (hetero atom) line from a PDB file.</p>

<h2 id="columns-data-type-field-definition">COLUMNS        DATA  TYPE    FIELD        DEFINITION</h2>

<p>1 -  6        Record name   "ATOM  "
 7 - 11        Integer       serial       Atom  serial number.
13 - 16        Atom          name         Atom name.
17             Character     altLoc       Alternate location indicator.
18 - 20        Residue name  resName      Residue name.
22             Character     chainID      Chain identifier.
23 - 26        Integer       resSeq       Residue sequence number.
27             AChar         iCode        Code for insertion of residues.
31 - 38        Real(8.3)     x            Orthogonal coordinates for X in Angstroms.
39 - 46        Real(8.3)     y            Orthogonal coordinates for Y in Angstroms.
47 - 54        Real(8.3)     z            Orthogonal coordinates for Z in Angstroms.
55 - 60        Real(6.2)     occupancy    Occupancy.
61 - 66        Real(6.2)     tempFactor   Temperature  factor.
77 - 78        LString(2)    element      Element symbol, right-justified.
79 - 80        LString(2)    charge       Charge  on the atom.`</p>
</div>


                            </div>
                            <div id="PDBIO.create_pdb_atom_line" class="classattr">
                                        <input id="PDBIO.create_pdb_atom_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_pdb_atom_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span>, </span><span class="param"><span class="n">serial</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">record_name</span><span class="o">=</span><span class="s1">&#39;ATOM&#39;</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="PDBIO.create_pdb_atom_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.create_pdb_atom_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.create_pdb_atom_line-336"><a href="#PDBIO.create_pdb_atom_line-336"><span class="linenos">336</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.create_pdb_atom_line-337"><a href="#PDBIO.create_pdb_atom_line-337"><span class="linenos">337</span></a>    <span class="k">def</span> <span class="nf">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;ATOM&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PDBIO.create_pdb_atom_line-338"><a href="#PDBIO.create_pdb_atom_line-338"><span class="linenos">338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_atom_line-339"><a href="#PDBIO.create_pdb_atom_line-339"><span class="linenos">339</span></a><span class="sd">        Creates a ATOM or HETATM line for a PDB file.</span>
</span><span id="PDBIO.create_pdb_atom_line-340"><a href="#PDBIO.create_pdb_atom_line-340"><span class="linenos">340</span></a>
</span><span id="PDBIO.create_pdb_atom_line-341"><a href="#PDBIO.create_pdb_atom_line-341"><span class="linenos">341</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO.create_pdb_atom_line-342"><a href="#PDBIO.create_pdb_atom_line-342"><span class="linenos">342</span></a><span class="sd">            atom (Dict): The atom information.</span>
</span><span id="PDBIO.create_pdb_atom_line-343"><a href="#PDBIO.create_pdb_atom_line-343"><span class="linenos">343</span></a><span class="sd">            serial (int): The serial number of the atom.</span>
</span><span id="PDBIO.create_pdb_atom_line-344"><a href="#PDBIO.create_pdb_atom_line-344"><span class="linenos">344</span></a><span class="sd">            record_name (str): The record name, should be ATOM or HETATM.</span>
</span><span id="PDBIO.create_pdb_atom_line-345"><a href="#PDBIO.create_pdb_atom_line-345"><span class="linenos">345</span></a>
</span><span id="PDBIO.create_pdb_atom_line-346"><a href="#PDBIO.create_pdb_atom_line-346"><span class="linenos">346</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO.create_pdb_atom_line-347"><a href="#PDBIO.create_pdb_atom_line-347"><span class="linenos">347</span></a><span class="sd">            str: The ATOM or HETATM line.</span>
</span><span id="PDBIO.create_pdb_atom_line-348"><a href="#PDBIO.create_pdb_atom_line-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pdb_atom_line-349"><a href="#PDBIO.create_pdb_atom_line-349"><span class="linenos">349</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-350"><a href="#PDBIO.create_pdb_atom_line-350"><span class="linenos">350</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO.create_pdb_atom_line-351"><a href="#PDBIO.create_pdb_atom_line-351"><span class="linenos">351</span></a>
</span><span id="PDBIO.create_pdb_atom_line-352"><a href="#PDBIO.create_pdb_atom_line-352"><span class="linenos">352</span></a>        <span class="c1"># The PDB spec says that if the element has two characters, e.g. Fe (iron)</span>
</span><span id="PDBIO.create_pdb_atom_line-353"><a href="#PDBIO.create_pdb_atom_line-353"><span class="linenos">353</span></a>        <span class="c1"># it should start at the position 13, otherwise it should start at position 14.</span>
</span><span id="PDBIO.create_pdb_atom_line-354"><a href="#PDBIO.create_pdb_atom_line-354"><span class="linenos">354</span></a>        <span class="c1"># This seems a little problematic, as some atoms could use 4 characters</span>
</span><span id="PDBIO.create_pdb_atom_line-355"><a href="#PDBIO.create_pdb_atom_line-355"><span class="linenos">355</span></a>        <span class="c1"># for example, HG11. The implementation here is consistent with observed PDBs</span>
</span><span id="PDBIO.create_pdb_atom_line-356"><a href="#PDBIO.create_pdb_atom_line-356"><span class="linenos">356</span></a>        <span class="c1"># from the RCSB.</span>
</span><span id="PDBIO.create_pdb_atom_line-357"><a href="#PDBIO.create_pdb_atom_line-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="PDBIO.create_pdb_atom_line-358"><a href="#PDBIO.create_pdb_atom_line-358"><span class="linenos">358</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-359"><a href="#PDBIO.create_pdb_atom_line-359"><span class="linenos">359</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO.create_pdb_atom_line-360"><a href="#PDBIO.create_pdb_atom_line-360"><span class="linenos">360</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-361"><a href="#PDBIO.create_pdb_atom_line-361"><span class="linenos">361</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-362"><a href="#PDBIO.create_pdb_atom_line-362"><span class="linenos">362</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO.create_pdb_atom_line-363"><a href="#PDBIO.create_pdb_atom_line-363"><span class="linenos">363</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO.create_pdb_atom_line-364"><a href="#PDBIO.create_pdb_atom_line-364"><span class="linenos">364</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-365"><a href="#PDBIO.create_pdb_atom_line-365"><span class="linenos">365</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
</span><span id="PDBIO.create_pdb_atom_line-366"><a href="#PDBIO.create_pdb_atom_line-366"><span class="linenos">366</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pdb_atom_line-367"><a href="#PDBIO.create_pdb_atom_line-367"><span class="linenos">367</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pdb_atom_line-368"><a href="#PDBIO.create_pdb_atom_line-368"><span class="linenos">368</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pdb_atom_line-369"><a href="#PDBIO.create_pdb_atom_line-369"><span class="linenos">369</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">1.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pdb_atom_line-370"><a href="#PDBIO.create_pdb_atom_line-370"><span class="linenos">370</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pdb_atom_line-371"><a href="#PDBIO.create_pdb_atom_line-371"><span class="linenos">371</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-372"><a href="#PDBIO.create_pdb_atom_line-372"><span class="linenos">372</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-373"><a href="#PDBIO.create_pdb_atom_line-373"><span class="linenos">373</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PDBIO.create_pdb_atom_line-374"><a href="#PDBIO.create_pdb_atom_line-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Creates a ATOM or HETATM line for a PDB file.</p>

<p>Args:
    atom (Dict): The atom information.
    serial (int): The serial number of the atom.
    record_name (str): The record name, should be ATOM or HETATM.</p>

<p>Returns:
    str: The ATOM or HETATM line.</p>
</div>


                            </div>
                            <div id="PDBIO.create_pqr_atom_line" class="classattr">
                                        <input id="PDBIO.create_pqr_atom_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_pqr_atom_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span>, </span><span class="param"><span class="n">serial</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">record_name</span><span class="o">=</span><span class="s1">&#39;ATOM&#39;</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="PDBIO.create_pqr_atom_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.create_pqr_atom_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.create_pqr_atom_line-376"><a href="#PDBIO.create_pqr_atom_line-376"><span class="linenos">376</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.create_pqr_atom_line-377"><a href="#PDBIO.create_pqr_atom_line-377"><span class="linenos">377</span></a>    <span class="k">def</span> <span class="nf">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;ATOM&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PDBIO.create_pqr_atom_line-378"><a href="#PDBIO.create_pqr_atom_line-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pqr_atom_line-379"><a href="#PDBIO.create_pqr_atom_line-379"><span class="linenos">379</span></a><span class="sd">        Creates a ATOM or HETATM line for a PQR file.</span>
</span><span id="PDBIO.create_pqr_atom_line-380"><a href="#PDBIO.create_pqr_atom_line-380"><span class="linenos">380</span></a>
</span><span id="PDBIO.create_pqr_atom_line-381"><a href="#PDBIO.create_pqr_atom_line-381"><span class="linenos">381</span></a><span class="sd">        The PQR line is similar to the PDB ATOM line, but with additional fields</span>
</span><span id="PDBIO.create_pqr_atom_line-382"><a href="#PDBIO.create_pqr_atom_line-382"><span class="linenos">382</span></a><span class="sd">        for atomic charge and radius. The occupancy, temperature factor,</span>
</span><span id="PDBIO.create_pqr_atom_line-383"><a href="#PDBIO.create_pqr_atom_line-383"><span class="linenos">383</span></a><span class="sd">        charge and element fields from the PDB file are not used in the PQR file.</span>
</span><span id="PDBIO.create_pqr_atom_line-384"><a href="#PDBIO.create_pqr_atom_line-384"><span class="linenos">384</span></a>
</span><span id="PDBIO.create_pqr_atom_line-385"><a href="#PDBIO.create_pqr_atom_line-385"><span class="linenos">385</span></a><span class="sd">        See: https://pdb2pqr.readthedocs.io/en/latest/formats/pqr.html</span>
</span><span id="PDBIO.create_pqr_atom_line-386"><a href="#PDBIO.create_pqr_atom_line-386"><span class="linenos">386</span></a><span class="sd">        The order of fields in a PQR file is as follows:</span>
</span><span id="PDBIO.create_pqr_atom_line-387"><a href="#PDBIO.create_pqr_atom_line-387"><span class="linenos">387</span></a><span class="sd">        Field_name Atom_number Atom_name Residue_name Chain_ID Residue_number</span>
</span><span id="PDBIO.create_pqr_atom_line-388"><a href="#PDBIO.create_pqr_atom_line-388"><span class="linenos">388</span></a><span class="sd">        X Y Z Charge Radius</span>
</span><span id="PDBIO.create_pqr_atom_line-389"><a href="#PDBIO.create_pqr_atom_line-389"><span class="linenos">389</span></a>
</span><span id="PDBIO.create_pqr_atom_line-390"><a href="#PDBIO.create_pqr_atom_line-390"><span class="linenos">390</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO.create_pqr_atom_line-391"><a href="#PDBIO.create_pqr_atom_line-391"><span class="linenos">391</span></a><span class="sd">            atom (Dict): The atom information.</span>
</span><span id="PDBIO.create_pqr_atom_line-392"><a href="#PDBIO.create_pqr_atom_line-392"><span class="linenos">392</span></a><span class="sd">            serial (int): The serial number of the atom.</span>
</span><span id="PDBIO.create_pqr_atom_line-393"><a href="#PDBIO.create_pqr_atom_line-393"><span class="linenos">393</span></a><span class="sd">            record_name (str): The record name, should be ATOM or HETATM.</span>
</span><span id="PDBIO.create_pqr_atom_line-394"><a href="#PDBIO.create_pqr_atom_line-394"><span class="linenos">394</span></a>
</span><span id="PDBIO.create_pqr_atom_line-395"><a href="#PDBIO.create_pqr_atom_line-395"><span class="linenos">395</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO.create_pqr_atom_line-396"><a href="#PDBIO.create_pqr_atom_line-396"><span class="linenos">396</span></a><span class="sd">            str: The PQR ATOM or HETATM line.</span>
</span><span id="PDBIO.create_pqr_atom_line-397"><a href="#PDBIO.create_pqr_atom_line-397"><span class="linenos">397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.create_pqr_atom_line-398"><a href="#PDBIO.create_pqr_atom_line-398"><span class="linenos">398</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="PDBIO.create_pqr_atom_line-399"><a href="#PDBIO.create_pqr_atom_line-399"><span class="linenos">399</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO.create_pqr_atom_line-400"><a href="#PDBIO.create_pqr_atom_line-400"><span class="linenos">400</span></a>
</span><span id="PDBIO.create_pqr_atom_line-401"><a href="#PDBIO.create_pqr_atom_line-401"><span class="linenos">401</span></a>        <span class="c1"># The PDB spec says that if the element has two characters, e.g. Fe (iron)</span>
</span><span id="PDBIO.create_pqr_atom_line-402"><a href="#PDBIO.create_pqr_atom_line-402"><span class="linenos">402</span></a>        <span class="c1"># it should start at the position 13, otherwise it should start at position 14.</span>
</span><span id="PDBIO.create_pqr_atom_line-403"><a href="#PDBIO.create_pqr_atom_line-403"><span class="linenos">403</span></a>        <span class="c1"># This seems a little problematic, as some atoms could use 4 characters</span>
</span><span id="PDBIO.create_pqr_atom_line-404"><a href="#PDBIO.create_pqr_atom_line-404"><span class="linenos">404</span></a>        <span class="c1"># for example, HG11. The implementation here is consistent with observed PDBs</span>
</span><span id="PDBIO.create_pqr_atom_line-405"><a href="#PDBIO.create_pqr_atom_line-405"><span class="linenos">405</span></a>        <span class="c1"># from the RCSB.</span>
</span><span id="PDBIO.create_pqr_atom_line-406"><a href="#PDBIO.create_pqr_atom_line-406"><span class="linenos">406</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="PDBIO.create_pqr_atom_line-407"><a href="#PDBIO.create_pqr_atom_line-407"><span class="linenos">407</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO.create_pqr_atom_line-408"><a href="#PDBIO.create_pqr_atom_line-408"><span class="linenos">408</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO.create_pqr_atom_line-409"><a href="#PDBIO.create_pqr_atom_line-409"><span class="linenos">409</span></a>            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="PDBIO.create_pqr_atom_line-410"><a href="#PDBIO.create_pqr_atom_line-410"><span class="linenos">410</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PDBIO.create_pqr_atom_line-411"><a href="#PDBIO.create_pqr_atom_line-411"><span class="linenos">411</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
</span><span id="PDBIO.create_pqr_atom_line-412"><a href="#PDBIO.create_pqr_atom_line-412"><span class="linenos">412</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO.create_pqr_atom_line-413"><a href="#PDBIO.create_pqr_atom_line-413"><span class="linenos">413</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="PDBIO.create_pqr_atom_line-414"><a href="#PDBIO.create_pqr_atom_line-414"><span class="linenos">414</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
</span><span id="PDBIO.create_pqr_atom_line-415"><a href="#PDBIO.create_pqr_atom_line-415"><span class="linenos">415</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pqr_atom_line-416"><a href="#PDBIO.create_pqr_atom_line-416"><span class="linenos">416</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pqr_atom_line-417"><a href="#PDBIO.create_pqr_atom_line-417"><span class="linenos">417</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pqr_atom_line-418"><a href="#PDBIO.create_pqr_atom_line-418"><span class="linenos">418</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">8.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pqr_atom_line-419"><a href="#PDBIO.create_pqr_atom_line-419"><span class="linenos">419</span></a>        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mf">0.0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">atom</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">7.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="PDBIO.create_pqr_atom_line-420"><a href="#PDBIO.create_pqr_atom_line-420"><span class="linenos">420</span></a>        <span class="c1"># text += f&#39;{1.0 if atom[&quot;occupancy&quot;] is None else atom[&quot;occupancy&quot;]:6.2f}&#39;</span>
</span><span id="PDBIO.create_pqr_atom_line-421"><a href="#PDBIO.create_pqr_atom_line-421"><span class="linenos">421</span></a>        <span class="c1"># text += f&#39;{0.0 if atom[&quot;temp_factor&quot;] is None else atom[&quot;temp_factor&quot;]:6.2f}&#39;</span>
</span><span id="PDBIO.create_pqr_atom_line-422"><a href="#PDBIO.create_pqr_atom_line-422"><span class="linenos">422</span></a>        <span class="c1"># text += &quot;&quot;.ljust(10)</span>
</span><span id="PDBIO.create_pqr_atom_line-423"><a href="#PDBIO.create_pqr_atom_line-423"><span class="linenos">423</span></a>        <span class="c1"># text += atom[&quot;element&quot;].rjust(2)</span>
</span><span id="PDBIO.create_pqr_atom_line-424"><a href="#PDBIO.create_pqr_atom_line-424"><span class="linenos">424</span></a>        <span class="c1"># text += (&quot;&quot; if atom[&quot;charge&quot;] is None else atom[&quot;charge&quot;]).rjust(2)</span>
</span><span id="PDBIO.create_pqr_atom_line-425"><a href="#PDBIO.create_pqr_atom_line-425"><span class="linenos">425</span></a>
</span><span id="PDBIO.create_pqr_atom_line-426"><a href="#PDBIO.create_pqr_atom_line-426"><span class="linenos">426</span></a>        <span class="k">return</span> <span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Creates a ATOM or HETATM line for a PQR file.</p>

<p>The PQR line is similar to the PDB ATOM line, but with additional fields
for atomic charge and radius. The occupancy, temperature factor,
charge and element fields from the PDB file are not used in the PQR file.</p>

<p>See: <a href="https://pdb2pqr.readthedocs.io/en/latest/formats/pqr.html">https://pdb2pqr.readthedocs.io/en/latest/formats/pqr.html</a>
The order of fields in a PQR file is as follows:
Field_name Atom_number Atom_name Residue_name Chain_ID Residue_number
X Y Z Charge Radius</p>

<p>Args:
    atom (Dict): The atom information.
    serial (int): The serial number of the atom.
    record_name (str): The record name, should be ATOM or HETATM.</p>

<p>Returns:
    str: The PQR ATOM or HETATM line.</p>
</div>


                            </div>
                            <div id="PDBIO.parse_pdb_entries_from_string" class="classattr">
                                        <input id="PDBIO.parse_pdb_entries_from_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_pdb_entries_from_string</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.parse_pdb_entries_from_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.parse_pdb_entries_from_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.parse_pdb_entries_from_string-432"><a href="#PDBIO.parse_pdb_entries_from_string-432"><span class="linenos">432</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-433"><a href="#PDBIO.parse_pdb_entries_from_string-433"><span class="linenos">433</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-434"><a href="#PDBIO.parse_pdb_entries_from_string-434"><span class="linenos">434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-435"><a href="#PDBIO.parse_pdb_entries_from_string-435"><span class="linenos">435</span></a><span class="sd">        Parse a PDB file in string format into a list of entries.</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-436"><a href="#PDBIO.parse_pdb_entries_from_string-436"><span class="linenos">436</span></a>
</span><span id="PDBIO.parse_pdb_entries_from_string-437"><a href="#PDBIO.parse_pdb_entries_from_string-437"><span class="linenos">437</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-438"><a href="#PDBIO.parse_pdb_entries_from_string-438"><span class="linenos">438</span></a><span class="sd">            pdb_string (str): The PDB file as a string.</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-439"><a href="#PDBIO.parse_pdb_entries_from_string-439"><span class="linenos">439</span></a><span class="sd">            is_pqr_format (bool): If the file is in PQR format.</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-440"><a href="#PDBIO.parse_pdb_entries_from_string-440"><span class="linenos">440</span></a>
</span><span id="PDBIO.parse_pdb_entries_from_string-441"><a href="#PDBIO.parse_pdb_entries_from_string-441"><span class="linenos">441</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-442"><a href="#PDBIO.parse_pdb_entries_from_string-442"><span class="linenos">442</span></a><span class="sd">            List[Dict]: A list of parsed entries.</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-443"><a href="#PDBIO.parse_pdb_entries_from_string-443"><span class="linenos">443</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-444"><a href="#PDBIO.parse_pdb_entries_from_string-444"><span class="linenos">444</span></a>
</span><span id="PDBIO.parse_pdb_entries_from_string-445"><a href="#PDBIO.parse_pdb_entries_from_string-445"><span class="linenos">445</span></a>        <span class="c1"># Split the string into lines</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-446"><a href="#PDBIO.parse_pdb_entries_from_string-446"><span class="linenos">446</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">pdb_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-447"><a href="#PDBIO.parse_pdb_entries_from_string-447"><span class="linenos">447</span></a>
</span><span id="PDBIO.parse_pdb_entries_from_string-448"><a href="#PDBIO.parse_pdb_entries_from_string-448"><span class="linenos">448</span></a>        <span class="c1"># Parse every line into dictionary information</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-449"><a href="#PDBIO.parse_pdb_entries_from_string-449"><span class="linenos">449</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-450"><a href="#PDBIO.parse_pdb_entries_from_string-450"><span class="linenos">450</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-451"><a href="#PDBIO.parse_pdb_entries_from_string-451"><span class="linenos">451</span></a>            <span class="n">record_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-452"><a href="#PDBIO.parse_pdb_entries_from_string-452"><span class="linenos">452</span></a>            <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-453"><a href="#PDBIO.parse_pdb_entries_from_string-453"><span class="linenos">453</span></a>                <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-454"><a href="#PDBIO.parse_pdb_entries_from_string-454"><span class="linenos">454</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_atom_dict</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-455"><a href="#PDBIO.parse_pdb_entries_from_string-455"><span class="linenos">455</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-456"><a href="#PDBIO.parse_pdb_entries_from_string-456"><span class="linenos">456</span></a>                <span class="n">pdb_atom_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_atom_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-457"><a href="#PDBIO.parse_pdb_entries_from_string-457"><span class="linenos">457</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_atom_dict</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-458"><a href="#PDBIO.parse_pdb_entries_from_string-458"><span class="linenos">458</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-459"><a href="#PDBIO.parse_pdb_entries_from_string-459"><span class="linenos">459</span></a>                <span class="n">pdb_ter_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_ter_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-460"><a href="#PDBIO.parse_pdb_entries_from_string-460"><span class="linenos">460</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_ter_dict</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-461"><a href="#PDBIO.parse_pdb_entries_from_string-461"><span class="linenos">461</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-462"><a href="#PDBIO.parse_pdb_entries_from_string-462"><span class="linenos">462</span></a>                <span class="n">pdb_model_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-463"><a href="#PDBIO.parse_pdb_entries_from_string-463"><span class="linenos">463</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_model_dict</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-464"><a href="#PDBIO.parse_pdb_entries_from_string-464"><span class="linenos">464</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-465"><a href="#PDBIO.parse_pdb_entries_from_string-465"><span class="linenos">465</span></a>                <span class="n">pdb_end_model_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_end_model_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-466"><a href="#PDBIO.parse_pdb_entries_from_string-466"><span class="linenos">466</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_end_model_dict</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-467"><a href="#PDBIO.parse_pdb_entries_from_string-467"><span class="linenos">467</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-468"><a href="#PDBIO.parse_pdb_entries_from_string-468"><span class="linenos">468</span></a>                <span class="n">pdb_seqres_dict</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_seqres_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-469"><a href="#PDBIO.parse_pdb_entries_from_string-469"><span class="linenos">469</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_seqres_dict</span><span class="p">)</span>
</span><span id="PDBIO.parse_pdb_entries_from_string-470"><a href="#PDBIO.parse_pdb_entries_from_string-470"><span class="linenos">470</span></a>        <span class="k">return</span> <span class="n">entries</span>
</span></pre></div>


            <div class="docstring"><p>Parse a PDB file in string format into a list of entries.</p>

<p>Args:
    pdb_string (str): The PDB file as a string.
    is_pqr_format (bool): If the file is in PQR format.</p>

<p>Returns:
    List[Dict]: A list of parsed entries.</p>
</div>


                            </div>
                            <div id="PDBIO.parse_pdb_entries" class="classattr">
                                        <input id="PDBIO.parse_pdb_entries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_pdb_entries</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PDBIO.parse_pdb_entries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.parse_pdb_entries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.parse_pdb_entries-473"><a href="#PDBIO.parse_pdb_entries-473"><span class="linenos">473</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.parse_pdb_entries-474"><a href="#PDBIO.parse_pdb_entries-474"><span class="linenos">474</span></a>    <span class="k">def</span> <span class="nf">parse_pdb_entries</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="PDBIO.parse_pdb_entries-475"><a href="#PDBIO.parse_pdb_entries-475"><span class="linenos">475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_entries-476"><a href="#PDBIO.parse_pdb_entries-476"><span class="linenos">476</span></a><span class="sd">        Parse PDB file according to the spec provided at:</span>
</span><span id="PDBIO.parse_pdb_entries-477"><a href="#PDBIO.parse_pdb_entries-477"><span class="linenos">477</span></a><span class="sd">        https://www.wwpdb.org/documentation/file-format-content/format33/sect9.html#ATOM</span>
</span><span id="PDBIO.parse_pdb_entries-478"><a href="#PDBIO.parse_pdb_entries-478"><span class="linenos">478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.parse_pdb_entries-479"><a href="#PDBIO.parse_pdb_entries-479"><span class="linenos">479</span></a>        <span class="c1"># Open the file and extract the individual lines.</span>
</span><span id="PDBIO.parse_pdb_entries-480"><a href="#PDBIO.parse_pdb_entries-480"><span class="linenos">480</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="PDBIO.parse_pdb_entries-481"><a href="#PDBIO.parse_pdb_entries-481"><span class="linenos">481</span></a>            <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="PDBIO.parse_pdb_entries-482"><a href="#PDBIO.parse_pdb_entries-482"><span class="linenos">482</span></a>
</span><span id="PDBIO.parse_pdb_entries-483"><a href="#PDBIO.parse_pdb_entries-483"><span class="linenos">483</span></a>        <span class="k">return</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parse PDB file according to the spec provided at:
<a href="https://www.wwpdb.org/documentation/file-format-content/format33/sect9.html#ATOM">https://www.wwpdb.org/documentation/file-format-content/format33/sect9.html#ATOM</a></p>
</div>


                            </div>
                            <div id="PDBIO.load_from_string" class="classattr">
                                        <input id="PDBIO.load_from_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">load_from_string</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n"><a href="../structure/protein.html#Protein">protkit.structure.protein.Protein</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PDBIO.load_from_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.load_from_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.load_from_string-485"><a href="#PDBIO.load_from_string-485"><span class="linenos">485</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.load_from_string-486"><a href="#PDBIO.load_from_string-486"><span class="linenos">486</span></a>    <span class="k">def</span> <span class="nf">load_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PDBIO.load_from_string-487"><a href="#PDBIO.load_from_string-487"><span class="linenos">487</span></a>                         <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PDBIO.load_from_string-488"><a href="#PDBIO.load_from_string-488"><span class="linenos">488</span></a>                         <span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
</span><span id="PDBIO.load_from_string-489"><a href="#PDBIO.load_from_string-489"><span class="linenos">489</span></a>        <span class="n">protein</span> <span class="o">=</span> <span class="n">Protein</span><span class="p">(</span><span class="n">pdb_id</span><span class="o">=</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-490"><a href="#PDBIO.load_from_string-490"><span class="linenos">490</span></a>        <span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO.load_from_string-491"><a href="#PDBIO.load_from_string-491"><span class="linenos">491</span></a>        <span class="n">seqres</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PDBIO.load_from_string-492"><a href="#PDBIO.load_from_string-492"><span class="linenos">492</span></a>        <span class="n">current_model</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.load_from_string-493"><a href="#PDBIO.load_from_string-493"><span class="linenos">493</span></a>        <span class="n">current_chain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chain</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.load_from_string-494"><a href="#PDBIO.load_from_string-494"><span class="linenos">494</span></a>        <span class="n">current_chain_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.load_from_string-495"><a href="#PDBIO.load_from_string-495"><span class="linenos">495</span></a>        <span class="n">current_residue</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.load_from_string-496"><a href="#PDBIO.load_from_string-496"><span class="linenos">496</span></a>        <span class="n">current_residue_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.load_from_string-497"><a href="#PDBIO.load_from_string-497"><span class="linenos">497</span></a>
</span><span id="PDBIO.load_from_string-498"><a href="#PDBIO.load_from_string-498"><span class="linenos">498</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">parse_pdb_entries_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-499"><a href="#PDBIO.load_from_string-499"><span class="linenos">499</span></a>
</span><span id="PDBIO.load_from_string-500"><a href="#PDBIO.load_from_string-500"><span class="linenos">500</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-501"><a href="#PDBIO.load_from_string-501"><span class="linenos">501</span></a>            <span class="n">record_name</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;record_name&quot;</span><span class="p">]</span>
</span><span id="PDBIO.load_from_string-502"><a href="#PDBIO.load_from_string-502"><span class="linenos">502</span></a>            <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-503"><a href="#PDBIO.load_from_string-503"><span class="linenos">503</span></a>                <span class="n">chain_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO.load_from_string-504"><a href="#PDBIO.load_from_string-504"><span class="linenos">504</span></a>                <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-505"><a href="#PDBIO.load_from_string-505"><span class="linenos">505</span></a>                    <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO.load_from_string-506"><a href="#PDBIO.load_from_string-506"><span class="linenos">506</span></a>                <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;residues&quot;</span><span class="p">])</span>
</span><span id="PDBIO.load_from_string-507"><a href="#PDBIO.load_from_string-507"><span class="linenos">507</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;MODEL&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-508"><a href="#PDBIO.load_from_string-508"><span class="linenos">508</span></a>                <span class="c1"># Usually, the MODEL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO.load_from_string-509"><a href="#PDBIO.load_from_string-509"><span class="linenos">509</span></a>                <span class="c1"># We only use the first model in a file if provided.</span>
</span><span id="PDBIO.load_from_string-510"><a href="#PDBIO.load_from_string-510"><span class="linenos">510</span></a>                <span class="c1"># There is nothing to do, so we</span>
</span><span id="PDBIO.load_from_string-511"><a href="#PDBIO.load_from_string-511"><span class="linenos">511</span></a>                <span class="k">pass</span>
</span><span id="PDBIO.load_from_string-512"><a href="#PDBIO.load_from_string-512"><span class="linenos">512</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ENDMDL&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-513"><a href="#PDBIO.load_from_string-513"><span class="linenos">513</span></a>                <span class="c1"># Usually, the ENDMDL field will only be found in structures based on NMR.</span>
</span><span id="PDBIO.load_from_string-514"><a href="#PDBIO.load_from_string-514"><span class="linenos">514</span></a>                <span class="c1"># it closes a corresponding MODEL field.</span>
</span><span id="PDBIO.load_from_string-515"><a href="#PDBIO.load_from_string-515"><span class="linenos">515</span></a>                <span class="c1"># Since the end of the model is reached, no more entries should be parsed.</span>
</span><span id="PDBIO.load_from_string-516"><a href="#PDBIO.load_from_string-516"><span class="linenos">516</span></a>                <span class="k">break</span>
</span><span id="PDBIO.load_from_string-517"><a href="#PDBIO.load_from_string-517"><span class="linenos">517</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;TER&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-518"><a href="#PDBIO.load_from_string-518"><span class="linenos">518</span></a>                <span class="c1"># The TER field terminates the current chain.</span>
</span><span id="PDBIO.load_from_string-519"><a href="#PDBIO.load_from_string-519"><span class="linenos">519</span></a>                <span class="n">current_chain</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.load_from_string-520"><a href="#PDBIO.load_from_string-520"><span class="linenos">520</span></a>                <span class="n">current_chain_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.load_from_string-521"><a href="#PDBIO.load_from_string-521"><span class="linenos">521</span></a>            <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span> <span class="ow">or</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-522"><a href="#PDBIO.load_from_string-522"><span class="linenos">522</span></a>                <span class="c1"># If we switched chains, set the chain.</span>
</span><span id="PDBIO.load_from_string-523"><a href="#PDBIO.load_from_string-523"><span class="linenos">523</span></a>                <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">current_chain_id</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-524"><a href="#PDBIO.load_from_string-524"><span class="linenos">524</span></a>                    <span class="n">current_chain_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="PDBIO.load_from_string-525"><a href="#PDBIO.load_from_string-525"><span class="linenos">525</span></a>                    <span class="k">if</span> <span class="n">protein</span><span class="o">.</span><span class="n">has_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">):</span>
</span><span id="PDBIO.load_from_string-526"><a href="#PDBIO.load_from_string-526"><span class="linenos">526</span></a>                        <span class="n">current_chain</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-527"><a href="#PDBIO.load_from_string-527"><span class="linenos">527</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-528"><a href="#PDBIO.load_from_string-528"><span class="linenos">528</span></a>                        <span class="n">current_chain</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">create_chain</span><span class="p">(</span><span class="n">current_chain_id</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-529"><a href="#PDBIO.load_from_string-529"><span class="linenos">529</span></a>
</span><span id="PDBIO.load_from_string-530"><a href="#PDBIO.load_from_string-530"><span class="linenos">530</span></a>                <span class="c1"># Check if the residue exists</span>
</span><span id="PDBIO.load_from_string-531"><a href="#PDBIO.load_from_string-531"><span class="linenos">531</span></a>                <span class="n">residue_id</span> <span class="o">=</span> <span class="n">current_chain_id</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]</span>
</span><span id="PDBIO.load_from_string-532"><a href="#PDBIO.load_from_string-532"><span class="linenos">532</span></a>                <span class="k">if</span> <span class="n">residue_id</span> <span class="o">!=</span> <span class="n">current_residue_id</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-533"><a href="#PDBIO.load_from_string-533"><span class="linenos">533</span></a>                    <span class="n">current_residue_id</span> <span class="o">=</span> <span class="n">residue_id</span>
</span><span id="PDBIO.load_from_string-534"><a href="#PDBIO.load_from_string-534"><span class="linenos">534</span></a>                    <span class="k">if</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;ATOM&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-535"><a href="#PDBIO.load_from_string-535"><span class="linenos">535</span></a>                        <span class="c1"># if entry[&quot;res_name&quot;] in ResidueTemplate.VALID_DNA_RESIDUES:</span>
</span><span id="PDBIO.load_from_string-536"><a href="#PDBIO.load_from_string-536"><span class="linenos">536</span></a>                        <span class="c1">#     current_residue = current_chain.add_dna_residue(</span>
</span><span id="PDBIO.load_from_string-537"><a href="#PDBIO.load_from_string-537"><span class="linenos">537</span></a>                        <span class="c1">#         residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO.load_from_string-538"><a href="#PDBIO.load_from_string-538"><span class="linenos">538</span></a>                        <span class="c1">#         sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO.load_from_string-539"><a href="#PDBIO.load_from_string-539"><span class="linenos">539</span></a>                        <span class="c1">#         insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO.load_from_string-540"><a href="#PDBIO.load_from_string-540"><span class="linenos">540</span></a>                        <span class="c1">#     )</span>
</span><span id="PDBIO.load_from_string-541"><a href="#PDBIO.load_from_string-541"><span class="linenos">541</span></a>                        <span class="c1"># else:</span>
</span><span id="PDBIO.load_from_string-542"><a href="#PDBIO.load_from_string-542"><span class="linenos">542</span></a>                        <span class="n">current_residue</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">(</span>
</span><span id="PDBIO.load_from_string-543"><a href="#PDBIO.load_from_string-543"><span class="linenos">543</span></a>                            <span class="n">residue_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-544"><a href="#PDBIO.load_from_string-544"><span class="linenos">544</span></a>                            <span class="n">sequence_no</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]),</span>
</span><span id="PDBIO.load_from_string-545"><a href="#PDBIO.load_from_string-545"><span class="linenos">545</span></a>                            <span class="n">insertion_code</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-546"><a href="#PDBIO.load_from_string-546"><span class="linenos">546</span></a>                            <span class="n">chain</span><span class="o">=</span><span class="n">current_chain</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-547"><a href="#PDBIO.load_from_string-547"><span class="linenos">547</span></a>                        <span class="n">current_chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">current_residue</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-548"><a href="#PDBIO.load_from_string-548"><span class="linenos">548</span></a>                    <span class="k">elif</span> <span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-549"><a href="#PDBIO.load_from_string-549"><span class="linenos">549</span></a>                        <span class="n">current_residue</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">(</span>
</span><span id="PDBIO.load_from_string-550"><a href="#PDBIO.load_from_string-550"><span class="linenos">550</span></a>                            <span class="n">residue_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-551"><a href="#PDBIO.load_from_string-551"><span class="linenos">551</span></a>                            <span class="n">sequence_no</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">]),</span>
</span><span id="PDBIO.load_from_string-552"><a href="#PDBIO.load_from_string-552"><span class="linenos">552</span></a>                            <span class="n">insertion_code</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-553"><a href="#PDBIO.load_from_string-553"><span class="linenos">553</span></a>                            <span class="n">chain</span><span class="o">=</span><span class="n">current_chain</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-554"><a href="#PDBIO.load_from_string-554"><span class="linenos">554</span></a>                        <span class="n">current_chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">current_residue</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-555"><a href="#PDBIO.load_from_string-555"><span class="linenos">555</span></a>
</span><span id="PDBIO.load_from_string-556"><a href="#PDBIO.load_from_string-556"><span class="linenos">556</span></a>                        <span class="c1"># current_residue = current_chain.add_het_residue(</span>
</span><span id="PDBIO.load_from_string-557"><a href="#PDBIO.load_from_string-557"><span class="linenos">557</span></a>                        <span class="c1">#     residue_type=entry[&quot;res_name&quot;],</span>
</span><span id="PDBIO.load_from_string-558"><a href="#PDBIO.load_from_string-558"><span class="linenos">558</span></a>                        <span class="c1">#     sequence_no=int(entry[&quot;res_seq&quot;]),</span>
</span><span id="PDBIO.load_from_string-559"><a href="#PDBIO.load_from_string-559"><span class="linenos">559</span></a>                        <span class="c1">#     insertion_code=entry[&quot;icode&quot;]</span>
</span><span id="PDBIO.load_from_string-560"><a href="#PDBIO.load_from_string-560"><span class="linenos">560</span></a>                        <span class="c1"># )</span>
</span><span id="PDBIO.load_from_string-561"><a href="#PDBIO.load_from_string-561"><span class="linenos">561</span></a>
</span><span id="PDBIO.load_from_string-562"><a href="#PDBIO.load_from_string-562"><span class="linenos">562</span></a>                <span class="c1"># Temporary fix need to see if anything breaks (For Evo eg. 2HH1 -&gt; HH12)</span>
</span><span id="PDBIO.load_from_string-563"><a href="#PDBIO.load_from_string-563"><span class="linenos">563</span></a>                <span class="c1"># Fix atom naming</span>
</span><span id="PDBIO.load_from_string-564"><a href="#PDBIO.load_from_string-564"><span class="linenos">564</span></a>                <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
</span><span id="PDBIO.load_from_string-565"><a href="#PDBIO.load_from_string-565"><span class="linenos">565</span></a>                    <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PDBIO.load_from_string-566"><a href="#PDBIO.load_from_string-566"><span class="linenos">566</span></a>                    <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-567"><a href="#PDBIO.load_from_string-567"><span class="linenos">567</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-568"><a href="#PDBIO.load_from_string-568"><span class="linenos">568</span></a>                    <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-569"><a href="#PDBIO.load_from_string-569"><span class="linenos">569</span></a>                        <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>
</span><span id="PDBIO.load_from_string-570"><a href="#PDBIO.load_from_string-570"><span class="linenos">570</span></a>
</span><span id="PDBIO.load_from_string-571"><a href="#PDBIO.load_from_string-571"><span class="linenos">571</span></a>                <span class="c1"># Add the atom to the residue</span>
</span><span id="PDBIO.load_from_string-572"><a href="#PDBIO.load_from_string-572"><span class="linenos">572</span></a>                <span class="c1"># if entry[&quot;alt_loc&quot;] == &quot;&quot;:</span>
</span><span id="PDBIO.load_from_string-573"><a href="#PDBIO.load_from_string-573"><span class="linenos">573</span></a>                <span class="c1">#     atom_id = entry[&quot;atom_name&quot;]</span>
</span><span id="PDBIO.load_from_string-574"><a href="#PDBIO.load_from_string-574"><span class="linenos">574</span></a>                <span class="c1"># else:</span>
</span><span id="PDBIO.load_from_string-575"><a href="#PDBIO.load_from_string-575"><span class="linenos">575</span></a>                <span class="c1">#     atom_id = entry[&quot;atom_name&quot;] + &quot;_&quot; + entry[&quot;alt_loc&quot;]</span>
</span><span id="PDBIO.load_from_string-576"><a href="#PDBIO.load_from_string-576"><span class="linenos">576</span></a>                <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span>
</span><span id="PDBIO.load_from_string-577"><a href="#PDBIO.load_from_string-577"><span class="linenos">577</span></a>                    <span class="n">element</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-578"><a href="#PDBIO.load_from_string-578"><span class="linenos">578</span></a>                    <span class="n">atom_type</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;atom_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-579"><a href="#PDBIO.load_from_string-579"><span class="linenos">579</span></a>                    <span class="n">x</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-580"><a href="#PDBIO.load_from_string-580"><span class="linenos">580</span></a>                    <span class="n">y</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-581"><a href="#PDBIO.load_from_string-581"><span class="linenos">581</span></a>                    <span class="n">z</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-582"><a href="#PDBIO.load_from_string-582"><span class="linenos">582</span></a>
</span><span id="PDBIO.load_from_string-583"><a href="#PDBIO.load_from_string-583"><span class="linenos">583</span></a>                    <span class="c1"># Serial is dependent on the atom ordering,</span>
</span><span id="PDBIO.load_from_string-584"><a href="#PDBIO.load_from_string-584"><span class="linenos">584</span></a>                    <span class="c1"># so it is not used in the Atom class</span>
</span><span id="PDBIO.load_from_string-585"><a href="#PDBIO.load_from_string-585"><span class="linenos">585</span></a>                    <span class="c1"># pdb_serial=entry[&quot;serial&quot;],</span>
</span><span id="PDBIO.load_from_string-586"><a href="#PDBIO.load_from_string-586"><span class="linenos">586</span></a>                    <span class="n">alt_loc</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;alt_loc&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-587"><a href="#PDBIO.load_from_string-587"><span class="linenos">587</span></a>                    <span class="n">occupancy</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;occupancy&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-588"><a href="#PDBIO.load_from_string-588"><span class="linenos">588</span></a>                    <span class="n">temp_factor</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-589"><a href="#PDBIO.load_from_string-589"><span class="linenos">589</span></a>                    <span class="n">assigned_charge</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-590"><a href="#PDBIO.load_from_string-590"><span class="linenos">590</span></a>                    <span class="n">calculated_charge</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-591"><a href="#PDBIO.load_from_string-591"><span class="linenos">591</span></a>                    <span class="n">radius</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">],</span>
</span><span id="PDBIO.load_from_string-592"><a href="#PDBIO.load_from_string-592"><span class="linenos">592</span></a>                    <span class="n">is_hetero</span><span class="o">=</span><span class="p">(</span><span class="n">record_name</span> <span class="o">==</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">),</span>
</span><span id="PDBIO.load_from_string-593"><a href="#PDBIO.load_from_string-593"><span class="linenos">593</span></a>
</span><span id="PDBIO.load_from_string-594"><a href="#PDBIO.load_from_string-594"><span class="linenos">594</span></a>                    <span class="n">residue</span><span class="o">=</span><span class="n">current_residue</span>
</span><span id="PDBIO.load_from_string-595"><a href="#PDBIO.load_from_string-595"><span class="linenos">595</span></a>                <span class="p">)</span>
</span><span id="PDBIO.load_from_string-596"><a href="#PDBIO.load_from_string-596"><span class="linenos">596</span></a>
</span><span id="PDBIO.load_from_string-597"><a href="#PDBIO.load_from_string-597"><span class="linenos">597</span></a>                <span class="c1"># current_residue.add_atom(atom_id, atom)</span>
</span><span id="PDBIO.load_from_string-598"><a href="#PDBIO.load_from_string-598"><span class="linenos">598</span></a>                <span class="n">current_residue</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span> <span class="n">atom</span><span class="p">)</span>
</span><span id="PDBIO.load_from_string-599"><a href="#PDBIO.load_from_string-599"><span class="linenos">599</span></a>
</span><span id="PDBIO.load_from_string-600"><a href="#PDBIO.load_from_string-600"><span class="linenos">600</span></a>        <span class="k">if</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-601"><a href="#PDBIO.load_from_string-601"><span class="linenos">601</span></a>            <span class="k">for</span> <span class="n">chain_id</span> <span class="ow">in</span> <span class="n">seqres</span><span class="p">:</span>
</span><span id="PDBIO.load_from_string-602"><a href="#PDBIO.load_from_string-602"><span class="linenos">602</span></a>                <span class="k">if</span> <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]:</span>
</span><span id="PDBIO.load_from_string-603"><a href="#PDBIO.load_from_string-603"><span class="linenos">603</span></a>                    <span class="n">protein</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">chain_id</span><span class="p">)</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;seqres&quot;</span><span class="p">,</span> <span class="n">seqres</span><span class="p">[</span><span class="n">chain_id</span><span class="p">])</span>
</span><span id="PDBIO.load_from_string-604"><a href="#PDBIO.load_from_string-604"><span class="linenos">604</span></a>
</span><span id="PDBIO.load_from_string-605"><a href="#PDBIO.load_from_string-605"><span class="linenos">605</span></a>        <span class="c1"># Housekeeping</span>
</span><span id="PDBIO.load_from_string-606"><a href="#PDBIO.load_from_string-606"><span class="linenos">606</span></a>        <span class="c1"># protein.set_residue_indexing()</span>
</span><span id="PDBIO.load_from_string-607"><a href="#PDBIO.load_from_string-607"><span class="linenos">607</span></a>
</span><span id="PDBIO.load_from_string-608"><a href="#PDBIO.load_from_string-608"><span class="linenos">608</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">protein</span><span class="p">]</span>
</span></pre></div>


    

                            </div>
                            <div id="PDBIO.load" class="classattr">
                                        <input id="PDBIO.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n"><a href="../structure/protein.html#Protein">protkit.structure.protein.Protein</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PDBIO.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.load-611"><a href="#PDBIO.load-611"><span class="linenos">611</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.load-612"><a href="#PDBIO.load-612"><span class="linenos">612</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PDBIO.load-613"><a href="#PDBIO.load-613"><span class="linenos">613</span></a>             <span class="n">is_pqr_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PDBIO.load-614"><a href="#PDBIO.load-614"><span class="linenos">614</span></a>             <span class="n">pdb_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
</span><span id="PDBIO.load-615"><a href="#PDBIO.load-615"><span class="linenos">615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PDBIO.load-616"><a href="#PDBIO.load-616"><span class="linenos">616</span></a><span class="sd">        Load a protein from a PDB file.</span>
</span><span id="PDBIO.load-617"><a href="#PDBIO.load-617"><span class="linenos">617</span></a>
</span><span id="PDBIO.load-618"><a href="#PDBIO.load-618"><span class="linenos">618</span></a><span class="sd">        Args:</span>
</span><span id="PDBIO.load-619"><a href="#PDBIO.load-619"><span class="linenos">619</span></a><span class="sd">            file_path (str): The path to the PDB file.</span>
</span><span id="PDBIO.load-620"><a href="#PDBIO.load-620"><span class="linenos">620</span></a><span class="sd">            is_pqr_format (bool): If the file is in PQR format.</span>
</span><span id="PDBIO.load-621"><a href="#PDBIO.load-621"><span class="linenos">621</span></a><span class="sd">            pdb_id (str): The PDB ID of the protein.</span>
</span><span id="PDBIO.load-622"><a href="#PDBIO.load-622"><span class="linenos">622</span></a>
</span><span id="PDBIO.load-623"><a href="#PDBIO.load-623"><span class="linenos">623</span></a><span class="sd">        Returns:</span>
</span><span id="PDBIO.load-624"><a href="#PDBIO.load-624"><span class="linenos">624</span></a><span class="sd">            List[Protein]: A list of proteins.</span>
</span><span id="PDBIO.load-625"><a href="#PDBIO.load-625"><span class="linenos">625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PDBIO.load-626"><a href="#PDBIO.load-626"><span class="linenos">626</span></a>
</span><span id="PDBIO.load-627"><a href="#PDBIO.load-627"><span class="linenos">627</span></a>        <span class="c1"># Open the file and extract the individual lines.</span>
</span><span id="PDBIO.load-628"><a href="#PDBIO.load-628"><span class="linenos">628</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="PDBIO.load-629"><a href="#PDBIO.load-629"><span class="linenos">629</span></a>            <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="PDBIO.load-630"><a href="#PDBIO.load-630"><span class="linenos">630</span></a>
</span><span id="PDBIO.load-631"><a href="#PDBIO.load-631"><span class="linenos">631</span></a>        <span class="k">return</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">load_from_string</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">,</span> <span class="n">pdb_id</span><span class="o">=</span><span class="n">pdb_id</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load a protein from a PDB file.</p>

<p>Args:
    file_path (str): The path to the PDB file.
    is_pqr_format (bool): If the file is in PQR format.
    pdb_id (str): The PDB ID of the protein.</p>

<p>Returns:
    List[Protein]: A list of proteins.</p>
</div>


                            </div>
                            <div id="PDBIO.save_to_string" class="classattr">
                                        <input id="PDBIO.save_to_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">save_to_string</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">protein</span><span class="p">:</span> <span class="n"><a href="../structure/protein.html#Protein">protkit.structure.protein.Protein</a></span>, </span><span class="param"><span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="PDBIO.save_to_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.save_to_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.save_to_string-633"><a href="#PDBIO.save_to_string-633"><span class="linenos">633</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.save_to_string-634"><a href="#PDBIO.save_to_string-634"><span class="linenos">634</span></a>    <span class="k">def</span> <span class="nf">save_to_string</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-635"><a href="#PDBIO.save_to_string-635"><span class="linenos">635</span></a>                       <span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-636"><a href="#PDBIO.save_to_string-636"><span class="linenos">636</span></a>        <span class="n">text_entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PDBIO.save_to_string-637"><a href="#PDBIO.save_to_string-637"><span class="linenos">637</span></a>        <span class="n">num_seqres</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO.save_to_string-638"><a href="#PDBIO.save_to_string-638"><span class="linenos">638</span></a>        <span class="n">num_atoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO.save_to_string-639"><a href="#PDBIO.save_to_string-639"><span class="linenos">639</span></a>        <span class="n">num_hetatoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO.save_to_string-640"><a href="#PDBIO.save_to_string-640"><span class="linenos">640</span></a>        <span class="n">num_ter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PDBIO.save_to_string-641"><a href="#PDBIO.save_to_string-641"><span class="linenos">641</span></a>        <span class="n">serial</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="PDBIO.save_to_string-642"><a href="#PDBIO.save_to_string-642"><span class="linenos">642</span></a>        <span class="n">atom_entry</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PDBIO.save_to_string-643"><a href="#PDBIO.save_to_string-643"><span class="linenos">643</span></a>
</span><span id="PDBIO.save_to_string-644"><a href="#PDBIO.save_to_string-644"><span class="linenos">644</span></a>        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">chains</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-645"><a href="#PDBIO.save_to_string-645"><span class="linenos">645</span></a>            <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-646"><a href="#PDBIO.save_to_string-646"><span class="linenos">646</span></a>                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-647"><a href="#PDBIO.save_to_string-647"><span class="linenos">647</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">atom</span><span class="o">.</span><span class="n">is_hetero</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-648"><a href="#PDBIO.save_to_string-648"><span class="linenos">648</span></a>                        <span class="n">atom_entry</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.save_to_string-649"><a href="#PDBIO.save_to_string-649"><span class="linenos">649</span></a>                            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-650"><a href="#PDBIO.save_to_string-650"><span class="linenos">650</span></a>                            <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-651"><a href="#PDBIO.save_to_string-651"><span class="linenos">651</span></a>                            <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;pdb_alt_loc&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-652"><a href="#PDBIO.save_to_string-652"><span class="linenos">652</span></a>                            <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_type</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-653"><a href="#PDBIO.save_to_string-653"><span class="linenos">653</span></a>                            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">chain</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-654"><a href="#PDBIO.save_to_string-654"><span class="linenos">654</span></a>                            <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">sequence_no</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-655"><a href="#PDBIO.save_to_string-655"><span class="linenos">655</span></a>                            <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">insertion_code</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-656"><a href="#PDBIO.save_to_string-656"><span class="linenos">656</span></a>                            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-657"><a href="#PDBIO.save_to_string-657"><span class="linenos">657</span></a>                            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-658"><a href="#PDBIO.save_to_string-658"><span class="linenos">658</span></a>                            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-659"><a href="#PDBIO.save_to_string-659"><span class="linenos">659</span></a>                            <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;occupancy&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-660"><a href="#PDBIO.save_to_string-660"><span class="linenos">660</span></a>                            <span class="c1"># &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="PDBIO.save_to_string-661"><a href="#PDBIO.save_to_string-661"><span class="linenos">661</span></a>                            <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-662"><a href="#PDBIO.save_to_string-662"><span class="linenos">662</span></a>                            <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-663"><a href="#PDBIO.save_to_string-663"><span class="linenos">663</span></a>                            <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-664"><a href="#PDBIO.save_to_string-664"><span class="linenos">664</span></a>                            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;radius&quot;</span><span class="p">)</span>
</span><span id="PDBIO.save_to_string-665"><a href="#PDBIO.save_to_string-665"><span class="linenos">665</span></a>                        <span class="p">}</span>
</span><span id="PDBIO.save_to_string-666"><a href="#PDBIO.save_to_string-666"><span class="linenos">666</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-667"><a href="#PDBIO.save_to_string-667"><span class="linenos">667</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">))</span>
</span><span id="PDBIO.save_to_string-668"><a href="#PDBIO.save_to_string-668"><span class="linenos">668</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-669"><a href="#PDBIO.save_to_string-669"><span class="linenos">669</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">))</span>
</span><span id="PDBIO.save_to_string-670"><a href="#PDBIO.save_to_string-670"><span class="linenos">670</span></a>
</span><span id="PDBIO.save_to_string-671"><a href="#PDBIO.save_to_string-671"><span class="linenos">671</span></a>                        <span class="n">serial</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO.save_to_string-672"><a href="#PDBIO.save_to_string-672"><span class="linenos">672</span></a>                        <span class="n">num_atoms</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO.save_to_string-673"><a href="#PDBIO.save_to_string-673"><span class="linenos">673</span></a>
</span><span id="PDBIO.save_to_string-674"><a href="#PDBIO.save_to_string-674"><span class="linenos">674</span></a>            <span class="c1"># TER entry</span>
</span><span id="PDBIO.save_to_string-675"><a href="#PDBIO.save_to_string-675"><span class="linenos">675</span></a>            <span class="k">if</span> <span class="n">atom_entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-676"><a href="#PDBIO.save_to_string-676"><span class="linenos">676</span></a>                <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_ter_line</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-677"><a href="#PDBIO.save_to_string-677"><span class="linenos">677</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;res_name&quot;</span><span class="p">],</span>
</span><span id="PDBIO.save_to_string-678"><a href="#PDBIO.save_to_string-678"><span class="linenos">678</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;chain_id&quot;</span><span class="p">],</span>
</span><span id="PDBIO.save_to_string-679"><a href="#PDBIO.save_to_string-679"><span class="linenos">679</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;res_seq&quot;</span><span class="p">],</span>
</span><span id="PDBIO.save_to_string-680"><a href="#PDBIO.save_to_string-680"><span class="linenos">680</span></a>                                                              <span class="n">atom_entry</span><span class="p">[</span><span class="s2">&quot;icode&quot;</span><span class="p">]))</span>
</span><span id="PDBIO.save_to_string-681"><a href="#PDBIO.save_to_string-681"><span class="linenos">681</span></a>                <span class="n">serial</span> <span class="o">=</span> <span class="n">serial</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PDBIO.save_to_string-682"><a href="#PDBIO.save_to_string-682"><span class="linenos">682</span></a>                <span class="n">num_ter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO.save_to_string-683"><a href="#PDBIO.save_to_string-683"><span class="linenos">683</span></a>
</span><span id="PDBIO.save_to_string-684"><a href="#PDBIO.save_to_string-684"><span class="linenos">684</span></a>        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">chains</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-685"><a href="#PDBIO.save_to_string-685"><span class="linenos">685</span></a>            <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-686"><a href="#PDBIO.save_to_string-686"><span class="linenos">686</span></a>                <span class="c1"># HETATM entries</span>
</span><span id="PDBIO.save_to_string-687"><a href="#PDBIO.save_to_string-687"><span class="linenos">687</span></a>                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-688"><a href="#PDBIO.save_to_string-688"><span class="linenos">688</span></a>                    <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">is_hetero</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-689"><a href="#PDBIO.save_to_string-689"><span class="linenos">689</span></a>                        <span class="n">atom_entry</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PDBIO.save_to_string-690"><a href="#PDBIO.save_to_string-690"><span class="linenos">690</span></a>                            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-691"><a href="#PDBIO.save_to_string-691"><span class="linenos">691</span></a>                            <span class="s2">&quot;atom_name&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-692"><a href="#PDBIO.save_to_string-692"><span class="linenos">692</span></a>                            <span class="s2">&quot;alt_loc&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;pdb_alt_loc&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-693"><a href="#PDBIO.save_to_string-693"><span class="linenos">693</span></a>                            <span class="s2">&quot;res_name&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_type</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-694"><a href="#PDBIO.save_to_string-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;chain_id&quot;</span><span class="p">:</span> <span class="n">chain</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-695"><a href="#PDBIO.save_to_string-695"><span class="linenos">695</span></a>                            <span class="s2">&quot;res_seq&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">sequence_no</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-696"><a href="#PDBIO.save_to_string-696"><span class="linenos">696</span></a>                            <span class="s2">&quot;icode&quot;</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">insertion_code</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-697"><a href="#PDBIO.save_to_string-697"><span class="linenos">697</span></a>                            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-698"><a href="#PDBIO.save_to_string-698"><span class="linenos">698</span></a>                            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-699"><a href="#PDBIO.save_to_string-699"><span class="linenos">699</span></a>                            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
</span><span id="PDBIO.save_to_string-700"><a href="#PDBIO.save_to_string-700"><span class="linenos">700</span></a>                            <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;occupancy&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-701"><a href="#PDBIO.save_to_string-701"><span class="linenos">701</span></a>                            <span class="c1"># &quot;temp_factor&quot;: atom._pdb_temp_factor if atom._pdb_temp_factor is not None else 0.0,</span>
</span><span id="PDBIO.save_to_string-702"><a href="#PDBIO.save_to_string-702"><span class="linenos">702</span></a>                            <span class="s2">&quot;temp_factor&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;temp_factor&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-703"><a href="#PDBIO.save_to_string-703"><span class="linenos">703</span></a>                            <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-704"><a href="#PDBIO.save_to_string-704"><span class="linenos">704</span></a>                            <span class="s2">&quot;assigned_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;assigned_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-705"><a href="#PDBIO.save_to_string-705"><span class="linenos">705</span></a>                            <span class="s2">&quot;calculated_charge&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;calculated_charge&quot;</span><span class="p">),</span>
</span><span id="PDBIO.save_to_string-706"><a href="#PDBIO.save_to_string-706"><span class="linenos">706</span></a>                            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;radius&quot;</span><span class="p">)</span>
</span><span id="PDBIO.save_to_string-707"><a href="#PDBIO.save_to_string-707"><span class="linenos">707</span></a>                        <span class="p">}</span>
</span><span id="PDBIO.save_to_string-708"><a href="#PDBIO.save_to_string-708"><span class="linenos">708</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pqr_format</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-709"><a href="#PDBIO.save_to_string-709"><span class="linenos">709</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;HETATM&quot;</span><span class="p">))</span>
</span><span id="PDBIO.save_to_string-710"><a href="#PDBIO.save_to_string-710"><span class="linenos">710</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PDBIO.save_to_string-711"><a href="#PDBIO.save_to_string-711"><span class="linenos">711</span></a>                            <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pqr_atom_line</span><span class="p">(</span><span class="n">atom_entry</span><span class="p">,</span> <span class="n">serial</span><span class="p">,</span> <span class="n">record_name</span><span class="o">=</span><span class="s2">&quot;HETATM&quot;</span><span class="p">))</span>
</span><span id="PDBIO.save_to_string-712"><a href="#PDBIO.save_to_string-712"><span class="linenos">712</span></a>
</span><span id="PDBIO.save_to_string-713"><a href="#PDBIO.save_to_string-713"><span class="linenos">713</span></a>                        <span class="n">serial</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO.save_to_string-714"><a href="#PDBIO.save_to_string-714"><span class="linenos">714</span></a>                        <span class="n">num_hetatoms</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PDBIO.save_to_string-715"><a href="#PDBIO.save_to_string-715"><span class="linenos">715</span></a>            <span class="c1"># Hetero residues have no TER records, so no need to write a termination code.</span>
</span><span id="PDBIO.save_to_string-716"><a href="#PDBIO.save_to_string-716"><span class="linenos">716</span></a>
</span><span id="PDBIO.save_to_string-717"><a href="#PDBIO.save_to_string-717"><span class="linenos">717</span></a>        <span class="c1"># Bookkeeping records</span>
</span><span id="PDBIO.save_to_string-718"><a href="#PDBIO.save_to_string-718"><span class="linenos">718</span></a>        <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBIO</span><span class="o">.</span><span class="n">create_pdb_master_line</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_hetatoms</span><span class="p">,</span> <span class="n">num_ter</span><span class="p">,</span> <span class="n">num_seqres</span><span class="o">=</span><span class="n">num_seqres</span><span class="p">))</span>
</span><span id="PDBIO.save_to_string-719"><a href="#PDBIO.save_to_string-719"><span class="linenos">719</span></a>        <span class="n">text_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;END&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span>
</span><span id="PDBIO.save_to_string-720"><a href="#PDBIO.save_to_string-720"><span class="linenos">720</span></a>
</span><span id="PDBIO.save_to_string-721"><a href="#PDBIO.save_to_string-721"><span class="linenos">721</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_entries</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="PDBIO.save" class="classattr">
                                        <input id="PDBIO.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">protein</span><span class="p">:</span> <span class="n"><a href="../structure/protein.html#Protein">protkit.structure.protein.Protein</a></span>,</span><span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PDBIO.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PDBIO.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PDBIO.save-723"><a href="#PDBIO.save-723"><span class="linenos">723</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PDBIO.save-724"><a href="#PDBIO.save-724"><span class="linenos">724</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span>
</span><span id="PDBIO.save-725"><a href="#PDBIO.save-725"><span class="linenos">725</span></a>             <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PDBIO.save-726"><a href="#PDBIO.save-726"><span class="linenos">726</span></a>             <span class="n">is_pqr_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PDBIO.save-727"><a href="#PDBIO.save-727"><span class="linenos">727</span></a>
</span><span id="PDBIO.save-728"><a href="#PDBIO.save-728"><span class="linenos">728</span></a>        <span class="n">pdb_string</span> <span class="o">=</span> <span class="n">PDBIO</span><span class="o">.</span><span class="n">save_to_string</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">is_pqr_format</span><span class="o">=</span><span class="n">is_pqr_format</span><span class="p">)</span>
</span><span id="PDBIO.save-729"><a href="#PDBIO.save-729"><span class="linenos">729</span></a>
</span><span id="PDBIO.save-730"><a href="#PDBIO.save-730"><span class="linenos">730</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="PDBIO.save-731"><a href="#PDBIO.save-731"><span class="linenos">731</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdb_string</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>